import{Q as ft,u as zn}from"./use-quasar-BVv1AXdb.js";import{r as ze,c as pt,h as qe,o as Fe,d as Te,w as He,g as Ge,m as ct,aO as da,aP as Ct,F as Jt,e as Ue,t as lt,k as Ba,ag as mn,L as ea,n as Wn,aQ as A1,aR as S1,x as pa,ak as k1,p as M1,v as T1,q as B1,al as x1,S as R1,B as Kn,a9 as Jn,M as Ut,Q as it,j as Zt,E as hn,a as wa,N as ya,aS as bn,i as E1}from"./index-CdXKqIwE.js";import{_ as xa,a as P1,b as la}from"./_plugin-vue_export-helper-BlM1Smyy.js";const I1={class:"marker-timeline"},V1=["onClick"],D1=["onClick"],L1={__name:"MarkerTimeline",props:{markers:{type:Array,default:()=>[]},currentTime:{type:Number,default:0},duration:{type:Number,default:0},selectedMarker:{type:Object,default:null}},emits:["markerClick","seek"],setup(S,{emit:z}){const i=S,R=z,O=ze(null),X=ze(!1),Y=ze({x:0}),F=ze(0),q=ze(null),ee=pt(()=>i.markers.filter(p=>p.end_time===null)),g=pt(()=>i.markers.filter(p=>p.end_time!==null)),e=pt(()=>i.duration?i.currentTime/i.duration*100:0);function a(p){return i.duration?p/i.duration*100:0}function _(p,L){return i.duration?(L-p)/i.duration*100:0}function m(p){if(!O.value||!i.duration)return;const L=O.value.getBoundingClientRect(),y=(p.clientX-L.left)/L.width*i.duration;R("seek",y)}function V(p){if(!O.value||!i.duration)return;const L=O.value.getBoundingClientRect(),v=p.clientX-L.left,y=Math.max(0,Math.min(1,v/L.width))*i.duration;Y.value={x:v},F.value=y,q.value=B(y)}function B(p){for(const v of g.value)if(p>=v.start_time&&p<=v.end_time)return v;const L=1;for(const v of ee.value)if(Math.abs(p-v.start_time)<=L)return v;return null}function n(p){return i.markers.findIndex(v=>v.id===p.id)+1}function r(p){const L=Math.floor(p/60),v=Math.floor(p%60);return`${L}:${v.toString().padStart(2,"0")}`}function t(p){return i.selectedMarker&&i.selectedMarker.id===p.id}return(p,L)=>(Fe(),qe("div",I1,[Te(ea,null,{default:He(()=>[Ge("div",null,[Ge("div",{class:"timeline-container",ref_key:"timelineRef",ref:O,onClick:m,onMousemove:V,onMouseenter:L[0]||(L[0]=v=>X.value=!0),onMouseleave:L[1]||(L[1]=v=>X.value=!1)},[X.value?(Fe(),qe("div",{key:0,class:Ct(["timeline-tooltip",{"over-marker":q.value}]),style:da({left:Y.value.x+"px"})},[q.value?(Fe(),qe(Jt,{key:0},[Ue(" Marker #"+lt(n(q.value)),1)],64)):(Fe(),qe(Jt,{key:1},[Ue(lt(r(F.value)),1)],64))],6)):ct("",!0),Ge("div",{class:"current-time-indicator",style:da({left:e.value+"%"})},null,4),(Fe(!0),qe(Jt,null,Ba(ee.value,v=>(Fe(),qe("div",{key:v.id,class:Ct(["timeline-marker point-marker",{"selected-marker":t(v)}]),style:da({left:a(v.start_time)+"%"}),onClick:mn(M=>p.$emit("markerClick",v),["stop"])},[Te(ft,null,{default:He(()=>[Ue(lt(r(v.start_time)),1)]),_:2},1024)],14,V1))),128)),(Fe(!0),qe(Jt,null,Ba(g.value,v=>(Fe(),qe("div",{key:v.id,class:Ct(["timeline-marker range-marker",{"selected-marker":t(v)}]),style:da({left:a(v.start_time)+"%",width:_(v.start_time,v.end_time)+"%"}),onClick:mn(M=>p.$emit("markerClick",v),["stop"])},[Te(ft,null,{default:He(()=>[Ue(lt(r(v.start_time))+" - "+lt(r(v.end_time)),1)]),_:2},1024)],14,D1))),128))],544)])]),_:1})]))}},mi=xa(L1,[["__scopeId","data-v-2a67227b"]]),O1='<g transform="matrix(1 0 0 -1 0 80)"><rect width="10" height="20" rx="3"><animate attributeName="height" begin="0s" dur="4.3s" values="20;45;57;80;64;32;66;45;64;23;66;13;64;56;34;34;2;23;76;79;20" calcMode="linear" repeatCount="indefinite"></animate></rect><rect x="15" width="10" height="80" rx="3"><animate attributeName="height" begin="0s" dur="2s" values="80;55;33;5;75;23;73;33;12;14;60;80" calcMode="linear" repeatCount="indefinite"></animate></rect><rect x="30" width="10" height="50" rx="3"><animate attributeName="height" begin="0s" dur="1.4s" values="50;34;78;23;56;23;34;76;80;54;21;50" calcMode="linear" repeatCount="indefinite"></animate></rect><rect x="45" width="10" height="30" rx="3"><animate attributeName="height" begin="0s" dur="2s" values="30;45;13;80;56;72;45;76;34;23;67;30" calcMode="linear" repeatCount="indefinite"></animate></rect></g>',H1=Wn({name:"QSpinnerAudio",props:A1,setup(S){const{cSize:z,classes:i}=S1(S);return()=>pa("svg",{class:i.value,fill:"currentColor",width:z.value,height:z.value,viewBox:"0 0 55 80",xmlns:"http://www.w3.org/2000/svg",innerHTML:O1})}}),C1={xs:2,sm:4,md:6,lg:10,xl:14};function vn(S,z,i){return{transform:z===!0?`translateX(${i.lang.rtl===!0?"-":""}100%) scale3d(${-S},1,1)`:`scale3d(${S},1,1)`}}const X1=Wn({name:"QLinearProgress",props:{...M1,...k1,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(S,{slots:z}){const{proxy:i}=T1(),R=B1(S,i.$q),O=x1(S,C1),X=pt(()=>S.indeterminate===!0||S.query===!0),Y=pt(()=>S.reverse!==S.query),F=pt(()=>({...O.value!==null?O.value:{},"--q-linear-progress-speed":`${S.animationSpeed}ms`})),q=pt(()=>"q-linear-progress"+(S.color!==void 0?` text-${S.color}`:"")+(S.reverse===!0||S.query===!0?" q-linear-progress--reverse":"")+(S.rounded===!0?" rounded-borders":"")),ee=pt(()=>vn(S.buffer!==void 0?S.buffer:1,Y.value,i.$q)),g=pt(()=>`with${S.instantFeedback===!0?"out":""}-transition`),e=pt(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${g.value} q-linear-progress__track--${R.value===!0?"dark":"light"}`+(S.trackColor!==void 0?` bg-${S.trackColor}`:"")),a=pt(()=>vn(X.value===!0?1:S.value,Y.value,i.$q)),_=pt(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${g.value} q-linear-progress__model--${X.value===!0?"in":""}determinate`),m=pt(()=>({width:`${S.value*100}%`})),V=pt(()=>`q-linear-progress__stripe absolute-${S.reverse===!0?"right":"left"} q-linear-progress__stripe--${g.value}`);return()=>{const B=[pa("div",{class:e.value,style:ee.value}),pa("div",{class:_.value,style:a.value})];return S.stripe===!0&&X.value===!1&&B.push(pa("div",{class:V.value,style:m.value})),pa("div",{class:q.value,style:F.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":S.indeterminate===!0?void 0:S.value},R1(z.default,B))}}});var tn={};function N1(S){return new Int8Array(S)}function F1(S){return new Int16Array(S)}function Un(S){return new Int32Array(S)}function e1(S){return new Float32Array(S)}function q1(S){return new Float64Array(S)}function t1(S){if(S.length==1)return e1(S[0]);var z=S[0];S=S.slice(1);for(var i=[],R=0;R<z;R++)i.push(t1(S));return i}function a1(S){if(S.length==1)return Un(S[0]);var z=S[0];S=S.slice(1);for(var i=[],R=0;R<z;R++)i.push(a1(S));return i}function n1(S){if(S.length==1)return F1(S[0]);var z=S[0];S=S.slice(1);for(var i=[],R=0;R<z;R++)i.push(n1(S));return i}function r1(S){if(S.length==1)return new Array(S[0]);var z=S[0];S=S.slice(1);for(var i=[],R=0;R<z;R++)i.push(r1(S));return i}var s1={};s1.fill=function(S,z,i,R){if(arguments.length==2)for(var O=0;O<S.length;O++)S[O]=arguments[1];else for(var O=z;O<i;O++)S[O]=R};var ha={};ha.arraycopy=function(S,z,i,R,O){for(var X=z+O;z<X;)i[R++]=S[z++]};ha.out={};ha.out.println=function(S){console.log(S)};ha.out.printf=function(){console.log.apply(console,arguments)};var Ra={};Ra.SQRT2=1.4142135623730951;Ra.FAST_LOG10=function(S){return Math.log10(S)};Ra.FAST_LOG10_X=function(S,z){return Math.log10(S)*z};function Lt(S){this.ordinal=S}Lt.short_block_allowed=new Lt(0);Lt.short_block_coupled=new Lt(1);Lt.short_block_dispensed=new Lt(2);Lt.short_block_forced=new Lt(3);var i1={};i1.MAX_VALUE=34028235e31;function St(S){this.ordinal=S}St.vbr_off=new St(0);St.vbr_mt=new St(1);St.vbr_rh=new St(2);St.vbr_abr=new St(3);St.vbr_mtrh=new St(4);St.vbr_default=St.vbr_mtrh;var Y1=function(S){},et={System:ha,VbrMode:St,Float:i1,ShortBlock:Lt,Util:Ra,Arrays:s1,new_array_n:r1,new_byte:N1,new_double:q1,new_float:e1,new_float_n:t1,new_int:Un,new_int_n:a1,new_short_n:n1,assert:Y1},Fa,gn;function j1(){if(gn)return Fa;gn=1;var S=et,z=S.System,i=S.Util,R=S.Arrays,O=S.new_float,X=dt();function Y(){var F=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*i.SQRT2*.5/2384e-9,.017876148*i.SQRT2*.5/2384e-9,.003134727*i.SQRT2*.5/2384e-9,.002457142*i.SQRT2*.5/2384e-9,971317e-9*i.SQRT2*.5/2384e-9,218868e-9*i.SQRT2*.5/2384e-9,101566e-9*i.SQRT2*.5/2384e-9,13828e-9*i.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],q=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],ee=q[X.SHORT_TYPE],g=q[X.SHORT_TYPE],e=q[X.SHORT_TYPE],a=q[X.SHORT_TYPE],_=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function m(n,r,t){for(var p=10,L=r+238-14-286,v=-15;v<0;v++){var M,y,Z;M=F[p+-10],y=n[L+-224]*M,Z=n[r+224]*M,M=F[p+-9],y+=n[L+-160]*M,Z+=n[r+160]*M,M=F[p+-8],y+=n[L+-96]*M,Z+=n[r+96]*M,M=F[p+-7],y+=n[L+-32]*M,Z+=n[r+32]*M,M=F[p+-6],y+=n[L+32]*M,Z+=n[r+-32]*M,M=F[p+-5],y+=n[L+96]*M,Z+=n[r+-96]*M,M=F[p+-4],y+=n[L+160]*M,Z+=n[r+-160]*M,M=F[p+-3],y+=n[L+224]*M,Z+=n[r+-224]*M,M=F[p+-2],y+=n[r+-256]*M,Z-=n[L+256]*M,M=F[p+-1],y+=n[r+-192]*M,Z-=n[L+192]*M,M=F[p+0],y+=n[r+-128]*M,Z-=n[L+128]*M,M=F[p+1],y+=n[r+-64]*M,Z-=n[L+64]*M,M=F[p+2],y+=n[r+0]*M,Z-=n[L+0]*M,M=F[p+3],y+=n[r+64]*M,Z-=n[L+-64]*M,M=F[p+4],y+=n[r+128]*M,Z-=n[L+-128]*M,M=F[p+5],y+=n[r+192]*M,Z-=n[L+-192]*M,y*=F[p+6],M=Z-y,t[30+v*2]=Z+y,t[31+v*2]=F[p+7]*M,p+=18,r--,L++}{var y,Z,j,D;Z=n[r+-16]*F[p+-10],y=n[r+-32]*F[p+-2],Z+=(n[r+-48]-n[r+16])*F[p+-9],y+=n[r+-96]*F[p+-1],Z+=(n[r+-80]+n[r+48])*F[p+-8],y+=n[r+-160]*F[p+0],Z+=(n[r+-112]-n[r+80])*F[p+-7],y+=n[r+-224]*F[p+1],Z+=(n[r+-144]+n[r+112])*F[p+-6],y-=n[r+32]*F[p+2],Z+=(n[r+-176]-n[r+144])*F[p+-5],y-=n[r+96]*F[p+3],Z+=(n[r+-208]+n[r+176])*F[p+-4],y-=n[r+160]*F[p+4],Z+=(n[r+-240]-n[r+208])*F[p+-3],y-=n[r+224],j=y-Z,D=y+Z,Z=t[14],y=t[15]-Z,t[31]=D+Z,t[30]=j+y,t[15]=j-y,t[14]=D-Z}{var h;h=t[28]-t[0],t[0]+=t[28],t[28]=h*F[p+-36+7],h=t[29]-t[1],t[1]+=t[29],t[29]=h*F[p+-36+7],h=t[26]-t[2],t[2]+=t[26],t[26]=h*F[p+-72+7],h=t[27]-t[3],t[3]+=t[27],t[27]=h*F[p+-72+7],h=t[24]-t[4],t[4]+=t[24],t[24]=h*F[p+-108+7],h=t[25]-t[5],t[5]+=t[25],t[25]=h*F[p+-108+7],h=t[22]-t[6],t[6]+=t[22],t[22]=h*i.SQRT2,h=t[23]-t[7],t[7]+=t[23],t[23]=h*i.SQRT2-t[7],t[7]-=t[6],t[22]-=t[7],t[23]-=t[22],h=t[6],t[6]=t[31]-h,t[31]=t[31]+h,h=t[7],t[7]=t[30]-h,t[30]=t[30]+h,h=t[22],t[22]=t[15]-h,t[15]=t[15]+h,h=t[23],t[23]=t[14]-h,t[14]=t[14]+h,h=t[20]-t[8],t[8]+=t[20],t[20]=h*F[p+-180+7],h=t[21]-t[9],t[9]+=t[21],t[21]=h*F[p+-180+7],h=t[18]-t[10],t[10]+=t[18],t[18]=h*F[p+-216+7],h=t[19]-t[11],t[11]+=t[19],t[19]=h*F[p+-216+7],h=t[16]-t[12],t[12]+=t[16],t[16]=h*F[p+-252+7],h=t[17]-t[13],t[13]+=t[17],t[17]=h*F[p+-252+7],h=-t[20]+t[24],t[20]+=t[24],t[24]=h*F[p+-216+7],h=-t[21]+t[25],t[21]+=t[25],t[25]=h*F[p+-216+7],h=t[4]-t[8],t[4]+=t[8],t[8]=h*F[p+-216+7],h=t[5]-t[9],t[5]+=t[9],t[9]=h*F[p+-216+7],h=t[0]-t[12],t[0]+=t[12],t[12]=h*F[p+-72+7],h=t[1]-t[13],t[1]+=t[13],t[13]=h*F[p+-72+7],h=t[16]-t[28],t[16]+=t[28],t[28]=h*F[p+-72+7],h=-t[17]+t[29],t[17]+=t[29],t[29]=h*F[p+-72+7],h=i.SQRT2*(t[2]-t[10]),t[2]+=t[10],t[10]=h,h=i.SQRT2*(t[3]-t[11]),t[3]+=t[11],t[11]=h,h=i.SQRT2*(-t[18]+t[26]),t[18]+=t[26],t[26]=h-t[18],h=i.SQRT2*(-t[19]+t[27]),t[19]+=t[27],t[27]=h-t[19],h=t[2],t[19]-=t[3],t[3]-=h,t[2]=t[31]-h,t[31]+=h,h=t[3],t[11]-=t[19],t[18]-=h,t[3]=t[30]-h,t[30]+=h,h=t[18],t[27]-=t[11],t[19]-=h,t[18]=t[15]-h,t[15]+=h,h=t[19],t[10]-=h,t[19]=t[14]-h,t[14]+=h,h=t[10],t[11]-=h,t[10]=t[23]-h,t[23]+=h,h=t[11],t[26]-=h,t[11]=t[22]-h,t[22]+=h,h=t[26],t[27]-=h,t[26]=t[7]-h,t[7]+=h,h=t[27],t[27]=t[6]-h,t[6]+=h,h=i.SQRT2*(t[0]-t[4]),t[0]+=t[4],t[4]=h,h=i.SQRT2*(t[1]-t[5]),t[1]+=t[5],t[5]=h,h=i.SQRT2*(t[16]-t[20]),t[16]+=t[20],t[20]=h,h=i.SQRT2*(t[17]-t[21]),t[17]+=t[21],t[21]=h,h=-i.SQRT2*(t[8]-t[12]),t[8]+=t[12],t[12]=h-t[8],h=-i.SQRT2*(t[9]-t[13]),t[9]+=t[13],t[13]=h-t[9],h=-i.SQRT2*(t[25]-t[29]),t[25]+=t[29],t[29]=h-t[25],h=-i.SQRT2*(t[24]+t[28]),t[24]-=t[28],t[28]=h-t[24],h=t[24]-t[16],t[24]=h,h=t[20]-h,t[20]=h,h=t[28]-h,t[28]=h,h=t[25]-t[17],t[25]=h,h=t[21]-h,t[21]=h,h=t[29]-h,t[29]=h,h=t[17]-t[1],t[17]=h,h=t[9]-h,t[9]=h,h=t[25]-h,t[25]=h,h=t[5]-h,t[5]=h,h=t[21]-h,t[21]=h,h=t[13]-h,t[13]=h,h=t[29]-h,t[29]=h,h=t[1]-t[0],t[1]=h,h=t[16]-h,t[16]=h,h=t[17]-h,t[17]=h,h=t[8]-h,t[8]=h,h=t[9]-h,t[9]=h,h=t[24]-h,t[24]=h,h=t[25]-h,t[25]=h,h=t[4]-h,t[4]=h,h=t[5]-h,t[5]=h,h=t[20]-h,t[20]=h,h=t[21]-h,t[21]=h,h=t[12]-h,t[12]=h,h=t[13]-h,t[13]=h,h=t[28]-h,t[28]=h,h=t[29]-h,t[29]=h,h=t[0],t[0]+=t[31],t[31]-=h,h=t[1],t[1]+=t[30],t[30]-=h,h=t[16],t[16]+=t[15],t[15]-=h,h=t[17],t[17]+=t[14],t[14]-=h,h=t[8],t[8]+=t[23],t[23]-=h,h=t[9],t[9]+=t[22],t[22]-=h,h=t[24],t[24]+=t[7],t[7]-=h,h=t[25],t[25]+=t[6],t[6]-=h,h=t[4],t[4]+=t[27],t[27]-=h,h=t[5],t[5]+=t[26],t[26]-=h,h=t[20],t[20]+=t[11],t[11]-=h,h=t[21],t[21]+=t[10],t[10]-=h,h=t[12],t[12]+=t[19],t[19]-=h,h=t[13],t[13]+=t[18],t[18]-=h,h=t[28],t[28]+=t[3],t[3]-=h,h=t[29],t[29]+=t[2],t[2]-=h}}function V(n,r){for(var t=0;t<3;t++){var p,L,v,M,y,Z;M=n[r+6]*q[X.SHORT_TYPE][0]-n[r+15],p=n[r+0]*q[X.SHORT_TYPE][2]-n[r+9],L=M+p,v=M-p,M=n[r+15]*q[X.SHORT_TYPE][0]+n[r+6],p=n[r+9]*q[X.SHORT_TYPE][2]+n[r+0],y=M+p,Z=-M+p,p=(n[r+3]*q[X.SHORT_TYPE][1]-n[r+12])*2069978111953089e-26,M=(n[r+12]*q[X.SHORT_TYPE][1]+n[r+3])*2069978111953089e-26,n[r+0]=L*190752519173728e-25+p,n[r+15]=-y*190752519173728e-25+M,v=v*.8660254037844387*1907525191737281e-26,y=y*.5*1907525191737281e-26+M,n[r+3]=v-y,n[r+6]=v+y,L=L*.5*1907525191737281e-26-p,Z=Z*.8660254037844387*1907525191737281e-26,n[r+9]=L+Z,n[r+12]=L-Z,r++}}function B(n,r,t){var p,L;{var v,M,y,Z,j,D,h,x;v=t[17]-t[9],y=t[15]-t[11],Z=t[14]-t[12],j=t[0]+t[8],D=t[1]+t[7],h=t[2]+t[6],x=t[3]+t[5],n[r+17]=j+h-x-(D-t[4]),L=(j+h-x)*g[19]+(D-t[4]),p=(v-y-Z)*g[18],n[r+5]=p+L,n[r+6]=p-L,M=(t[16]-t[10])*g[18],D=D*g[19]+t[4],p=v*g[12]+M+y*g[13]+Z*g[14],L=-j*g[16]+D-h*g[17]+x*g[15],n[r+1]=p+L,n[r+2]=p-L,p=v*g[13]-M-y*g[14]+Z*g[12],L=-j*g[17]+D-h*g[15]+x*g[16],n[r+9]=p+L,n[r+10]=p-L,p=v*g[14]-M+y*g[12]-Z*g[13],L=j*g[15]-D+h*g[16]-x*g[17],n[r+13]=p+L,n[r+14]=p-L}{var k,T,W,G,P,N,A,f;k=t[8]-t[0],W=t[6]-t[2],G=t[5]-t[3],P=t[17]+t[9],N=t[16]+t[10],A=t[15]+t[11],f=t[14]+t[12],n[r+0]=P+A+f+(N+t[13]),p=(P+A+f)*g[19]-(N+t[13]),L=(k-W+G)*g[18],n[r+11]=p+L,n[r+12]=p-L,T=(t[7]-t[1])*g[18],N=t[13]-N*g[19],p=P*g[15]-N+A*g[16]+f*g[17],L=k*g[14]+T+W*g[12]+G*g[13],n[r+3]=p+L,n[r+4]=p-L,p=-P*g[17]+N-A*g[15]-f*g[16],L=k*g[13]+T-W*g[14]-G*g[12],n[r+7]=p+L,n[r+8]=p-L,p=-P*g[16]+N-A*g[17]-f*g[15],L=k*g[12]-T+W*g[13]-G*g[14],n[r+15]=p+L,n[r+16]=p-L}}this.mdct_sub48=function(n,r,t){for(var p=r,L=286,v=0;v<n.channels_out;v++){for(var M=0;M<n.mode_gr;M++){for(var y,Z=n.l3_side.tt[M][v],j=Z.xr,D=0,h=n.sb_sample[v][1-M],x=0,k=0;k<18/2;k++)for(m(p,L,h[x]),m(p,L+32,h[x+1]),x+=2,L+=64,y=1;y<32;y+=2)h[x-1][y]*=-1;for(y=0;y<32;y++,D+=18){var T=Z.block_type,W=n.sb_sample[v][M],G=n.sb_sample[v][1-M];if(Z.mixed_block_flag!=0&&y<2&&(T=0),n.amp_filter[y]<1e-12)R.fill(j,D+0,D+18,0);else{if(n.amp_filter[y]<1)for(var k=0;k<18;k++)G[k][_[y]]*=n.amp_filter[y];if(T==X.SHORT_TYPE){for(var k=-12/4;k<0;k++){var P=q[X.SHORT_TYPE][k+3];j[D+k*3+9]=W[9+k][_[y]]*P-W[8-k][_[y]],j[D+k*3+18]=W[14-k][_[y]]*P+W[15+k][_[y]],j[D+k*3+10]=W[15+k][_[y]]*P-W[14-k][_[y]],j[D+k*3+19]=G[2-k][_[y]]*P+G[3+k][_[y]],j[D+k*3+11]=G[3+k][_[y]]*P-G[2-k][_[y]],j[D+k*3+20]=G[8-k][_[y]]*P+G[9+k][_[y]]}V(j,D)}else{for(var N=O(18),k=-36/4;k<0;k++){var A,f;A=q[T][k+27]*G[k+9][_[y]]+q[T][k+36]*G[8-k][_[y]],f=q[T][k+9]*W[k+9][_[y]]-q[T][k+18]*W[8-k][_[y]],N[k+9]=A-f*ee[3+k+9],N[k+18]=A*ee[3+k+9]+f}B(j,D,N)}}if(T!=X.SHORT_TYPE&&y!=0)for(var k=7;k>=0;--k){var l,s;l=j[D+k]*e[20+k]+j[D+-1-k]*a[28+k],s=j[D+k]*a[28+k]-j[D+-1-k]*e[20+k],j[D+-1-k]=l,j[D+k]=s}}}if(p=t,L=286,n.mode_gr==1)for(var u=0;u<18;u++)z.arraycopy(n.sb_sample[v][1][u],0,n.sb_sample[v][0][u],0,32)}}}return Fa=Y,Fa}var qa,wn;function o1(){if(wn)return qa;wn=1;var S=dt(),z=et,i=z.System,R=z.new_float,O=z.new_float_n;function X(){this.l=R(S.SBMAX_l),this.s=O([S.SBMAX_s,3]);var Y=this;this.assign=function(F){i.arraycopy(F.l,0,Y.l,0,S.SBMAX_l);for(var q=0;q<S.SBMAX_s;q++)for(var ee=0;ee<3;ee++)Y.s[q][ee]=F.s[q][ee]}}return qa=X,qa}var Ya,yn;function G1(){if(yn)return Ya;yn=1;var S=o1();function z(){this.thm=new S,this.en=new S}return Ya=z,Ya}function Pt(S){var z=S;this.ordinal=function(){return z}}Pt.STEREO=new Pt(0);Pt.JOINT_STEREO=new Pt(1);Pt.DUAL_CHANNEL=new Pt(2);Pt.MONO=new Pt(3);Pt.NOT_SET=new Pt(4);var ba=Pt,ja,An;function dt(){if(An)return ja;An=1;var S=et,z=S.System,i=S.VbrMode,R=S.new_array_n,O=S.new_float,X=S.new_float_n,Y=S.new_int,F=S.assert;q.ENCDELAY=576,q.POSTDELAY=1152,q.MDCTDELAY=48,q.FFTOFFSET=224+q.MDCTDELAY,q.DECDELAY=528,q.SBLIMIT=32,q.CBANDS=64,q.SBPSY_l=21,q.SBPSY_s=12,q.SBMAX_l=22,q.SBMAX_s=13,q.PSFB21=6,q.PSFB12=6,q.BLKSIZE=1024,q.HBLKSIZE=q.BLKSIZE/2+1,q.BLKSIZE_s=256,q.HBLKSIZE_s=q.BLKSIZE_s/2+1,q.NORM_TYPE=0,q.START_TYPE=1,q.SHORT_TYPE=2,q.STOP_TYPE=3,q.MPG_MD_LR_LR=0,q.MPG_MD_LR_I=1,q.MPG_MD_MS_LR=2,q.MPG_MD_MS_I=3,q.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function q(){var ee=j1(),g=G1(),e=ba,a=q.FFTOFFSET,_=q.MPG_MD_MS_LR,m=null;this.psy=null;var V=null,B=null,n=null;this.setModules=function(v,M,y,Z){m=v,this.psy=M,V=M,B=Z,n=y};var r=new ee;function t(v){var M,y;if(v.ATH.useAdjust==0){v.ATH.adjust=1;return}if(y=v.loudness_sq[0][0],M=v.loudness_sq[1][0],v.channels_out==2?(y+=v.loudness_sq[0][1],M+=v.loudness_sq[1][1]):(y+=y,M+=M),v.mode_gr==2&&(y=Math.max(y,M)),y*=.5,y*=v.ATH.aaSensitivityP,y>.03125)v.ATH.adjust>=1?v.ATH.adjust=1:v.ATH.adjust<v.ATH.adjustLimit&&(v.ATH.adjust=v.ATH.adjustLimit),v.ATH.adjustLimit=1;else{var Z=31.98*y+625e-6;v.ATH.adjust>=Z?(v.ATH.adjust*=Z*.075+.925,v.ATH.adjust<Z&&(v.ATH.adjust=Z)):v.ATH.adjustLimit>=Z?v.ATH.adjust=Z:v.ATH.adjust<v.ATH.adjustLimit&&(v.ATH.adjust=v.ATH.adjustLimit),v.ATH.adjustLimit=Z}}function p(v){var M,y;for(F(0<=v.bitrate_index&&v.bitrate_index<16),F(0<=v.mode_ext&&v.mode_ext<4),v.bitrate_stereoMode_Hist[v.bitrate_index][4]++,v.bitrate_stereoMode_Hist[15][4]++,v.channels_out==2&&(v.bitrate_stereoMode_Hist[v.bitrate_index][v.mode_ext]++,v.bitrate_stereoMode_Hist[15][v.mode_ext]++),M=0;M<v.mode_gr;++M)for(y=0;y<v.channels_out;++y){var Z=v.l3_side.tt[M][y].block_type|0;v.l3_side.tt[M][y].mixed_block_flag!=0&&(Z=4),v.bitrate_blockType_Hist[v.bitrate_index][Z]++,v.bitrate_blockType_Hist[v.bitrate_index][5]++,v.bitrate_blockType_Hist[15][Z]++,v.bitrate_blockType_Hist[15][5]++}}function L(v,M){var y=v.internal_flags,Z,j;if(y.lame_encode_frame_init==0){var D,h,x=O(2014),k=O(2014);for(y.lame_encode_frame_init=1,D=0,h=0;D<286+576*(1+y.mode_gr);++D)D<576*y.mode_gr?(x[D]=0,y.channels_out==2&&(k[D]=0)):(x[D]=M[0][h],y.channels_out==2&&(k[D]=M[1][h]),++h);for(j=0;j<y.mode_gr;j++)for(Z=0;Z<y.channels_out;Z++)y.l3_side.tt[j][Z].block_type=q.SHORT_TYPE;r.mdct_sub48(y,x,k),F(576>=q.FFTOFFSET),F(y.mf_size>=q.BLKSIZE+v.framesize-q.FFTOFFSET),F(y.mf_size>=512+v.framesize-32)}}this.lame_encode_mp3_frame=function(v,M,y,Z,j,D){var h,x=R([2,2]);x[0][0]=new g,x[0][1]=new g,x[1][0]=new g,x[1][1]=new g;var k=R([2,2]);k[0][0]=new g,k[0][1]=new g,k[1][0]=new g,k[1][1]=new g;var T,W=[null,null],G=v.internal_flags,P=X([2,4]),N=[.5,.5],A=[[0,0],[0,0]],f=[[0,0],[0,0]],l,s,u;if(W[0]=M,W[1]=y,G.lame_encode_frame_init==0&&L(v,W),G.padding=0,(G.slot_lag-=G.frac_SpF)<0&&(G.slot_lag+=v.out_samplerate,G.padding=1),G.psymodel!=0){var w,J=[null,null],ne=0,H=Y(2);for(u=0;u<G.mode_gr;u++){for(s=0;s<G.channels_out;s++)J[s]=W[s],ne=576+u*576-q.FFTOFFSET;if(v.VBR==i.vbr_mtrh||v.VBR==i.vbr_mt?w=V.L3psycho_anal_vbr(v,J,ne,u,x,k,A[u],f[u],P[u],H):w=V.L3psycho_anal_ns(v,J,ne,u,x,k,A[u],f[u],P[u],H),w!=0)return-4;for(v.mode==e.JOINT_STEREO&&(N[u]=P[u][2]+P[u][3],N[u]>0&&(N[u]=P[u][3]/N[u])),s=0;s<G.channels_out;s++){var U=G.l3_side.tt[u][s];U.block_type=H[s],U.mixed_block_flag=0}}}else for(u=0;u<G.mode_gr;u++)for(s=0;s<G.channels_out;s++)G.l3_side.tt[u][s].block_type=q.NORM_TYPE,G.l3_side.tt[u][s].mixed_block_flag=0,f[u][s]=A[u][s]=700;if(t(G),r.mdct_sub48(G,W[0],W[1]),G.mode_ext=q.MPG_MD_LR_LR,v.force_ms)G.mode_ext=q.MPG_MD_MS_LR;else if(v.mode==e.JOINT_STEREO){var le=0,de=0;for(u=0;u<G.mode_gr;u++)for(s=0;s<G.channels_out;s++)le+=f[u][s],de+=A[u][s];if(le<=1*de){var ve=G.l3_side.tt[0],Ae=G.l3_side.tt[G.mode_gr-1];ve[0].block_type==ve[1].block_type&&Ae[0].block_type==Ae[1].block_type&&(G.mode_ext=q.MPG_MD_MS_LR)}}if(G.mode_ext==_?(T=k,l=f):(T=x,l=A),v.analysis&&G.pinfo!=null)for(u=0;u<G.mode_gr;u++)for(s=0;s<G.channels_out;s++)G.pinfo.ms_ratio[u]=G.ms_ratio[u],G.pinfo.ms_ener_ratio[u]=N[u],G.pinfo.blocktype[u][s]=G.l3_side.tt[u][s].block_type,G.pinfo.pe[u][s]=l[u][s],z.arraycopy(G.l3_side.tt[u][s].xr,0,G.pinfo.xr[u][s],0,576),G.mode_ext==_&&(G.pinfo.ers[u][s]=G.pinfo.ers[u][s+2],z.arraycopy(G.pinfo.energy[u][s+2],0,G.pinfo.energy[u][s],0,G.pinfo.energy[u][s].length));if(v.VBR==i.vbr_off||v.VBR==i.vbr_abr){var ge,we;for(ge=0;ge<18;ge++)G.nsPsy.pefirbuf[ge]=G.nsPsy.pefirbuf[ge+1];for(we=0,u=0;u<G.mode_gr;u++)for(s=0;s<G.channels_out;s++)we+=l[u][s];for(G.nsPsy.pefirbuf[18]=we,we=G.nsPsy.pefirbuf[9],ge=0;ge<9;ge++)we+=(G.nsPsy.pefirbuf[ge]+G.nsPsy.pefirbuf[18-ge])*q.fircoef[ge];for(we=670*5*G.mode_gr*G.channels_out/we,u=0;u<G.mode_gr;u++)for(s=0;s<G.channels_out;s++)l[u][s]*=we}if(G.iteration_loop.iteration_loop(v,l,N,T),m.format_bitstream(v),h=m.copy_buffer(G,Z,j,D,1),v.bWriteVbrTag&&B.addVbrFrame(v),v.analysis&&G.pinfo!=null){for(s=0;s<G.channels_out;s++){var Be;for(Be=0;Be<a;Be++)G.pinfo.pcmdata[s][Be]=G.pinfo.pcmdata[s][Be+v.framesize];for(Be=a;Be<1600;Be++)G.pinfo.pcmdata[s][Be]=W[s][Be-a]}n.set_frame_pinfo(v,T)}return p(G),h}}return ja=q,ja}var l1=et,Sn=l1.Util,kn=l1.new_float,st=dt();function Z1(){var S=kn(st.BLKSIZE),z=kn(st.BLKSIZE_s/2),i=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function R(X,Y,F){var q=0,ee,g,e;F<<=1;var a=Y+F;ee=4;do{var _,m,V,B,n,r,t;t=ee>>1,B=ee,n=ee<<1,r=n+B,ee=n<<1,g=Y,e=g+t;do{var p,L,v,M;L=X[g+0]-X[g+B],p=X[g+0]+X[g+B],M=X[g+n]-X[g+r],v=X[g+n]+X[g+r],X[g+n]=p-v,X[g+0]=p+v,X[g+r]=L-M,X[g+B]=L+M,L=X[e+0]-X[e+B],p=X[e+0]+X[e+B],M=Sn.SQRT2*X[e+r],v=Sn.SQRT2*X[e+n],X[e+n]=p-v,X[e+0]=p+v,X[e+r]=L-M,X[e+B]=L+M,e+=ee,g+=ee}while(g<a);for(m=i[q+0],_=i[q+1],V=1;V<t;V++){var y,Z;y=1-2*_*_,Z=2*_*m,g=Y+V,e=Y+B-V;do{var j,D,h,p,L,x,v,k,M,T;D=Z*X[g+B]-y*X[e+B],j=y*X[g+B]+Z*X[e+B],L=X[g+0]-j,p=X[g+0]+j,x=X[e+0]-D,h=X[e+0]+D,D=Z*X[g+r]-y*X[e+r],j=y*X[g+r]+Z*X[e+r],M=X[g+n]-j,v=X[g+n]+j,T=X[e+n]-D,k=X[e+n]+D,D=_*v-m*T,j=m*v+_*T,X[g+n]=p-j,X[g+0]=p+j,X[e+r]=x-D,X[e+B]=x+D,D=m*k-_*M,j=_*k+m*M,X[e+n]=h-j,X[e+0]=h+j,X[g+r]=L-D,X[g+B]=L+D,e+=ee,g+=ee}while(g<a);y=m,m=y*i[q+0]-_*i[q+1],_=y*i[q+1]+_*i[q+0]}q+=2}while(ee<F)}var O=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(X,Y,F,q,ee){for(var g=0;g<3;g++){var e=st.BLKSIZE_s/2,a=65535&576/3*(g+1),_=st.BLKSIZE_s/8-1;do{var m,V,B,n,r,t=O[_<<2]&255;m=z[t]*q[F][ee+t+a],r=z[127-t]*q[F][ee+t+a+128],V=m-r,m=m+r,B=z[t+64]*q[F][ee+t+a+64],r=z[63-t]*q[F][ee+t+a+192],n=B-r,B=B+r,e-=4,Y[g][e+0]=m+B,Y[g][e+2]=m-B,Y[g][e+1]=V+n,Y[g][e+3]=V-n,m=z[t+1]*q[F][ee+t+a+1],r=z[126-t]*q[F][ee+t+a+129],V=m-r,m=m+r,B=z[t+65]*q[F][ee+t+a+65],r=z[62-t]*q[F][ee+t+a+193],n=B-r,B=B+r,Y[g][e+st.BLKSIZE_s/2+0]=m+B,Y[g][e+st.BLKSIZE_s/2+2]=m-B,Y[g][e+st.BLKSIZE_s/2+1]=V+n,Y[g][e+st.BLKSIZE_s/2+3]=V-n}while(--_>=0);R(Y[g],e,st.BLKSIZE_s/2)}},this.fft_long=function(X,Y,F,q,ee){var g=st.BLKSIZE/8-1,e=st.BLKSIZE/2;do{var a,_,m,V,B,n=O[g]&255;a=S[n]*q[F][ee+n],B=S[n+512]*q[F][ee+n+512],_=a-B,a=a+B,m=S[n+256]*q[F][ee+n+256],B=S[n+768]*q[F][ee+n+768],V=m-B,m=m+B,e-=4,Y[e+0]=a+m,Y[e+2]=a-m,Y[e+1]=_+V,Y[e+3]=_-V,a=S[n+1]*q[F][ee+n+1],B=S[n+513]*q[F][ee+n+513],_=a-B,a=a+B,m=S[n+257]*q[F][ee+n+257],B=S[n+769]*q[F][ee+n+769],V=m-B,m=m+B,Y[e+st.BLKSIZE/2+0]=a+m,Y[e+st.BLKSIZE/2+2]=a-m,Y[e+st.BLKSIZE/2+1]=_+V,Y[e+st.BLKSIZE/2+3]=_-V}while(--g>=0);R(Y,e,st.BLKSIZE/2)},this.init_fft=function(X){for(var Y=0;Y<st.BLKSIZE;Y++)S[Y]=.42-.5*Math.cos(2*Math.PI*(Y+.5)/st.BLKSIZE)+.08*Math.cos(4*Math.PI*(Y+.5)/st.BLKSIZE);for(var Y=0;Y<st.BLKSIZE_s/2;Y++)z[Y]=.5*(1-Math.cos(2*Math.PI*(Y+.5)/st.BLKSIZE_s))}}var Q1=Z1,Ot=et,$t=Ot.VbrMode,Mn=Ot.Float,zt=Ot.ShortBlock,bt=Ot.Util,$1=Ot.Arrays,ot=Ot.new_float,Mt=Ot.new_float_n,Ft=Ot.new_int,Ce=Ot.assert,z1=Q1,oe=dt();function W1(){var S=ba,z=new z1,i=2.302585092994046,R=2,O=16,X=2,Y=16,F=.34,q=1/(14752*14752)/(oe.BLKSIZE/2),ee=.01,g=.8,e=.6,a=.3,_=3.5,m=21,V=.2302585093;function B(d,b){for(var I=0,C=0;C<oe.BLKSIZE/2;++C)I+=d[C]*b.ATH.eql_w[C];return I*=q,I}function n(d,b,I,C,$,E,K,te,Q,ie,ae){var se=d.internal_flags;if(Q<2)z.fft_long(se,C[$],Q,ie,ae),z.fft_short(se,E[K],Q,ie,ae);else if(Q==2){for(var pe=oe.BLKSIZE-1;pe>=0;--pe){var Pe=C[$+0][pe],_e=C[$+1][pe];C[$+0][pe]=(Pe+_e)*bt.SQRT2*.5,C[$+1][pe]=(Pe-_e)*bt.SQRT2*.5}for(var Ee=2;Ee>=0;--Ee)for(var pe=oe.BLKSIZE_s-1;pe>=0;--pe){var Pe=E[K+0][Ee][pe],_e=E[K+1][Ee][pe];E[K+0][Ee][pe]=(Pe+_e)*bt.SQRT2*.5,E[K+1][Ee][pe]=(Pe-_e)*bt.SQRT2*.5}}b[0]=C[$+0][0],b[0]*=b[0];for(var pe=oe.BLKSIZE/2-1;pe>=0;--pe){var re=C[$+0][oe.BLKSIZE/2-pe],ye=C[$+0][oe.BLKSIZE/2+pe];b[oe.BLKSIZE/2-pe]=(re*re+ye*ye)*.5}for(var Ee=2;Ee>=0;--Ee){I[Ee][0]=E[K+0][Ee][0],I[Ee][0]*=I[Ee][0];for(var pe=oe.BLKSIZE_s/2-1;pe>=0;--pe){var re=E[K+0][Ee][oe.BLKSIZE_s/2-pe],ye=E[K+0][Ee][oe.BLKSIZE_s/2+pe];I[Ee][oe.BLKSIZE_s/2-pe]=(re*re+ye*ye)*.5}}{for(var Xe=0,pe=11;pe<oe.HBLKSIZE;pe++)Xe+=b[pe];se.tot_ener[Q]=Xe}if(d.analysis){for(var pe=0;pe<oe.HBLKSIZE;pe++)se.pinfo.energy[te][Q][pe]=se.pinfo.energy_save[Q][pe],se.pinfo.energy_save[Q][pe]=b[pe];se.pinfo.pe[te][Q]=se.pe[Q]}d.athaa_loudapprox==2&&Q<2&&(se.loudness_sq[te][Q]=se.loudness_sq_save[Q],se.loudness_sq_save[Q]=B(b,se))}var r=8,t=23,p=15,L,v,M,y=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function Z(){L=Math.pow(10,(r+1)/16),v=Math.pow(10,(t+1)/16),M=Math.pow(10,p/10)}var j=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],D=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],h=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function x(d,b,I,C,$,E){var K;if(b>d)if(b<d*v)K=b/d;else return d+b;else{if(d>=b*v)return d+b;K=d/b}if(d+=b,C+3<=6){if(K>=L)return d;var te=0|bt.FAST_LOG10_X(K,16);return d*D[te]}var te=0|bt.FAST_LOG10_X(K,16);if(b=$.ATH.cb_l[I]*$.ATH.adjust,d<M*b){if(d>b){var Q,ie;return Q=1,te<=13&&(Q=h[te]),ie=bt.FAST_LOG10_X(d/b,10/15),d*((j[te]-Q)*ie+Q)}return te>13?d:d*h[te]}return d*j[te]}var k=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function T(d,b,I){var C;if(d<0&&(d=0),b<0&&(b=0),d<=0)return b;if(b<=0)return d;if(b>d?C=b/d:C=d/b,-2<=I&&I<=2){if(C>=L)return d+b;var $=0|bt.FAST_LOG10_X(C,16);return(d+b)*k[$]}return C<v?d+b:(d<b&&(d=b),d)}function W(d,b){var I=d.internal_flags;if(I.channels_out>1){for(var C=0;C<oe.SBMAX_l;C++){var $=I.thm[0].l[C],E=I.thm[1].l[C];I.thm[0].l[C]+=E*b,I.thm[1].l[C]+=$*b}for(var C=0;C<oe.SBMAX_s;C++)for(var K=0;K<3;K++){var $=I.thm[0].s[C][K],E=I.thm[1].s[C][K];I.thm[0].s[C][K]+=E*b,I.thm[1].s[C][K]+=$*b}}}function G(d){for(var b=0;b<oe.SBMAX_l;b++)if(!(d.thm[0].l[b]>1.58*d.thm[1].l[b]||d.thm[1].l[b]>1.58*d.thm[0].l[b])){var I=d.mld_l[b]*d.en[3].l[b],C=Math.max(d.thm[2].l[b],Math.min(d.thm[3].l[b],I));I=d.mld_l[b]*d.en[2].l[b];var $=Math.max(d.thm[3].l[b],Math.min(d.thm[2].l[b],I));d.thm[2].l[b]=C,d.thm[3].l[b]=$}for(var b=0;b<oe.SBMAX_s;b++)for(var E=0;E<3;E++)if(!(d.thm[0].s[b][E]>1.58*d.thm[1].s[b][E]||d.thm[1].s[b][E]>1.58*d.thm[0].s[b][E])){var I=d.mld_s[b]*d.en[3].s[b][E],C=Math.max(d.thm[2].s[b][E],Math.min(d.thm[3].s[b][E],I));I=d.mld_s[b]*d.en[2].s[b][E];var $=Math.max(d.thm[3].s[b][E],Math.min(d.thm[2].s[b][E],I));d.thm[2].s[b][E]=C,d.thm[3].s[b][E]=$}}function P(d,b,I){var C=b,$=Math.pow(10,I);b*=2,C*=2;for(var E=0;E<oe.SBMAX_l;E++){var K,te,Q,ie;if(ie=d.ATH.cb_l[d.bm_l[E]]*$,K=Math.min(Math.max(d.thm[0].l[E],ie),Math.max(d.thm[1].l[E],ie)),te=Math.max(d.thm[2].l[E],ie),Q=Math.max(d.thm[3].l[E],ie),K*b<te+Q){var ae=K*C/(te+Q);te*=ae,Q*=ae}d.thm[2].l[E]=Math.min(te,d.thm[2].l[E]),d.thm[3].l[E]=Math.min(Q,d.thm[3].l[E])}$*=oe.BLKSIZE_s/oe.BLKSIZE;for(var E=0;E<oe.SBMAX_s;E++)for(var se=0;se<3;se++){var K,te,Q,ie;if(ie=d.ATH.cb_s[d.bm_s[E]]*$,K=Math.min(Math.max(d.thm[0].s[E][se],ie),Math.max(d.thm[1].s[E][se],ie)),te=Math.max(d.thm[2].s[E][se],ie),Q=Math.max(d.thm[3].s[E][se],ie),K*b<te+Q){var ae=K*b/(te+Q);te*=ae,Q*=ae}d.thm[2].s[E][se]=Math.min(d.thm[2].s[E][se],te),d.thm[3].s[E][se]=Math.min(d.thm[3].s[E][se],Q)}}function N(d,b,I,C,$){var E,K,te=0,Q=0;for(E=K=0;E<oe.SBMAX_s;++K,++E){for(var ie=d.bo_s[E],ae=d.npart_s,se=ie<ae?ie:ae;K<se;)Ce(b[K]>=0),Ce(I[K]>=0),te+=b[K],Q+=I[K],K++;if(d.en[C].s[E][$]=te,d.thm[C].s[E][$]=Q,K>=ae){++E;break}Ce(b[K]>=0),Ce(I[K]>=0);{var pe=d.PSY.bo_s_weight[E],Pe=1-pe;te=pe*b[K],Q=pe*I[K],d.en[C].s[E][$]+=te,d.thm[C].s[E][$]+=Q,te=Pe*b[K],Q=Pe*I[K]}}for(;E<oe.SBMAX_s;++E)d.en[C].s[E][$]=0,d.thm[C].s[E][$]=0}function A(d,b,I,C){var $,E,K=0,te=0;for($=E=0;$<oe.SBMAX_l;++E,++$){for(var Q=d.bo_l[$],ie=d.npart_l,ae=Q<ie?Q:ie;E<ae;)Ce(b[E]>=0),Ce(I[E]>=0),K+=b[E],te+=I[E],E++;if(d.en[C].l[$]=K,d.thm[C].l[$]=te,E>=ie){++$;break}Ce(b[E]>=0),Ce(I[E]>=0);{var se=d.PSY.bo_l_weight[$],pe=1-se;K=se*b[E],te=se*I[E],d.en[C].l[$]+=K,d.thm[C].l[$]+=te,K=pe*b[E],te=pe*I[E]}}for(;$<oe.SBMAX_l;++$)d.en[C].l[$]=0,d.thm[C].l[$]=0}function f(d,b,I,C,$,E){var K=d.internal_flags,te,Q;for(Q=te=0;Q<K.npart_s;++Q){for(var ie=0,ae=K.numlines_s[Q],se=0;se<ae;++se,++te){var pe=b[E][te];ie+=pe}I[Q]=ie}for(Ce(Q==K.npart_s),te=Q=0;Q<K.npart_s;Q++){var Pe=K.s3ind_s[Q][0],_e=K.s3_ss[te++]*I[Pe];for(++Pe;Pe<=K.s3ind_s[Q][1];)_e+=K.s3_ss[te]*I[Pe],++te,++Pe;{var Ee=X*K.nb_s1[$][Q];C[Q]=Math.min(_e,Ee)}if(K.blocktype_old[$&1]==oe.SHORT_TYPE){var Ee=Y*K.nb_s2[$][Q],re=C[Q];C[Q]=Math.min(Ee,re)}K.nb_s2[$][Q]=K.nb_s1[$][Q],K.nb_s1[$][Q]=_e,Ce(C[Q]>=0)}for(;Q<=oe.CBANDS;++Q)I[Q]=0,C[Q]=0}function l(d,b,I,C){var $=d.internal_flags;d.short_blocks==zt.short_block_coupled&&!(b[0]!=0&&b[1]!=0)&&(b[0]=b[1]=0);for(var E=0;E<$.channels_out;E++)C[E]=oe.NORM_TYPE,d.short_blocks==zt.short_block_dispensed&&(b[E]=1),d.short_blocks==zt.short_block_forced&&(b[E]=0),b[E]!=0?(Ce($.blocktype_old[E]!=oe.START_TYPE),$.blocktype_old[E]==oe.SHORT_TYPE&&(C[E]=oe.STOP_TYPE)):(C[E]=oe.SHORT_TYPE,$.blocktype_old[E]==oe.NORM_TYPE&&($.blocktype_old[E]=oe.START_TYPE),$.blocktype_old[E]==oe.STOP_TYPE&&($.blocktype_old[E]=oe.SHORT_TYPE)),I[E]=$.blocktype_old[E],$.blocktype_old[E]=C[E]}function s(d,b,I){return I>=1?d:I<=0?b:b>0?Math.pow(d/b,I)*b:0}var u=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function w(d,b){for(var I=309.07,C=0;C<oe.SBMAX_s-1;C++)for(var $=0;$<3;$++){var E=d.thm.s[C][$];if(E>0){var K=E*b,te=d.en.s[C][$];te>K&&(te>K*1e10?I+=u[C]*(10*i):I+=u[C]*bt.FAST_LOG10(te/K))}}return I}var J=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function ne(d,b){for(var I=281.0575,C=0;C<oe.SBMAX_l-1;C++){var $=d.thm.l[C];if($>0){var E=$*b,K=d.en.l[C];K>E&&(K>E*1e10?I+=J[C]*(10*i):I+=J[C]*bt.FAST_LOG10(K/E))}}return I}function H(d,b,I,C,$){var E,K;for(E=K=0;E<d.npart_l;++E){var te=0,Q=0,ie;for(ie=0;ie<d.numlines_l[E];++ie,++K){var ae=b[K];te+=ae,Q<ae&&(Q=ae)}I[E]=te,C[E]=Q,$[E]=te*d.rnumlines_l[E],Ce(d.rnumlines_l[E]>=0),Ce(I[E]>=0),Ce(C[E]>=0),Ce($[E]>=0)}}function U(d,b,I,C){var $=y.length-1,E=0,K=I[E]+I[E+1];if(K>0){var te=b[E];te<b[E+1]&&(te=b[E+1]),Ce(d.numlines_l[E]+d.numlines_l[E+1]-1>0),K=20*(te*2-K)/(K*(d.numlines_l[E]+d.numlines_l[E+1]-1));var Q=0|K;Q>$&&(Q=$),C[E]=Q}else C[E]=0;for(E=1;E<d.npart_l-1;E++)if(K=I[E-1]+I[E]+I[E+1],K>0){var te=b[E-1];te<b[E]&&(te=b[E]),te<b[E+1]&&(te=b[E+1]),Ce(d.numlines_l[E-1]+d.numlines_l[E]+d.numlines_l[E+1]-1>0),K=20*(te*3-K)/(K*(d.numlines_l[E-1]+d.numlines_l[E]+d.numlines_l[E+1]-1));var Q=0|K;Q>$&&(Q=$),C[E]=Q}else C[E]=0;if(Ce(E==d.npart_l-1),K=I[E-1]+I[E],K>0){var te=b[E-1];te<b[E]&&(te=b[E]),Ce(d.numlines_l[E-1]+d.numlines_l[E]-1>0),K=20*(te*2-K)/(K*(d.numlines_l[E-1]+d.numlines_l[E]-1));var Q=0|K;Q>$&&(Q=$),C[E]=Q}else C[E]=0;Ce(E==d.npart_l-1)}var le=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(d,b,I,C,$,E,K,te,Q,ie){var ae=d.internal_flags,se=Mt([2,oe.BLKSIZE]),pe=Mt([2,3,oe.BLKSIZE_s]),Pe=ot(oe.CBANDS+1),_e=ot(oe.CBANDS+1),Ee=ot(oe.CBANDS+2),re=Ft(2),ye=Ft(2),Xe,fe,ke,ue,Ve,$e,he,Oe,Ne=Mt([2,576]),We,wt=Ft(oe.CBANDS+2),rt=Ft(oe.CBANDS+2);for($1.fill(rt,0),Xe=ae.channels_out,d.mode==S.JOINT_STEREO&&(Xe=4),d.VBR==$t.vbr_off?We=ae.ResvMax==0?0:ae.ResvSize/ae.ResvMax*.5:d.VBR==$t.vbr_rh||d.VBR==$t.vbr_mtrh||d.VBR==$t.vbr_mt?We=.6:We=1,fe=0;fe<ae.channels_out;fe++){var Ke=b[fe],mt=I+576-350-m+192;for(ue=0;ue<576;ue++){var yt,At;for(yt=Ke[mt+ue+10],At=0,Ve=0;Ve<(m-1)/2-1;Ve+=2)yt+=le[Ve]*(Ke[mt+ue+Ve]+Ke[mt+ue+m-Ve]),At+=le[Ve+1]*(Ke[mt+ue+Ve+1]+Ke[mt+ue+m-Ve-1]);Ne[fe][ue]=yt+At}$[C][fe].en.assign(ae.en[fe]),$[C][fe].thm.assign(ae.thm[fe]),Xe>2&&(E[C][fe].en.assign(ae.en[fe+2]),E[C][fe].thm.assign(ae.thm[fe+2]))}for(fe=0;fe<Xe;fe++){var Bt,xt,ut=ot(12),It=[0,0,0,0],Qt=ot(12),Va=1,_n,fn=ot(oe.CBANDS),un=ot(oe.CBANDS),Je=[0,0,0,0],cn=ot(oe.HBLKSIZE),dn=Mt([3,oe.HBLKSIZE_s]);for(Ce(ae.npart_s<=oe.CBANDS),Ce(ae.npart_l<=oe.CBANDS),ue=0;ue<3;ue++)ut[ue]=ae.nsPsy.last_en_subshort[fe][ue+6],Ce(ae.nsPsy.last_en_subshort[fe][ue+4]>0),Qt[ue]=ut[ue]/ae.nsPsy.last_en_subshort[fe][ue+4],It[0]+=ut[ue];if(fe==2)for(ue=0;ue<576;ue++){var Da,La;Da=Ne[0][ue],La=Ne[1][ue],Ne[0][ue]=Da+La,Ne[1][ue]=Da-La}{var pn=Ne[fe&1],ra=0;for(ue=0;ue<9;ue++){for(var y1=ra+64,_t=1;ra<y1;ra++)_t<Math.abs(pn[ra])&&(_t=Math.abs(pn[ra]));ae.nsPsy.last_en_subshort[fe][ue]=ut[ue+3]=_t,It[1+ue/3]+=_t,_t>ut[ue+3-2]?(Ce(ut[ue+3-2]>0),_t=_t/ut[ue+3-2]):ut[ue+3-2]>_t*10?_t=ut[ue+3-2]/(_t*10):_t=0,Qt[ue+3]=_t}}if(d.analysis){var Oa=Qt[0];for(ue=1;ue<12;ue++)Oa<Qt[ue]&&(Oa=Qt[ue]);ae.pinfo.ers[C][fe]=ae.pinfo.ers_save[fe],ae.pinfo.ers_save[fe]=Oa}for(_n=fe==3?ae.nsPsy.attackthre_s:ae.nsPsy.attackthre,ue=0;ue<12;ue++)Je[ue/3]==0&&Qt[ue]>_n&&(Je[ue/3]=ue%3+1);for(ue=1;ue<4;ue++){var Ha;It[ue-1]>It[ue]?(Ce(It[ue]>0),Ha=It[ue-1]/It[ue]):(Ce(It[ue-1]>0),Ha=It[ue]/It[ue-1]),Ha<1.7&&(Je[ue]=0,ue==1&&(Je[0]=0))}for(Je[0]!=0&&ae.nsPsy.lastAttacks[fe]!=0&&(Je[0]=0),(ae.nsPsy.lastAttacks[fe]==3||Je[0]+Je[1]+Je[2]+Je[3]!=0)&&(Va=0,Je[1]!=0&&Je[0]!=0&&(Je[1]=0),Je[2]!=0&&Je[1]!=0&&(Je[2]=0),Je[3]!=0&&Je[2]!=0&&(Je[3]=0)),fe<2?ye[fe]=Va:Va==0&&(ye[0]=ye[1]=0),Q[fe]=ae.tot_ener[fe],xt=pe,Bt=se,n(d,cn,dn,Bt,fe&1,xt,fe&1,C,fe,b,I),H(ae,cn,Pe,fn,un),U(ae,fn,un,wt),Oe=0;Oe<3;Oe++){var Ca,ht;for(f(d,dn,_e,Ee,fe,Oe),N(ae,_e,Ee,fe,Oe),he=0;he<oe.SBMAX_s;he++){if(ht=ae.thm[fe].s[he][Oe],ht*=g,Je[Oe]>=2||Je[Oe+1]==1){var sa=Oe!=0?Oe-1:2,_t=s(ae.thm[fe].s[he][sa],ht,e*We);ht=Math.min(ht,_t)}if(Je[Oe]==1){var sa=Oe!=0?Oe-1:2,_t=s(ae.thm[fe].s[he][sa],ht,a*We);ht=Math.min(ht,_t)}else if(Oe!=0&&Je[Oe-1]==3||Oe==0&&ae.nsPsy.lastAttacks[fe]==3){var sa=Oe!=2?Oe+1:0,_t=s(ae.thm[fe].s[he][sa],ht,a*We);ht=Math.min(ht,_t)}Ca=ut[Oe*3+3]+ut[Oe*3+4]+ut[Oe*3+5],ut[Oe*3+5]*6<Ca&&(ht*=.5,ut[Oe*3+4]*6<Ca&&(ht*=.5)),ae.thm[fe].s[he][Oe]=ht}}for(ae.nsPsy.lastAttacks[fe]=Je[2],$e=0,ke=0;ke<ae.npart_l;ke++){for(var Xt=ae.s3ind[ke][0],Xa=Pe[Xt]*y[wt[Xt]],Nt=ae.s3_ll[$e++]*Xa;++Xt<=ae.s3ind[ke][1];)Xa=Pe[Xt]*y[wt[Xt]],Nt=x(Nt,ae.s3_ll[$e++]*Xa,Xt,Xt-ke,ae);Nt*=.158489319246111,ae.blocktype_old[fe&1]==oe.SHORT_TYPE?Ee[ke]=Nt:Ee[ke]=s(Math.min(Nt,Math.min(R*ae.nb_1[fe][ke],O*ae.nb_2[fe][ke])),Nt,We),ae.nb_2[fe][ke]=ae.nb_1[fe][ke],ae.nb_1[fe][ke]=Nt}for(;ke<=oe.CBANDS;++ke)Pe[ke]=0,Ee[ke]=0;A(ae,Pe,Ee,fe)}if((d.mode==S.STEREO||d.mode==S.JOINT_STEREO)&&d.interChRatio>0&&W(d,d.interChRatio),d.mode==S.JOINT_STEREO){var Na;G(ae),Na=d.msfix,Math.abs(Na)>0&&P(ae,Na,d.ATHlower*ae.ATH.adjust)}for(l(d,ye,ie,re),fe=0;fe<Xe;fe++){var ia,oa=0,va,ga;fe>1?(ia=te,oa=-2,va=oe.NORM_TYPE,(ie[0]==oe.SHORT_TYPE||ie[1]==oe.SHORT_TYPE)&&(va=oe.SHORT_TYPE),ga=E[C][fe-2]):(ia=K,oa=0,va=ie[fe],ga=$[C][fe]),va==oe.SHORT_TYPE?ia[oa+fe]=w(ga,ae.masking_lower):ia[oa+fe]=ne(ga,ae.masking_lower),d.analysis&&(ae.pinfo.pe[C][fe]=ia[oa+fe])}return 0};function de(d,b,I,C,$,E,K,te){var Q=d.internal_flags;if(C<2)z.fft_long(Q,K[te],C,b,I);else if(C==2)for(var ie=oe.BLKSIZE-1;ie>=0;--ie){var ae=K[te+0][ie],se=K[te+1][ie];K[te+0][ie]=(ae+se)*bt.SQRT2*.5,K[te+1][ie]=(ae-se)*bt.SQRT2*.5}E[0]=K[te+0][0],E[0]*=E[0];for(var ie=oe.BLKSIZE/2-1;ie>=0;--ie){var pe=K[te+0][oe.BLKSIZE/2-ie],Pe=K[te+0][oe.BLKSIZE/2+ie];E[oe.BLKSIZE/2-ie]=(pe*pe+Pe*Pe)*.5}{for(var _e=0,ie=11;ie<oe.HBLKSIZE;ie++)_e+=E[ie];Q.tot_ener[C]=_e}if(d.analysis){for(var ie=0;ie<oe.HBLKSIZE;ie++)Q.pinfo.energy[$][C][ie]=Q.pinfo.energy_save[C][ie],Q.pinfo.energy_save[C][ie]=E[ie];Q.pinfo.pe[$][C]=Q.pe[C]}}function ve(d,b,I,C,$,E,K,te){var Q=d.internal_flags;if($==0&&C<2&&z.fft_short(Q,K[te],C,b,I),C==2)for(var ie=oe.BLKSIZE_s-1;ie>=0;--ie){var ae=K[te+0][$][ie],se=K[te+1][$][ie];K[te+0][$][ie]=(ae+se)*bt.SQRT2*.5,K[te+1][$][ie]=(ae-se)*bt.SQRT2*.5}E[$][0]=K[te+0][$][0],E[$][0]*=E[$][0];for(var ie=oe.BLKSIZE_s/2-1;ie>=0;--ie){var pe=K[te+0][$][oe.BLKSIZE_s/2-ie],Pe=K[te+0][$][oe.BLKSIZE_s/2+ie];E[$][oe.BLKSIZE_s/2-ie]=(pe*pe+Pe*Pe)*.5}}function Ae(d,b,I,C){var $=d.internal_flags;d.athaa_loudapprox==2&&I<2&&($.loudness_sq[b][I]=$.loudness_sq_save[I],$.loudness_sq_save[I]=B(C,$))}var ge=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function we(d,b,I,C,$,E,K,te,Q,ie){for(var ae=Mt([2,576]),se=d.internal_flags,pe=se.channels_out,Pe=d.mode==S.JOINT_STEREO?4:pe,_e=0;_e<pe;_e++){firbuf=b[_e];for(var Ee=I+576-350-m+192,re=0;re<576;re++){var ye,Xe;ye=firbuf[Ee+re+10],Xe=0;for(var fe=0;fe<(m-1)/2-1;fe+=2)ye+=ge[fe]*(firbuf[Ee+re+fe]+firbuf[Ee+re+m-fe]),Xe+=ge[fe+1]*(firbuf[Ee+re+fe+1]+firbuf[Ee+re+m-fe-1]);ae[_e][re]=ye+Xe}$[C][_e].en.assign(se.en[_e]),$[C][_e].thm.assign(se.thm[_e]),Pe>2&&(E[C][_e].en.assign(se.en[_e+2]),E[C][_e].thm.assign(se.thm[_e+2]))}for(var _e=0;_e<Pe;_e++){var ke=ot(12),ue=ot(12),Ve=[0,0,0,0],$e=ae[_e&1],he=0,Oe=_e==3?se.nsPsy.attackthre_s:se.nsPsy.attackthre,Ne=1;if(_e==2)for(var re=0,fe=576;fe>0;++re,--fe){var We=ae[0][re],wt=ae[1][re];ae[0][re]=We+wt,ae[1][re]=We-wt}for(var re=0;re<3;re++)ue[re]=se.nsPsy.last_en_subshort[_e][re+6],Ce(se.nsPsy.last_en_subshort[_e][re+4]>0),ke[re]=ue[re]/se.nsPsy.last_en_subshort[_e][re+4],Ve[0]+=ue[re];for(var re=0;re<9;re++){for(var rt=he+64,Ke=1;he<rt;he++)Ke<Math.abs($e[he])&&(Ke=Math.abs($e[he]));se.nsPsy.last_en_subshort[_e][re]=ue[re+3]=Ke,Ve[1+re/3]+=Ke,Ke>ue[re+3-2]?(Ce(ue[re+3-2]>0),Ke=Ke/ue[re+3-2]):ue[re+3-2]>Ke*10?Ke=ue[re+3-2]/(Ke*10):Ke=0,ke[re+3]=Ke}for(var re=0;re<3;++re){var mt=ue[re*3+3]+ue[re*3+4]+ue[re*3+5],yt=1;ue[re*3+5]*6<mt&&(yt*=.5,ue[re*3+4]*6<mt&&(yt*=.5)),te[_e][re]=yt}if(d.analysis){for(var At=ke[0],re=1;re<12;re++)At<ke[re]&&(At=ke[re]);se.pinfo.ers[C][_e]=se.pinfo.ers_save[_e],se.pinfo.ers_save[_e]=At}for(var re=0;re<12;re++)Q[_e][re/3]==0&&ke[re]>Oe&&(Q[_e][re/3]=re%3+1);for(var re=1;re<4;re++){var Bt=Ve[re-1],xt=Ve[re],ut=Math.max(Bt,xt);ut<4e4&&Bt<1.7*xt&&xt<1.7*Bt&&(re==1&&Q[_e][0]<=Q[_e][re]&&(Q[_e][0]=0),Q[_e][re]=0)}Q[_e][0]<=se.nsPsy.lastAttacks[_e]&&(Q[_e][0]=0),(se.nsPsy.lastAttacks[_e]==3||Q[_e][0]+Q[_e][1]+Q[_e][2]+Q[_e][3]!=0)&&(Ne=0,Q[_e][1]!=0&&Q[_e][0]!=0&&(Q[_e][1]=0),Q[_e][2]!=0&&Q[_e][1]!=0&&(Q[_e][2]=0),Q[_e][3]!=0&&Q[_e][2]!=0&&(Q[_e][3]=0)),_e<2?ie[_e]=Ne:Ne==0&&(ie[0]=ie[1]=0),K[_e]=se.tot_ener[_e]}}function Be(d,b,I){if(I==0)for(var C=0;C<d.npart_s;C++)d.nb_s2[b][C]=d.nb_s1[b][C],d.nb_s1[b][C]=0}function Qe(d,b){for(var I=0;I<d.npart_l;I++)d.nb_2[b][I]=d.nb_1[b][I],d.nb_1[b][I]=0}function kt(d,b,I,C){var $=y.length-1,E=0,K=I[E]+I[E+1];if(K>0){var te=b[E];te<b[E+1]&&(te=b[E+1]),Ce(d.numlines_s[E]+d.numlines_s[E+1]-1>0),K=20*(te*2-K)/(K*(d.numlines_s[E]+d.numlines_s[E+1]-1));var Q=0|K;Q>$&&(Q=$),C[E]=Q}else C[E]=0;for(E=1;E<d.npart_s-1;E++)if(K=I[E-1]+I[E]+I[E+1],Ce(E+1<d.npart_s),K>0){var te=b[E-1];te<b[E]&&(te=b[E]),te<b[E+1]&&(te=b[E+1]),Ce(d.numlines_s[E-1]+d.numlines_s[E]+d.numlines_s[E+1]-1>0),K=20*(te*3-K)/(K*(d.numlines_s[E-1]+d.numlines_s[E]+d.numlines_s[E+1]-1));var Q=0|K;Q>$&&(Q=$),C[E]=Q}else C[E]=0;if(Ce(E==d.npart_s-1),K=I[E-1]+I[E],K>0){var te=b[E-1];te<b[E]&&(te=b[E]),Ce(d.numlines_s[E-1]+d.numlines_s[E]-1>0),K=20*(te*2-K)/(K*(d.numlines_s[E-1]+d.numlines_s[E]-1));var Q=0|K;Q>$&&(Q=$),C[E]=Q}else C[E]=0;Ce(E==d.npart_s-1)}function o(d,b,I,C,$,E){var K=d.internal_flags,te=new float[oe.CBANDS],Q=ot(oe.CBANDS),ie,ae,se,pe=new int[oe.CBANDS];for(se=ae=0;se<K.npart_s;++se){var Pe=0,_e=0,Ee=K.numlines_s[se];for(ie=0;ie<Ee;++ie,++ae){var re=b[E][ae];Pe+=re,_e<re&&(_e=re)}I[se]=Pe,te[se]=_e,Q[se]=Pe/Ee,Ce(Q[se]>=0)}for(Ce(se==K.npart_s);se<oe.CBANDS;++se)te[se]=0,Q[se]=0;for(kt(K,te,Q,pe),ae=se=0;se<K.npart_s;se++){var ye=K.s3ind_s[se][0],Xe=K.s3ind_s[se][1],fe,ke,ue,Ve,$e;for(fe=pe[ye],ke=1,Ve=K.s3_ss[ae]*I[ye]*y[pe[ye]],++ae,++ye;ye<=Xe;)fe+=pe[ye],ke+=1,ue=K.s3_ss[ae]*I[ye]*y[pe[ye]],Ve=T(Ve,ue,ye-se),++ae,++ye;fe=(1+2*fe)/(2*ke),$e=y[fe]*.5,Ve*=$e,C[se]=Ve,K.nb_s2[$][se]=K.nb_s1[$][se],K.nb_s1[$][se]=Ve,ue=te[se],ue*=K.minval_s[se],ue*=$e,C[se]>ue&&(C[se]=ue),K.masking_lower>1&&(C[se]*=K.masking_lower),C[se]>I[se]&&(C[se]=I[se]),K.masking_lower<1&&(C[se]*=K.masking_lower),Ce(C[se]>=0)}for(;se<oe.CBANDS;++se)I[se]=0,C[se]=0}function c(d,b,I,C,$){var E=ot(oe.CBANDS),K=ot(oe.CBANDS),te=Ft(oe.CBANDS+2),Q;H(d,b,I,E,K),U(d,E,K,te);var ie=0;for(Q=0;Q<d.npart_l;Q++){var ae,se,pe,Pe,_e=d.s3ind[Q][0],Ee=d.s3ind[Q][1],re=0,ye=0;for(re=te[_e],ye+=1,se=d.s3_ll[ie]*I[_e]*y[te[_e]],++ie,++_e;_e<=Ee;)re+=te[_e],ye+=1,ae=d.s3_ll[ie]*I[_e]*y[te[_e]],Pe=T(se,ae,_e-Q),se=Pe,++ie,++_e;if(re=(1+2*re)/(2*ye),pe=y[re]*.5,se*=pe,d.blocktype_old[$&1]==oe.SHORT_TYPE){var Xe=R*d.nb_1[$][Q];Xe>0?C[Q]=Math.min(se,Xe):C[Q]=Math.min(se,I[Q]*a)}else{var fe=O*d.nb_2[$][Q],ke=R*d.nb_1[$][Q],Xe;fe<=0&&(fe=se),ke<=0&&(ke=se),d.blocktype_old[$&1]==oe.NORM_TYPE?Xe=Math.min(ke,fe):Xe=ke,C[Q]=Math.min(se,Xe)}d.nb_2[$][Q]=d.nb_1[$][Q],d.nb_1[$][Q]=se,ae=E[Q],ae*=d.minval_l[Q],ae*=pe,C[Q]>ae&&(C[Q]=ae),d.masking_lower>1&&(C[Q]*=d.masking_lower),C[Q]>I[Q]&&(C[Q]=I[Q]),d.masking_lower<1&&(C[Q]*=d.masking_lower),Ce(C[Q]>=0)}for(;Q<oe.CBANDS;++Q)I[Q]=0,C[Q]=0}function be(d,b){var I=d.internal_flags;d.short_blocks==zt.short_block_coupled&&!(b[0]!=0&&b[1]!=0)&&(b[0]=b[1]=0);for(var C=0;C<I.channels_out;C++)d.short_blocks==zt.short_block_dispensed&&(b[C]=1),d.short_blocks==zt.short_block_forced&&(b[C]=0)}function Se(d,b,I){for(var C=d.internal_flags,$=0;$<C.channels_out;$++){var E=oe.NORM_TYPE;b[$]!=0?(Ce(C.blocktype_old[$]!=oe.START_TYPE),C.blocktype_old[$]==oe.SHORT_TYPE&&(E=oe.STOP_TYPE)):(E=oe.SHORT_TYPE,C.blocktype_old[$]==oe.NORM_TYPE&&(C.blocktype_old[$]=oe.START_TYPE),C.blocktype_old[$]==oe.STOP_TYPE&&(C.blocktype_old[$]=oe.SHORT_TYPE)),I[$]=C.blocktype_old[$],C.blocktype_old[$]=E}}function De(d,b,I,C,$,E,K){for(var te=E*2,Q=E>0?Math.pow(10,$):1,ie,ae,se=0;se<K;++se){var pe=d[2][se],Pe=d[3][se],_e=b[0][se],Ee=b[1][se],re=b[2][se],ye=b[3][se];if(_e<=1.58*Ee&&Ee<=1.58*_e){var Xe=I[se]*Pe,fe=I[se]*pe;ae=Math.max(re,Math.min(ye,Xe)),ie=Math.max(ye,Math.min(re,fe))}else ae=re,ie=ye;if(E>0){var ke,ue,Ve=C[se]*Q;if(ke=Math.min(Math.max(_e,Ve),Math.max(Ee,Ve)),re=Math.max(ae,Ve),ye=Math.max(ie,Ve),ue=re+ye,ue>0&&ke*te<ue){var $e=ke*te/ue;re*=$e,ye*=$e}ae=Math.min(re,ae),ie=Math.min(ye,ie)}ae>pe&&(ae=pe),ie>Pe&&(ie=Pe),b[2][se]=ae,b[3][se]=ie}}this.L3psycho_anal_vbr=function(d,b,I,C,$,E,K,te,Q,ie){var ae=d.internal_flags,se,pe,Pe=ot(oe.HBLKSIZE),_e=Mt([3,oe.HBLKSIZE_s]),Ee=Mt([2,oe.BLKSIZE]),re=Mt([2,3,oe.BLKSIZE_s]),ye=Mt([4,oe.CBANDS]),Xe=Mt([4,oe.CBANDS]),fe=Mt([4,3]),ke=.6,ue=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Ve=Ft(2),$e=d.mode==S.JOINT_STEREO?4:ae.channels_out;we(d,b,I,C,$,E,Q,fe,ue,Ve),be(d,Ve);{for(var he=0;he<$e;he++){var Oe=he&1;se=Ee,de(d,b,I,he,C,Pe,se,Oe),Ae(d,C,he,Pe),Ve[Oe]!=0?c(ae,Pe,ye[he],Xe[he],he):Qe(ae,he)}Ve[0]+Ve[1]==2&&d.mode==S.JOINT_STEREO&&De(ye,Xe,ae.mld_cb_l,ae.ATH.cb_l,d.ATHlower*ae.ATH.adjust,d.msfix,ae.npart_l);for(var he=0;he<$e;he++){var Oe=he&1;Ve[Oe]!=0&&A(ae,ye[he],Xe[he],he)}}{for(var Ne=0;Ne<3;Ne++){for(var he=0;he<$e;++he){var Oe=he&1;Ve[Oe]!=0?Be(ae,he,Ne):(pe=re,ve(d,b,I,he,Ne,_e,pe,Oe),o(d,_e,ye[he],Xe[he],he,Ne))}Ve[0]+Ve[1]==0&&d.mode==S.JOINT_STEREO&&De(ye,Xe,ae.mld_cb_s,ae.ATH.cb_s,d.ATHlower*ae.ATH.adjust,d.msfix,ae.npart_s);for(var he=0;he<$e;++he){var Oe=he&1;Ve[Oe]==0&&N(ae,ye[he],Xe[he],he,Ne)}}for(var he=0;he<$e;he++){var Oe=he&1;if(Ve[Oe]==0)for(var We=0;We<oe.SBMAX_s;We++){for(var wt=ot(3),Ne=0;Ne<3;Ne++){var rt=ae.thm[he].s[We][Ne];if(rt*=g,ue[he][Ne]>=2||ue[he][Ne+1]==1){var Ke=Ne!=0?Ne-1:2,mt=s(ae.thm[he].s[We][Ke],rt,e*ke);rt=Math.min(rt,mt)}else if(ue[he][Ne]==1){var Ke=Ne!=0?Ne-1:2,mt=s(ae.thm[he].s[We][Ke],rt,a*ke);rt=Math.min(rt,mt)}else if(Ne!=0&&ue[he][Ne-1]==3||Ne==0&&ae.nsPsy.lastAttacks[he]==3){var Ke=Ne!=2?Ne+1:0,mt=s(ae.thm[he].s[We][Ke],rt,a*ke);rt=Math.min(rt,mt)}rt*=fe[he][Ne],wt[Ne]=rt}for(var Ne=0;Ne<3;Ne++)ae.thm[he].s[We][Ne]=wt[Ne]}}}for(var he=0;he<$e;he++)ae.nsPsy.lastAttacks[he]=ue[he][2];Se(d,Ve,ie);for(var he=0;he<$e;he++){var yt,At,Bt,xt;he>1?(yt=te,At=-2,Bt=oe.NORM_TYPE,(ie[0]==oe.SHORT_TYPE||ie[1]==oe.SHORT_TYPE)&&(Bt=oe.SHORT_TYPE),xt=E[C][he-2]):(yt=K,At=0,Bt=ie[he],xt=$[C][he]),Bt==oe.SHORT_TYPE?yt[At+he]=w(xt,ae.masking_lower):yt[At+he]=ne(xt,ae.masking_lower),d.analysis&&(ae.pinfo.pe[C][he]=yt[At+he])}return 0};function Re(d,b){var I=d,C;return I>=0?C=-I*27:C=I*b,C<=-72?0:Math.exp(C*V)}function xe(d){var b=0,I=0;{var C=0,$,E;for(C=0;Re(C,d)>1e-20;C-=1);for($=C,E=0;Math.abs(E-$)>1e-12;)C=(E+$)/2,Re(C,d)>0?E=C:$=C;b=$}{var C=0,$,E;for(C=0;Re(C,d)>1e-20;C+=1);for($=0,E=C;Math.abs(E-$)>1e-12;)C=(E+$)/2,Re(C,d)>0?$=C:E=C;I=E}{var K=0,te=1e3,Q;for(Q=0;Q<=te;++Q){var C=b+Q*(I-b)/te,ie=Re(C,d);K+=ie}{var ae=(te+1)/(K*(I-b));return ae}}}function Me(d){var b,I,C,$;return b=d,b>=0?b*=3:b*=1.5,b>=.5&&b<=2.5?($=b-.5,I=8*($*$-2*$)):I=0,b+=.474,C=15.811389+7.5*b-17.5*Math.sqrt(1+b*b),C<=-60?0:(b=Math.exp((I+C)*V),b/=.6609193,b)}function Le(d){return d<0&&(d=0),d=d*.001,13*Math.atan(.76*d)+3.5*Math.atan(d*d/(7.5*7.5))}function Ie(d,b,I,C,$,E,K,te,Q,ie,ae,se){var pe=ot(oe.CBANDS+1),Pe=te/(se>15?2*576:384),_e=Ft(oe.HBLKSIZE),Ee;te/=Q;var re=0,ye=0;for(Ee=0;Ee<oe.CBANDS;Ee++){var Xe,fe;for(Xe=Le(te*re),pe[Ee]=te*re,fe=re;Le(te*fe)-Xe<F&&fe<=Q/2;fe++);for(d[Ee]=fe-re,ye=Ee+1;re<fe;)Ce(re<oe.HBLKSIZE),_e[re++]=Ee;if(re>Q/2){re=Q/2,++Ee;break}}Ce(Ee<oe.CBANDS),pe[Ee]=te*re;for(var ke=0;ke<se;ke++){var ue,Ve,$e,he,Oe;$e=ie[ke],he=ie[ke+1],ue=0|Math.floor(.5+ae*($e-.5)),ue<0&&(ue=0),Ve=0|Math.floor(.5+ae*(he-.5)),Ve>Q/2&&(Ve=Q/2),I[ke]=(_e[ue]+_e[Ve])/2,b[ke]=_e[Ve];var Ne=Pe*he;K[ke]=(Ne-pe[b[ke]])/(pe[b[ke]+1]-pe[b[ke]]),K[ke]<0?K[ke]=0:K[ke]>1&&(K[ke]=1),Oe=Le(te*ie[ke]*ae),Oe=Math.min(Oe,15.5)/15.5,E[ke]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Oe))-2.5)}re=0;for(var We=0;We<ye;We++){var wt=d[We],Xe,rt;Xe=Le(te*re),rt=Le(te*(re+wt-1)),C[We]=.5*(Xe+rt),Xe=Le(te*(re-.5)),rt=Le(te*(re+wt-.5)),$[We]=rt-Xe,re+=wt}return ye}function me(d,b,I,C,$,E){var K=Mt([oe.CBANDS,oe.CBANDS]),te,Q=0;if(E)for(var ie=0;ie<b;ie++)for(te=0;te<b;te++){var ae=Me(I[ie]-I[te])*C[te];K[ie][te]=ae*$[ie]}else for(te=0;te<b;te++)for(var se=15+Math.min(21/I[te],12),pe=xe(se),ie=0;ie<b;ie++){var ae=pe*Re(I[ie]-I[te],se)*C[te];K[ie][te]=ae*$[ie]}for(var ie=0;ie<b;ie++){for(te=0;te<b&&!(K[ie][te]>0);te++);for(d[ie][0]=te,te=b-1;te>0&&!(K[ie][te]>0);te--);d[ie][1]=te,Q+=d[ie][1]-d[ie][0]+1}for(var Pe=ot(Q),_e=0,ie=0;ie<b;ie++)for(te=d[ie][0];te<=d[ie][1];te++)Pe[_e++]=K[ie][te];return Pe}function Ze(d){var b=Le(d);return b=Math.min(b,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*b))-2.5)}this.psymodel_init=function(d){var b=d.internal_flags,I,C=!0,$=13,E=24,K=0,te=0,Q=-8.25,ie=-4.5,ae=ot(oe.CBANDS),se=ot(oe.CBANDS),pe=ot(oe.CBANDS),Pe=d.out_samplerate;switch(d.experimentalZ){default:case 0:C=!0;break;case 1:C=!(d.VBR==$t.vbr_mtrh||d.VBR==$t.vbr_mt);break;case 2:C=!1;break;case 3:$=8,K=-1.75,te=-.0125,Q=-8.25,ie=-2.25;break}for(b.ms_ener_ratio_old=.25,b.blocktype_old[0]=b.blocktype_old[1]=oe.NORM_TYPE,I=0;I<4;++I){for(var re=0;re<oe.CBANDS;++re)b.nb_1[I][re]=1e20,b.nb_2[I][re]=1e20,b.nb_s1[I][re]=b.nb_s2[I][re]=1;for(var _e=0;_e<oe.SBMAX_l;_e++)b.en[I].l[_e]=1e20,b.thm[I].l[_e]=1e20;for(var re=0;re<3;++re){for(var _e=0;_e<oe.SBMAX_s;_e++)b.en[I].s[_e][re]=1e20,b.thm[I].s[_e][re]=1e20;b.nsPsy.lastAttacks[I]=0}for(var re=0;re<9;re++)b.nsPsy.last_en_subshort[I][re]=10}for(b.loudness_sq_save[0]=b.loudness_sq_save[1]=0,b.npart_l=Ie(b.numlines_l,b.bo_l,b.bm_l,ae,se,b.mld_l,b.PSY.bo_l_weight,Pe,oe.BLKSIZE,b.scalefac_band.l,oe.BLKSIZE/(2*576),oe.SBMAX_l),Ce(b.npart_l<oe.CBANDS),I=0;I<b.npart_l;I++){var Ee=K;ae[I]>=$&&(Ee=te*(ae[I]-$)/(E-$)+K*(E-ae[I])/(E-$)),pe[I]=Math.pow(10,Ee/10),b.numlines_l[I]>0?b.rnumlines_l[I]=1/b.numlines_l[I]:b.rnumlines_l[I]=0}b.s3_ll=me(b.s3ind,b.npart_l,ae,se,pe,C);var re=0;for(I=0;I<b.npart_l;I++){var ye;ye=Mn.MAX_VALUE;for(var Xe=0;Xe<b.numlines_l[I];Xe++,re++){var fe=Pe*re/(1e3*oe.BLKSIZE),ke;ke=this.ATHformula(fe*1e3,d)-20,ke=Math.pow(10,.1*ke),ke*=b.numlines_l[I],ye>ke&&(ye=ke)}b.ATH.cb_l[I]=ye,ye=-20+ae[I]*20/10,ye>6&&(ye=100),ye<-15&&(ye=-15),ye-=8,b.minval_l[I]=Math.pow(10,ye/10)*b.numlines_l[I]}for(b.npart_s=Ie(b.numlines_s,b.bo_s,b.bm_s,ae,se,b.mld_s,b.PSY.bo_s_weight,Pe,oe.BLKSIZE_s,b.scalefac_band.s,oe.BLKSIZE_s/384,oe.SBMAX_s),Ce(b.npart_s<oe.CBANDS),re=0,I=0;I<b.npart_s;I++){var ye,Ee=Q;ae[I]>=$&&(Ee=ie*(ae[I]-$)/(E-$)+Q*(E-ae[I])/(E-$)),pe[I]=Math.pow(10,Ee/10),ye=Mn.MAX_VALUE;for(var Xe=0;Xe<b.numlines_s[I];Xe++,re++){var fe=Pe*re/(1e3*oe.BLKSIZE_s),ke;ke=this.ATHformula(fe*1e3,d)-20,ke=Math.pow(10,.1*ke),ke*=b.numlines_s[I],ye>ke&&(ye=ke)}b.ATH.cb_s[I]=ye,ye=-7+ae[I]*7/12,ae[I]>12&&(ye*=1+Math.log(1+ye)*3.1),ae[I]<12&&(ye*=1+Math.log(1-ye)*2.3),ye<-15&&(ye=-15),ye-=8,b.minval_s[I]=Math.pow(10,ye/10)*b.numlines_s[I]}b.s3_ss=me(b.s3ind_s,b.npart_s,ae,se,pe,C),Z(),z.init_fft(b),b.decay=Math.exp(-1*i/(ee*Pe/192));{var ue;ue=_,d.exp_nspsytune&2&&(ue=1),Math.abs(d.msfix)>0&&(ue=d.msfix),d.msfix=ue;for(var Ve=0;Ve<b.npart_l;Ve++)b.s3ind[Ve][1]>b.npart_l-1&&(b.s3ind[Ve][1]=b.npart_l-1)}var $e=576*b.mode_gr/Pe;if(b.ATH.decay=Math.pow(10,-12/10*$e),b.ATH.adjust=.01,b.ATH.adjustLimit=1,Ce(b.bo_l[oe.SBMAX_l-1]<=b.npart_l),Ce(b.bo_s[oe.SBMAX_s-1]<=b.npart_s),d.ATHtype!=-1){var fe,he=d.out_samplerate/oe.BLKSIZE,Oe=0;for(fe=0,I=0;I<oe.BLKSIZE/2;++I)fe+=he,b.ATH.eql_w[I]=1/Math.pow(10,this.ATHformula(fe,d)/10),Oe+=b.ATH.eql_w[I];for(Oe=1/Oe,I=oe.BLKSIZE/2;--I>=0;)b.ATH.eql_w[I]*=Oe}{for(var Ve=re=0;Ve<b.npart_s;++Ve)for(I=0;I<b.numlines_s[Ve];++I)++re;for(var Ve=re=0;Ve<b.npart_l;++Ve)for(I=0;I<b.numlines_l[Ve];++I)++re}for(re=0,I=0;I<b.npart_l;I++){var fe=Pe*(re+b.numlines_l[I]/2)/(1*oe.BLKSIZE);b.mld_cb_l[I]=Ze(fe),re+=b.numlines_l[I]}for(;I<oe.CBANDS;++I)b.mld_cb_l[I]=1;for(re=0,I=0;I<b.npart_s;I++){var fe=Pe*(re+b.numlines_s[I]/2)/(1*oe.BLKSIZE_s);b.mld_cb_s[I]=Ze(fe),re+=b.numlines_s[I]}for(;I<oe.CBANDS;++I)b.mld_cb_s[I]=1;return 0};function tt(d,b){d<-.3&&(d=3410),d/=1e3,d=Math.max(.1,d);var I=3.64*Math.pow(d,-.8)-6.8*Math.exp(-.6*Math.pow(d-3.4,2))+6*Math.exp(-.15*Math.pow(d-8.7,2))+(.6+.04*b)*.001*Math.pow(d,4);return I}this.ATHformula=function(d,b){var I;switch(b.ATHtype){case 0:I=tt(d,9);break;case 1:I=tt(d,-1);break;case 2:I=tt(d,0);break;case 3:I=tt(d,1)+6;break;case 4:I=tt(d,b.ATHcurve);break;default:I=tt(d,0);break}return I}}var K1=W1,J1=ba;function U1(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=J1.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var er=U1,tr=dt(),_1={};_1.SFBMAX=tr.SBMAX_s*3;var Ea=_1,f1=et,ar=f1.new_float,qt=f1.new_int,Ga=Ea;function nr(){this.xr=ar(576),this.l3_enc=qt(576),this.scalefac=qt(Ga.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=qt(3),this.subblock_gain=qt(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=qt(Ga.SFBMAX),this.window=qt(Ga.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=qt(4),this.max_nonzero_coeff=0;var S=this;function z(R){return new Int32Array(R)}function i(R){return new Float32Array(R)}this.assign=function(R){S.xr=i(R.xr),S.l3_enc=z(R.l3_enc),S.scalefac=z(R.scalefac),S.xrpow_max=R.xrpow_max,S.part2_3_length=R.part2_3_length,S.big_values=R.big_values,S.count1=R.count1,S.global_gain=R.global_gain,S.scalefac_compress=R.scalefac_compress,S.block_type=R.block_type,S.mixed_block_flag=R.mixed_block_flag,S.table_select=z(R.table_select),S.subblock_gain=z(R.subblock_gain),S.region0_count=R.region0_count,S.region1_count=R.region1_count,S.preflag=R.preflag,S.scalefac_scale=R.scalefac_scale,S.count1table_select=R.count1table_select,S.part2_length=R.part2_length,S.sfb_lmax=R.sfb_lmax,S.sfb_smin=R.sfb_smin,S.psy_lmax=R.psy_lmax,S.sfbmax=R.sfbmax,S.psymax=R.psymax,S.sfbdivide=R.sfbdivide,S.width=z(R.width),S.window=z(R.window),S.count1bits=R.count1bits,S.sfb_partition_table=R.sfb_partition_table.slice(0),S.slen=z(R.slen),S.max_nonzero_coeff=R.max_nonzero_coeff}}var an=nr,rr=et,Tn=rr.new_int,sr=an;function ir(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Tn(4),Tn(4)];for(var S=0;S<2;S++)for(var z=0;z<2;z++)this.tt[S][z]=new sr}var or=ir,u1=et,Aa=u1.System,Sa=u1.new_int,ka=dt();function lr(S,z,i,R){this.l=Sa(1+ka.SBMAX_l),this.s=Sa(1+ka.SBMAX_s),this.psfb21=Sa(1+ka.PSFB21),this.psfb12=Sa(1+ka.PSFB12);var O=this.l,X=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Aa.arraycopy(this.arrL,0,O,0,Math.min(this.arrL.length,this.l.length)),Aa.arraycopy(this.arrS,0,X,0,Math.min(this.arrS.length,this.s.length)),Aa.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Aa.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var c1=lr,nn=et,Za=nn.new_float,_r=nn.new_float_n,fr=nn.new_int,Bn=dt();function ur(){this.last_en_subshort=_r([4,9]),this.lastAttacks=fr(4),this.pefirbuf=Za(19),this.longfact=Za(Bn.SBMAX_l),this.shortfact=Za(Bn.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var cr=ur;function dr(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var pr=dr,ta=et,mr=ta.new_byte,hr=ta.new_double,Tt=ta.new_float,Yt=ta.new_float_n,Rt=ta.new_int,Ma=ta.new_int_n,br=or,vr=c1,gr=cr,wr=pr,xn=o1(),at=dt(),yr=Ea;Dt.MFSIZE=3*1152+at.ENCDELAY-at.MDCTDELAY;Dt.MAX_HEADER_BUF=256;Dt.MAX_BITS_PER_CHANNEL=4095;Dt.MAX_BITS_PER_GRANULE=7680;Dt.BPC=320;function Dt(){var S=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Yt([2,Dt.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new br,this.ms_ratio=Tt(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=Rt(2),this.CurrentStep=Rt(2),this.masking_lower=0,this.bv_scf=Rt(576),this.pseudohalf=Rt(yr.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Dt.BPC+1),this.itime=hr(2),this.sideinfo_len=0,this.sb_sample=Yt([2,2,18,at.SBLIMIT]),this.amp_filter=Tt(32);function z(){this.write_timing=0,this.ptr=0,this.buf=mr(S)}this.header=new Array(Dt.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new vr,this.minval_l=Tt(at.CBANDS),this.minval_s=Tt(at.CBANDS),this.nb_1=Yt([4,at.CBANDS]),this.nb_2=Yt([4,at.CBANDS]),this.nb_s1=Yt([4,at.CBANDS]),this.nb_s2=Yt([4,at.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Tt(4),this.loudness_sq=Yt([2,2]),this.loudness_sq_save=Tt(2),this.mld_l=Tt(at.SBMAX_l),this.mld_s=Tt(at.SBMAX_s),this.bm_l=Rt(at.SBMAX_l),this.bo_l=Rt(at.SBMAX_l),this.bm_s=Rt(at.SBMAX_s),this.bo_s=Rt(at.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Ma([at.CBANDS,2]),this.s3ind_s=Ma([at.CBANDS,2]),this.numlines_s=Rt(at.CBANDS),this.numlines_l=Rt(at.CBANDS),this.rnumlines_l=Tt(at.CBANDS),this.mld_cb_l=Tt(at.CBANDS),this.mld_cb_s=Tt(at.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Tt(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=Rt(2),this.nsPsy=new gr,this.VBR_seek_table=new wr,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Ma([16,5]),this.bitrate_blockType_Hist=Ma([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var i=0;i<this.en.length;i++)this.en[i]=new xn;for(var i=0;i<this.thm.length;i++)this.thm[i]=new xn;for(var i=0;i<this.header.length;i++)this.header[i]=new z}var Pa=Dt,Ar=et,jt=Ar.new_float,Gt=dt();function Sr(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=jt(Gt.SBMAX_l),this.s=jt(Gt.SBMAX_s),this.psfb21=jt(Gt.PSFB21),this.psfb12=jt(Gt.PSFB12),this.cb_l=jt(Gt.CBANDS),this.cb_s=jt(Gt.CBANDS),this.eql_w=jt(Gt.BLKSIZE/2)}var kr=Sr,d1=et,vt=d1.System,Rn=d1.Arrays;nt.STEPS_per_dB=100;nt.MAX_dB=120;nt.GAIN_NOT_ENOUGH_SAMPLES=-24601;nt.GAIN_ANALYSIS_ERROR=0;nt.GAIN_ANALYSIS_OK=1;nt.INIT_GAIN_ANALYSIS_ERROR=0;nt.INIT_GAIN_ANALYSIS_OK=1;nt.YULE_ORDER=10;nt.MAX_ORDER=nt.YULE_ORDER;nt.MAX_SAMP_FREQ=48e3;nt.RMS_WINDOW_TIME_NUMERATOR=1;nt.RMS_WINDOW_TIME_DENOMINATOR=20;nt.MAX_SAMPLES_PER_WINDOW=nt.MAX_SAMP_FREQ*nt.RMS_WINDOW_TIME_NUMERATOR/nt.RMS_WINDOW_TIME_DENOMINATOR+1;function nt(){var S=64.82,z=.95,i=nt.RMS_WINDOW_TIME_NUMERATOR,R=nt.RMS_WINDOW_TIME_DENOMINATOR,O=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],X=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function Y(e,a,_,m,V,B){for(;V--!=0;)_[m]=1e-10+e[a+0]*B[0]-_[m-1]*B[1]+e[a-1]*B[2]-_[m-2]*B[3]+e[a-2]*B[4]-_[m-3]*B[5]+e[a-3]*B[6]-_[m-4]*B[7]+e[a-4]*B[8]-_[m-5]*B[9]+e[a-5]*B[10]-_[m-6]*B[11]+e[a-6]*B[12]-_[m-7]*B[13]+e[a-7]*B[14]-_[m-8]*B[15]+e[a-8]*B[16]-_[m-9]*B[17]+e[a-9]*B[18]-_[m-10]*B[19]+e[a-10]*B[20],++m,++a}function F(e,a,_,m,V,B){for(;V--!=0;)_[m]=e[a+0]*B[0]-_[m-1]*B[1]+e[a-1]*B[2]-_[m-2]*B[3]+e[a-2]*B[4],++m,++a}function q(e,a){for(var _=0;_<MAX_ORDER;_++)e.linprebuf[_]=e.lstepbuf[_]=e.loutbuf[_]=e.rinprebuf[_]=e.rstepbuf[_]=e.routbuf[_]=0;switch(0|a){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(a*i+R-1)/R,e.lsum=0,e.rsum=0,e.totsamp=0,Rn.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(e,a){return q(e,a)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,Rn.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)};function ee(e){return e*e}this.AnalyzeSamples=function(e,a,_,m,V,B,n){var r,t,p,L,v,M,y;if(B==0)return GAIN_ANALYSIS_OK;switch(y=0,v=B,n){case 1:m=a,V=_;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(B<MAX_ORDER?(vt.arraycopy(a,_,e.linprebuf,MAX_ORDER,B),vt.arraycopy(m,V,e.rinprebuf,MAX_ORDER,B)):(vt.arraycopy(a,_,e.linprebuf,MAX_ORDER,MAX_ORDER),vt.arraycopy(m,V,e.rinprebuf,MAX_ORDER,MAX_ORDER));v>0;){M=v>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:v,y<MAX_ORDER?(r=e.linpre+y,t=e.linprebuf,p=e.rinpre+y,L=e.rinprebuf,M>MAX_ORDER-y&&(M=MAX_ORDER-y)):(r=_+y,t=a,p=V+y,L=m),Y(t,r,e.lstepbuf,e.lstep+e.totsamp,M,O[e.reqindex]),Y(L,p,e.rstepbuf,e.rstep+e.totsamp,M,O[e.reqindex]),F(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,M,X[e.reqindex]),F(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,M,X[e.reqindex]),r=e.lout+e.totsamp,t=e.loutbuf,p=e.rout+e.totsamp,L=e.routbuf;for(var Z=M%8;Z--!=0;)e.lsum+=ee(t[r++]),e.rsum+=ee(L[p++]);for(Z=M/8;Z--!=0;)e.lsum+=ee(t[r+0])+ee(t[r+1])+ee(t[r+2])+ee(t[r+3])+ee(t[r+4])+ee(t[r+5])+ee(t[r+6])+ee(t[r+7]),r+=8,e.rsum+=ee(L[p+0])+ee(L[p+1])+ee(L[p+2])+ee(L[p+3])+ee(L[p+4])+ee(L[p+5])+ee(L[p+6])+ee(L[p+7]),p+=8;if(v-=M,y+=M,e.totsamp+=M,e.totsamp==e.sampleWindow){var j=nt.STEPS_per_dB*10*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),D=j<=0?0:0|j;D>=e.A.length&&(D=e.A.length-1),e.A[D]++,e.lsum=e.rsum=0,vt.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),vt.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),vt.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),vt.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return B<MAX_ORDER?(vt.arraycopy(e.linprebuf,B,e.linprebuf,0,MAX_ORDER-B),vt.arraycopy(e.rinprebuf,B,e.rinprebuf,0,MAX_ORDER-B),vt.arraycopy(a,_,e.linprebuf,MAX_ORDER-B,B),vt.arraycopy(m,V,e.rinprebuf,MAX_ORDER-B,B)):(vt.arraycopy(a,_+B-MAX_ORDER,e.linprebuf,0,MAX_ORDER),vt.arraycopy(m,V+B-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function g(e,a){var _,m=0;for(_=0;_<a;_++)m+=e[_];if(m==0)return GAIN_NOT_ENOUGH_SAMPLES;var V=0|Math.ceil(m*(1-z));for(_=a;_-- >0&&!((V-=e[_])<=0););return S-_/nt.STEPS_per_dB}this.GetTitleGain=function(e){for(var a=g(e.A,e.A.length),_=0;_<e.A.length;_++)e.B[_]+=e.A[_],e.A[_]=0;for(var _=0;_<MAX_ORDER;_++)e.linprebuf[_]=e.lstepbuf[_]=e.loutbuf[_]=e.rinprebuf[_]=e.rstepbuf[_]=e.routbuf[_]=0;return e.totsamp=0,e.lsum=e.rsum=0,a}}var p1=nt,m1=et,Wt=m1.new_float,En=m1.new_int,gt=p1;function Mr(){this.linprebuf=Wt(gt.MAX_ORDER*2),this.linpre=0,this.lstepbuf=Wt(gt.MAX_SAMPLES_PER_WINDOW+gt.MAX_ORDER),this.lstep=0,this.loutbuf=Wt(gt.MAX_SAMPLES_PER_WINDOW+gt.MAX_ORDER),this.lout=0,this.rinprebuf=Wt(gt.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=Wt(gt.MAX_SAMPLES_PER_WINDOW+gt.MAX_ORDER),this.rstep=0,this.routbuf=Wt(gt.MAX_SAMPLES_PER_WINDOW+gt.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=En(0|gt.STEPS_per_dB*gt.MAX_dB),this.B=En(0|gt.STEPS_per_dB*gt.MAX_dB)}var Tr=Mr;function Br(S){this.bits=S}var h1=Br,rn=et,Pn=rn.new_float,xr=rn.new_int,In=rn.assert,Rr=h1,Vn=dt(),Er=Ea,Pr=Pa;function Ir(S){var z=S;this.quantize=z,this.iteration_loop=function(i,R,O,X){var Y=i.internal_flags,F=Pn(Er.SFBMAX),q=Pn(576),ee=xr(2),g=0,e,a=Y.l3_side,_=new Rr(g);this.quantize.rv.ResvFrameBegin(i,_),g=_.bits;for(var m=0;m<Y.mode_gr;m++){e=this.quantize.qupvt.on_pe(i,R,ee,g,m,m),Y.mode_ext==Vn.MPG_MD_MS_LR&&(this.quantize.ms_convert(Y.l3_side,m),this.quantize.qupvt.reduce_side(ee,O[m],g,e));for(var V=0;V<Y.channels_out;V++){var B,n,r=a.tt[m][V];r.block_type!=Vn.SHORT_TYPE?(B=0,n=Y.PSY.mask_adjust-B):(B=0,n=Y.PSY.mask_adjust_short-B),Y.masking_lower=Math.pow(10,n*.1),this.quantize.init_outer_loop(Y,r),this.quantize.init_xrpow(Y,r,q)&&(this.quantize.qupvt.calc_xmin(i,X[m][V],r,F),this.quantize.outer_loop(i,r,F,q,V,ee[V])),this.quantize.iteration_finish_one(Y,m,V),In(r.part2_3_length<=Pr.MAX_BITS_PER_CHANNEL),In(r.part2_3_length<=ee[V])}}this.quantize.rv.ResvFrameEnd(Y,g)}}var Vr=Ir;function Ye(S,z,i,R){this.xlen=S,this.linmax=z,this.table=i,this.hlen=R}var ce={};ce.t1HB=[1,1,1,0];ce.t2HB=[1,2,1,3,1,1,3,2,0];ce.t3HB=[3,2,1,1,1,1,3,2,0];ce.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];ce.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];ce.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];ce.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];ce.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];ce.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];ce.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];ce.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];ce.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];ce.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];ce.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];ce.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];ce.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];ce.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];ce.t1l=[1,4,3,5];ce.t2l=[1,4,7,4,5,7,6,7,8];ce.t3l=[2,3,7,4,4,7,6,7,8];ce.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];ce.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];ce.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];ce.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];ce.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];ce.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];ce.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];ce.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];ce.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];ce.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];ce.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];ce.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];ce.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];ce.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10];ce.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8];ce.ht=[new Ye(0,0,null,null),new Ye(2,0,ce.t1HB,ce.t1l),new Ye(3,0,ce.t2HB,ce.t2l),new Ye(3,0,ce.t3HB,ce.t3l),new Ye(0,0,null,null),new Ye(4,0,ce.t5HB,ce.t5l),new Ye(4,0,ce.t6HB,ce.t6l),new Ye(6,0,ce.t7HB,ce.t7l),new Ye(6,0,ce.t8HB,ce.t8l),new Ye(6,0,ce.t9HB,ce.t9l),new Ye(8,0,ce.t10HB,ce.t10l),new Ye(8,0,ce.t11HB,ce.t11l),new Ye(8,0,ce.t12HB,ce.t12l),new Ye(16,0,ce.t13HB,ce.t13l),new Ye(0,0,null,ce.t16_5l),new Ye(16,0,ce.t15HB,ce.t15l),new Ye(1,1,ce.t16HB,ce.t16l),new Ye(2,3,ce.t16HB,ce.t16l),new Ye(3,7,ce.t16HB,ce.t16l),new Ye(4,15,ce.t16HB,ce.t16l),new Ye(6,63,ce.t16HB,ce.t16l),new Ye(8,255,ce.t16HB,ce.t16l),new Ye(10,1023,ce.t16HB,ce.t16l),new Ye(13,8191,ce.t16HB,ce.t16l),new Ye(4,15,ce.t24HB,ce.t24l),new Ye(5,31,ce.t24HB,ce.t24l),new Ye(6,63,ce.t24HB,ce.t24l),new Ye(7,127,ce.t24HB,ce.t24l),new Ye(8,255,ce.t24HB,ce.t24l),new Ye(9,511,ce.t24HB,ce.t24l),new Ye(11,2047,ce.t24HB,ce.t24l),new Ye(13,8191,ce.t24HB,ce.t24l),new Ye(0,0,ce.t32HB,ce.t32l),new Ye(0,0,ce.t33HB,ce.t33l)];ce.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];ce.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];ce.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];ce.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];ce.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];ce.scfsi_band=[0,6,11,16,21];var sn=ce,Qa,Dn;function b1(){if(Dn)return Qa;Dn=1;var S=c1,z=et,i=z.VbrMode,R=z.Float,O=z.Util,X=z.new_float,Y=z.new_int,F=z.assert,q=dt(),ee=h1,g=Pa;e.Q_MAX=257,e.Q_MAX2=116,e.LARGE_BITS=1e5,e.IXMAX_VAL=8206;function e(){var a=on(),_=null,m=null,V=null;this.setModules=function(T,W,G){_=T,m=W,V=G};function B(T){return F(0<=T+e.Q_MAX2&&T<e.Q_MAX),y[T+e.Q_MAX2]}this.IPOW20=function(T){return F(0<=T&&T<e.Q_MAX),Z[T]};var n=2220446049250313e-31,r=e.IXMAX_VAL,t=r+2,p=e.Q_MAX,L=e.Q_MAX2;e.LARGE_BITS;var v=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var M=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=M,this.sfBandIndex=[new S([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new S([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var y=X(p+L+1),Z=X(p),j=X(t),D=X(t);this.adj43=D;function h(T,W){var G=V.ATHformula(W,T);return G-=v,G=Math.pow(10,G/10+T.ATHlower),G}function x(T){for(var W=T.internal_flags.ATH.l,G=T.internal_flags.ATH.psfb21,P=T.internal_flags.ATH.s,N=T.internal_flags.ATH.psfb12,A=T.internal_flags,f=T.out_samplerate,l=0;l<q.SBMAX_l;l++){var s=A.scalefac_band.l[l],u=A.scalefac_band.l[l+1];W[l]=R.MAX_VALUE;for(var w=s;w<u;w++){var J=w*f/1152,ne=h(T,J);W[l]=Math.min(W[l],ne)}}for(var l=0;l<q.PSFB21;l++){var s=A.scalefac_band.psfb21[l],u=A.scalefac_band.psfb21[l+1];G[l]=R.MAX_VALUE;for(var w=s;w<u;w++){var J=w*f/1152,ne=h(T,J);G[l]=Math.min(G[l],ne)}}for(var l=0;l<q.SBMAX_s;l++){var s=A.scalefac_band.s[l],u=A.scalefac_band.s[l+1];P[l]=R.MAX_VALUE;for(var w=s;w<u;w++){var J=w*f/384,ne=h(T,J);P[l]=Math.min(P[l],ne)}P[l]*=A.scalefac_band.s[l+1]-A.scalefac_band.s[l]}for(var l=0;l<q.PSFB12;l++){var s=A.scalefac_band.psfb12[l],u=A.scalefac_band.psfb12[l+1];N[l]=R.MAX_VALUE;for(var w=s;w<u;w++){var J=w*f/384,ne=h(T,J);N[l]=Math.min(N[l],ne)}N[l]*=A.scalefac_band.s[13]-A.scalefac_band.s[12]}if(T.noATH){for(var l=0;l<q.SBMAX_l;l++)W[l]=1e-20;for(var l=0;l<q.PSFB21;l++)G[l]=1e-20;for(var l=0;l<q.SBMAX_s;l++)P[l]=1e-20;for(var l=0;l<q.PSFB12;l++)N[l]=1e-20}A.ATH.floor=10*Math.log10(h(T,-1))}this.iteration_init=function(T){var W=T.internal_flags,G=W.l3_side,P;if(W.iteration_init_init==0){for(W.iteration_init_init=1,G.main_data_begin=0,x(T),j[0]=0,P=1;P<t;P++)j[P]=Math.pow(P,4/3);for(P=0;P<t-1;P++)D[P]=P+1-Math.pow(.5*(j[P]+j[P+1]),.75);for(D[P]=.5,P=0;P<p;P++)Z[P]=Math.pow(2,(P-210)*-.1875);for(P=0;P<=p+L;P++)y[P]=Math.pow(2,(P-210-L)*.25);_.huffman_init(W);{var N,A,f,l;for(P=T.exp_nspsytune>>2&63,P>=32&&(P-=64),N=Math.pow(10,P/4/10),P=T.exp_nspsytune>>8&63,P>=32&&(P-=64),A=Math.pow(10,P/4/10),P=T.exp_nspsytune>>14&63,P>=32&&(P-=64),f=Math.pow(10,P/4/10),P=T.exp_nspsytune>>20&63,P>=32&&(P-=64),l=f*Math.pow(10,P/4/10),P=0;P<q.SBMAX_l;P++){var s;P<=6?s=N:P<=13?s=A:P<=20?s=f:s=l,W.nsPsy.longfact[P]=s}for(P=0;P<q.SBMAX_s;P++){var s;P<=5?s=N:P<=10?s=A:P<=11?s=f:s=l,W.nsPsy.shortfact[P]=s}}}},this.on_pe=function(T,W,G,P,N,A){var f=T.internal_flags,l=0,s,u=Y(2),w,J=new ee(l),ne=m.ResvMaxBits(T,P,J,A);l=J.bits;var H=l+ne;for(H>g.MAX_BITS_PER_GRANULE&&(H=g.MAX_BITS_PER_GRANULE),s=0,w=0;w<f.channels_out;++w)G[w]=Math.min(g.MAX_BITS_PER_CHANNEL,l/f.channels_out),u[w]=0|G[w]*W[N][w]/700-G[w],u[w]>P*3/4&&(u[w]=P*3/4),u[w]<0&&(u[w]=0),u[w]+G[w]>g.MAX_BITS_PER_CHANNEL&&(u[w]=Math.max(0,g.MAX_BITS_PER_CHANNEL-G[w])),s+=u[w];if(s>ne)for(w=0;w<f.channels_out;++w)u[w]=ne*u[w]/s;for(w=0;w<f.channels_out;++w)G[w]+=u[w],ne-=u[w];for(s=0,w=0;w<f.channels_out;++w)s+=G[w];if(s>g.MAX_BITS_PER_GRANULE){var U=0;for(w=0;w<f.channels_out;++w)G[w]*=g.MAX_BITS_PER_GRANULE,G[w]/=s,U+=G[w]}return H},this.reduce_side=function(T,W,G,P){F(T[0]+T[1]<=g.MAX_BITS_PER_GRANULE);var N=.33*(.5-W)/.5;N<0&&(N=0),N>.5&&(N=.5);var A=0|N*.5*(T[0]+T[1]);A>g.MAX_BITS_PER_CHANNEL-T[0]&&(A=g.MAX_BITS_PER_CHANNEL-T[0]),A<0&&(A=0),T[1]>=125&&(T[1]-A>125?(T[0]<G&&(T[0]+=A),T[1]-=A):(T[0]+=T[1]-125,T[1]=125)),A=T[0]+T[1],A>P&&(T[0]=P*T[0]/A,T[1]=P*T[1]/A),F(T[0]<=g.MAX_BITS_PER_CHANNEL),F(T[1]<=g.MAX_BITS_PER_CHANNEL),F(T[0]+T[1]<=g.MAX_BITS_PER_GRANULE)},this.athAdjust=function(T,W,G){var P=90.30873362,N=94.82444863,A=O.FAST_LOG10_X(W,10),f=T*T,l=0;return A-=G,f>1e-20&&(l=1+O.FAST_LOG10_X(f,10/P)),l<0&&(l=0),A*=l,A+=G+P-N,Math.pow(10,.1*A)},this.calc_xmin=function(T,W,G,P){var N=0,A=T.internal_flags,f,l=0,s=0,u=A.ATH,w=G.xr,J=T.VBR==i.vbr_mtrh?1:0,ne=A.masking_lower;for((T.VBR==i.vbr_mtrh||T.VBR==i.vbr_mt)&&(ne=1),f=0;f<G.psy_lmax;f++){var H,U,le,de,ve,Ae;T.VBR==i.vbr_rh||T.VBR==i.vbr_mtrh?U=athAdjust(u.adjust,u.l[f],u.floor):U=u.adjust*u.l[f],ve=G.width[f],le=U/ve,de=n,Ae=ve>>1,H=0;do{var ge,we;ge=w[l]*w[l],H+=ge,de+=ge<le?ge:le,l++,we=w[l]*w[l],H+=we,de+=we<le?we:le,l++}while(--Ae>0);if(H>U&&s++,f==q.SBPSY_l){var Be=U*A.nsPsy.longfact[f];de<Be&&(de=Be)}if(J!=0&&(U=de),!T.ATHonly){var Qe=W.en.l[f];if(Qe>0){var Be;Be=H*W.thm.l[f]*ne/Qe,J!=0&&(Be*=A.nsPsy.longfact[f]),U<Be&&(U=Be)}}J!=0?P[N++]=U:P[N++]=U*A.nsPsy.longfact[f]}var kt=575;if(G.block_type!=q.SHORT_TYPE)for(var o=576;o--!=0&&a.EQ(w[o],0);)kt=o;G.max_nonzero_coeff=kt;for(var c=G.sfb_smin;f<G.psymax;c++,f+=3){var ve,be,Se;for(T.VBR==i.vbr_rh||T.VBR==i.vbr_mtrh?Se=athAdjust(u.adjust,u.s[c],u.floor):Se=u.adjust*u.s[c],ve=G.width[f],be=0;be<3;be++){var H=0,U,le,de,Ae=ve>>1;le=Se/ve,de=n;do{var ge,we;ge=w[l]*w[l],H+=ge,de+=ge<le?ge:le,l++,we=w[l]*w[l],H+=we,de+=we<le?we:le,l++}while(--Ae>0);if(H>Se&&s++,c==q.SBPSY_s){var Be=Se*A.nsPsy.shortfact[c];de<Be&&(de=Be)}if(J!=0?U=de:U=Se,!T.ATHonly&&!T.ATHshort){var Qe=W.en.s[c][be];if(Qe>0){var Be;Be=H*W.thm.s[c][be]*ne/Qe,J!=0&&(Be*=A.nsPsy.shortfact[c]),U<Be&&(U=Be)}}J!=0?P[N++]=U:P[N++]=U*A.nsPsy.shortfact[c]}T.useTemporal&&(P[N-3]>P[N-3+1]&&(P[N-3+1]+=(P[N-3]-P[N-3+1])*A.decay),P[N-3+1]>P[N-3+2]&&(P[N-3+2]+=(P[N-3+1]-P[N-3+2])*A.decay))}return s};function k(T){this.s=T}this.calc_noise_core=function(T,W,G,P){var N=0,A=W.s,f=T.l3_enc;if(A>T.count1)for(;G--!=0;){var l;l=T.xr[A],A++,N+=l*l,l=T.xr[A],A++,N+=l*l}else if(A>T.big_values){var s=X(2);for(s[0]=0,s[1]=P;G--!=0;){var l;l=Math.abs(T.xr[A])-s[f[A]],A++,N+=l*l,l=Math.abs(T.xr[A])-s[f[A]],A++,N+=l*l}}else for(;G--!=0;){var l;l=Math.abs(T.xr[A])-j[f[A]]*P,A++,N+=l*l,l=Math.abs(T.xr[A])-j[f[A]]*P,A++,N+=l*l}return W.s=A,N},this.calc_noise=function(T,W,G,P,N){var A=0,f=0,l,s,u=0,w=0,J=0,ne=-20,H=0,U=T.scalefac,le=0;for(P.over_SSD=0,l=0;l<T.psymax;l++){var de=T.global_gain-(U[le++]+(T.preflag!=0?M[l]:0)<<T.scalefac_scale+1)-T.subblock_gain[T.window[l]]*8,ve=0;if(N!=null&&N.step[l]==de)ve=N.noise[l],H+=T.width[l],G[A++]=ve/W[f++],ve=N.noise_log[l];else{var Ae=B(de);if(s=T.width[l]>>1,H+T.width[l]>T.max_nonzero_coeff){var ge;ge=T.max_nonzero_coeff-H+1,ge>0?s=ge>>1:s=0}var we=new k(H);ve=this.calc_noise_core(T,we,s,Ae),H=we.s,N!=null&&(N.step[l]=de,N.noise[l]=ve),ve=G[A++]=ve/W[f++],ve=O.FAST_LOG10(Math.max(ve,1e-20)),N!=null&&(N.noise_log[l]=ve)}if(N!=null&&(N.global_gain=T.global_gain),J+=ve,ve>0){var Be;Be=Math.max(0|ve*10+.5,1),P.over_SSD+=Be*Be,u++,w+=ve}ne=Math.max(ne,ve)}return P.over_count=u,P.tot_noise=J,P.over_noise=w,P.max_noise=ne,u},this.set_pinfo=function(T,W,G,P,N){var A=T.internal_flags,f,l,s,u,w,J=W.scalefac_scale==0?.5:1,ne=W.scalefac,H=X(L3Side.SFBMAX),U=X(L3Side.SFBMAX),le=new CalcNoiseResult;calc_xmin(T,G,W,H),calc_noise(W,H,U,le,null);var de=0;for(l=W.sfb_lmax,W.block_type!=q.SHORT_TYPE&&W.mixed_block_flag==0&&(l=22),f=0;f<l;f++){var ve=A.scalefac_band.l[f],Ae=A.scalefac_band.l[f+1],ge=Ae-ve;for(u=0;de<Ae;de++)u+=W.xr[de]*W.xr[de];u/=ge,w=1e15,A.pinfo.en[P][N][f]=w*u,A.pinfo.xfsf[P][N][f]=w*H[f]*U[f]/ge,G.en.l[f]>0&&!T.ATHonly?u=u/G.en.l[f]:u=0,A.pinfo.thr[P][N][f]=w*Math.max(u*G.thm.l[f],A.ATH.l[f]),A.pinfo.LAMEsfb[P][N][f]=0,W.preflag!=0&&f>=11&&(A.pinfo.LAMEsfb[P][N][f]=-J*M[f]),f<q.SBPSY_l&&(F(ne[f]>=0),A.pinfo.LAMEsfb[P][N][f]-=J*ne[f])}if(W.block_type==q.SHORT_TYPE)for(l=f,f=W.sfb_smin;f<q.SBMAX_s;f++)for(var ve=A.scalefac_band.s[f],Ae=A.scalefac_band.s[f+1],ge=Ae-ve,we=0;we<3;we++){for(u=0,s=ve;s<Ae;s++)u+=W.xr[de]*W.xr[de],de++;u=Math.max(u/ge,1e-20),w=1e15,A.pinfo.en_s[P][N][3*f+we]=w*u,A.pinfo.xfsf_s[P][N][3*f+we]=w*H[l]*U[l]/ge,G.en.s[f][we]>0?u=u/G.en.s[f][we]:u=0,(T.ATHonly||T.ATHshort)&&(u=0),A.pinfo.thr_s[P][N][3*f+we]=w*Math.max(u*G.thm.s[f][we],A.ATH.s[f]),A.pinfo.LAMEsfb_s[P][N][3*f+we]=-2*W.subblock_gain[we],f<q.SBPSY_s&&(A.pinfo.LAMEsfb_s[P][N][3*f+we]-=J*ne[l]),l++}A.pinfo.LAMEqss[P][N]=W.global_gain,A.pinfo.LAMEmainbits[P][N]=W.part2_3_length+W.part2_length,A.pinfo.LAMEsfbits[P][N]=W.part2_length,A.pinfo.over[P][N]=le.over_count,A.pinfo.max_noise[P][N]=le.max_noise*10,A.pinfo.over_noise[P][N]=le.over_noise*10,A.pinfo.tot_noise[P][N]=le.tot_noise*10,A.pinfo.over_SSD[P][N]=le.over_SSD}}return Qa=e,Qa}var $a,Ln;function v1(){if(Ln)return $a;Ln=1;var S=et,z=S.System,i=S.Arrays,R=S.new_int,O=S.assert,X=dt(),Y=sn,F=an,q=b1();function ee(){var g=null;this.qupvt=null,this.setModules=function(A){this.qupvt=A,g=A};function e(A){this.bits=0|A}var a=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function _(A,f,l,s,u,w){var J=.5946/f;for(A=A>>1;A--!=0;)u[w++]=J>l[s++]?0:1,u[w++]=J>l[s++]?0:1}function m(A,f,l,s,u,w){A=A>>1;var J=A%2;for(A=A>>1;A--!=0;){var ne,H,U,le,de,ve,Ae,ge;ne=l[s++]*f,H=l[s++]*f,de=0|ne,U=l[s++]*f,ve=0|H,le=l[s++]*f,Ae=0|U,ne+=g.adj43[de],ge=0|le,H+=g.adj43[ve],u[w++]=0|ne,U+=g.adj43[Ae],u[w++]=0|H,le+=g.adj43[ge],u[w++]=0|U,u[w++]=0|le}if(J!=0){var ne,H,de,ve;ne=l[s++]*f,H=l[s++]*f,de=0|ne,ve=0|H,ne+=g.adj43[de],H+=g.adj43[ve],u[w++]=0|ne,u[w++]=0|H}}function V(A,f,l,s,u){var w,J,ne=0,H,U=0,le=0,de=0,ve=f,Ae=0,ge=ve,we=0,Be=A,Qe=0;for(H=u!=null&&s.global_gain==u.global_gain,s.block_type==X.SHORT_TYPE?J=38:J=21,w=0;w<=J;w++){var kt=-1;if((H||s.block_type==X.NORM_TYPE)&&(kt=s.global_gain-(s.scalefac[w]+(s.preflag!=0?g.pretab[w]:0)<<s.scalefac_scale+1)-s.subblock_gain[s.window[w]]*8),O(s.width[w]>=0),H&&u.step[w]==kt)U!=0&&(m(U,l,Be,Qe,ge,we),U=0),le!=0&&(_(le,l,Be,Qe,ge,we),le=0);else{var o=s.width[w];if(ne+s.width[w]>s.max_nonzero_coeff){var c;c=s.max_nonzero_coeff-ne+1,i.fill(f,s.max_nonzero_coeff,576,0),o=c,o<0&&(o=0),w=J+1}if(U==0&&le==0&&(ge=ve,we=Ae,Be=A,Qe=de),u!=null&&u.sfb_count1>0&&w>=u.sfb_count1&&u.step[w]>0&&kt>=u.step[w]?(U!=0&&(m(U,l,Be,Qe,ge,we),U=0,ge=ve,we=Ae,Be=A,Qe=de),le+=o):(le!=0&&(_(le,l,Be,Qe,ge,we),le=0,ge=ve,we=Ae,Be=A,Qe=de),U+=o),o<=0){le!=0&&(_(le,l,Be,Qe,ge,we),le=0),U!=0&&(m(U,l,Be,Qe,ge,we),U=0);break}}w<=J&&(Ae+=s.width[w],de+=s.width[w],ne+=s.width[w])}U!=0&&(m(U,l,Be,Qe,ge,we),U=0),le!=0&&(_(le,l,Be,Qe,ge,we),le=0)}function B(A,f,l){var s=0,u=0;do{var w=A[f++],J=A[f++];s<w&&(s=w),u<J&&(u=J)}while(f<l);return s<u&&(s=u),s}function n(A,f,l,s,u,w){var J=Y.ht[s].xlen*65536+Y.ht[u].xlen,ne=0,H;do{var U=A[f++],le=A[f++];U!=0&&(U>14&&(U=15,ne+=J),U*=16),le!=0&&(le>14&&(le=15,ne+=J),U+=le),ne+=Y.largetbl[U]}while(f<l);return H=ne&65535,ne>>=16,ne>H&&(ne=H,s=u),w.bits+=ne,s}function r(A,f,l,s){var u=0,w=Y.ht[1].hlen;do{var J=A[f+0]*2+A[f+1];f+=2,u+=w[J]}while(f<l);return s.bits+=u,1}function t(A,f,l,s,u){var w=0,J,ne=Y.ht[s].xlen,H;s==2?H=Y.table23:H=Y.table56;do{var U=A[f+0]*ne+A[f+1];f+=2,w+=H[U]}while(f<l);return J=w&65535,w>>=16,w>J&&(w=J,s++),u.bits+=w,s}function p(A,f,l,s,u){var w=0,J=0,ne=0,H=Y.ht[s].xlen,U=Y.ht[s].hlen,le=Y.ht[s+1].hlen,de=Y.ht[s+2].hlen;do{var ve=A[f+0]*H+A[f+1];f+=2,w+=U[ve],J+=le[ve],ne+=de[ve]}while(f<l);var Ae=s;return w>J&&(w=J,Ae++),w>ne&&(w=ne,Ae=s+2),u.bits+=w,Ae}var L=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function v(A,f,l,s){var u=B(A,f,l);switch(u){case 0:return u;case 1:return r(A,f,l,s);case 2:case 3:return t(A,f,l,L[u-1],s);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return p(A,f,l,L[u-1],s);default:if(u>q.IXMAX_VAL)return s.bits=q.LARGE_BITS,-1;u-=15;var w;for(w=24;w<32&&!(Y.ht[w].linmax>=u);w++);var J;for(J=w-8;J<24&&!(Y.ht[J].linmax>=u);J++);return n(A,f,l,J,w,s)}}this.noquant_count_bits=function(A,f,l){var s=f.l3_enc,u=Math.min(576,f.max_nonzero_coeff+2>>1<<1);for(l!=null&&(l.sfb_count1=0);u>1&&!(s[u-1]|s[u-2]);u-=2);f.count1=u;for(var w=0,J=0;u>3;u-=4){var ne;if(((s[u-1]|s[u-2]|s[u-3]|s[u-4])&2147483647)>1)break;ne=((s[u-4]*2+s[u-3])*2+s[u-2])*2+s[u-1],w+=Y.t32l[ne],J+=Y.t33l[ne]}var H=w;if(f.count1table_select=0,w>J&&(H=J,f.count1table_select=1),f.count1bits=H,f.big_values=u,u==0)return H;if(f.block_type==X.SHORT_TYPE)w=3*A.scalefac_band.s[3],w>f.big_values&&(w=f.big_values),J=f.big_values;else if(f.block_type==X.NORM_TYPE){if(w=f.region0_count=A.bv_scf[u-2],J=f.region1_count=A.bv_scf[u-1],O(w+J+2<X.SBPSY_l),J=A.scalefac_band.l[w+J+2],w=A.scalefac_band.l[w+1],J<u){var U=new e(H);f.table_select[2]=v(s,J,u,U),H=U.bits}}else f.region0_count=7,f.region1_count=X.SBMAX_l-1-7-1,w=A.scalefac_band.l[8],J=u,w>J&&(w=J);if(w=Math.min(w,u),J=Math.min(J,u),0<w){var U=new e(H);f.table_select[0]=v(s,0,w,U),H=U.bits}if(w<J){var U=new e(H);f.table_select[1]=v(s,w,J,U),H=U.bits}if(A.use_best_huffman==2&&(f.part2_3_length=H,best_huffman_divide(A,f),H=f.part2_3_length),l!=null&&f.block_type==X.NORM_TYPE){for(var le=0;A.scalefac_band.l[le]<f.big_values;)le++;l.sfb_count1=le}return H},this.count_bits=function(A,f,l,s){var u=l.l3_enc,w=q.IXMAX_VAL/g.IPOW20(l.global_gain);if(l.xrpow_max>w)return q.LARGE_BITS;if(V(f,u,g.IPOW20(l.global_gain),l,s),A.substep_shaping&2)for(var J=0,ne=l.global_gain+l.scalefac_scale,H=.634521682242439/g.IPOW20(ne),U=0;U<l.sfbmax;U++){var le=l.width[U];if(A.pseudohalf[U]==0)J+=le;else{var de;for(de=J,J+=le;de<J;++de)u[de]=f[de]>=H?u[de]:0}}return this.noquant_count_bits(A,l,s)};function M(A,f,l,s,u,w,J){for(var ne=f.big_values,H=0;H<=22;H++)s[H]=q.LARGE_BITS;for(var H=0;H<16;H++){var U=A.scalefac_band.l[H+1];if(U>=ne)break;var le=0,de=new e(le),ve=v(l,0,U,de);le=de.bits;for(var Ae=0;Ae<8;Ae++){var ge=A.scalefac_band.l[H+Ae+2];if(ge>=ne)break;var we=le;de=new e(we);var Be=v(l,U,ge,de);we=de.bits,s[H+Ae]>we&&(s[H+Ae]=we,u[H+Ae]=H,w[H+Ae]=ve,J[H+Ae]=Be)}}}function y(A,f,l,s,u,w,J,ne){for(var H=f.big_values,U=2;U<X.SBMAX_l+1;U++){var le=A.scalefac_band.l[U];if(le>=H)break;var de=u[U-2]+f.count1bits;if(l.part2_3_length<=de)break;var ve=new e(de),Ae=v(s,le,H,ve);de=ve.bits,!(l.part2_3_length<=de)&&(l.assign(f),l.part2_3_length=de,l.region0_count=w[U-2],l.region1_count=U-2-w[U-2],l.table_select[0]=J[U-2],l.table_select[1]=ne[U-2],l.table_select[2]=Ae)}}this.best_huffman_divide=function(A,f){var l=new F,s=f.l3_enc,u=R(23),w=R(23),J=R(23),ne=R(23);if(!(f.block_type==X.SHORT_TYPE&&A.mode_gr==1)){l.assign(f),f.block_type==X.NORM_TYPE&&(M(A,f,s,u,w,J,ne),y(A,l,f,s,u,w,J,ne));var H=l.big_values;if(!(H==0||(s[H-2]|s[H-1])>1)&&(H=f.count1+2,!(H>576))){l.assign(f),l.count1=H;for(var U=0,le=0;H>l.big_values;H-=4){var de=((s[H-4]*2+s[H-3])*2+s[H-2])*2+s[H-1];U+=Y.t32l[de],le+=Y.t33l[de]}if(l.big_values=H,l.count1table_select=0,U>le&&(U=le,l.count1table_select=1),l.count1bits=U,l.block_type==X.NORM_TYPE)y(A,l,f,s,u,w,J,ne);else{if(l.part2_3_length=U,U=A.scalefac_band.l[8],U>H&&(U=H),U>0){var ve=new e(l.part2_3_length);l.table_select[0]=v(s,0,U,ve),l.part2_3_length=ve.bits}if(H>U){var ve=new e(l.part2_3_length);l.table_select[1]=v(s,U,H,ve),l.part2_3_length=ve.bits}f.part2_3_length>l.part2_3_length&&f.assign(l)}}}};var Z=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],j=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],D=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],h=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];ee.slen1_tab=D,ee.slen2_tab=h;function x(A,f){for(var l,s=f.tt[1][A],u=f.tt[0][A],w=0;w<Y.scfsi_band.length-1;w++){for(l=Y.scfsi_band[w];l<Y.scfsi_band[w+1]&&!(u.scalefac[l]!=s.scalefac[l]&&s.scalefac[l]>=0);l++);if(l==Y.scfsi_band[w+1]){for(l=Y.scfsi_band[w];l<Y.scfsi_band[w+1];l++)s.scalefac[l]=-1;f.scfsi[A][w]=1}}var J=0,ne=0;for(l=0;l<11;l++)s.scalefac[l]!=-1&&(ne++,J<s.scalefac[l]&&(J=s.scalefac[l]));for(var H=0,U=0;l<X.SBPSY_l;l++)s.scalefac[l]!=-1&&(U++,H<s.scalefac[l]&&(H=s.scalefac[l]));for(var w=0;w<16;w++)if(J<Z[w]&&H<j[w]){var le=D[w]*ne+h[w]*U;s.part2_length>le&&(s.part2_length=le,s.scalefac_compress=w)}}this.best_scalefac_store=function(A,f,l,s){var u=s.tt[f][l],w,J,ne,H,U=0;for(ne=0,w=0;w<u.sfbmax;w++){var le=u.width[w];for(ne+=le,H=-le;H<0&&u.l3_enc[H+ne]==0;H++);H==0&&(u.scalefac[w]=U=-2)}if(u.scalefac_scale==0&&u.preflag==0){var de=0;for(w=0;w<u.sfbmax;w++)u.scalefac[w]>0&&(de|=u.scalefac[w]);if(!(de&1)&&de!=0){for(w=0;w<u.sfbmax;w++)u.scalefac[w]>0&&(u.scalefac[w]>>=1);u.scalefac_scale=U=1}}if(u.preflag==0&&u.block_type!=X.SHORT_TYPE&&A.mode_gr==2){for(w=11;w<X.SBPSY_l&&!(u.scalefac[w]<g.pretab[w]&&u.scalefac[w]!=-2);w++);if(w==X.SBPSY_l){for(w=11;w<X.SBPSY_l;w++)u.scalefac[w]>0&&(u.scalefac[w]-=g.pretab[w]);u.preflag=U=1}}for(J=0;J<4;J++)s.scfsi[l][J]=0;for(A.mode_gr==2&&f==1&&s.tt[0][l].block_type!=X.SHORT_TYPE&&s.tt[1][l].block_type!=X.SHORT_TYPE&&(x(l,s),U=0),w=0;w<u.sfbmax;w++)u.scalefac[w]==-2&&(u.scalefac[w]=0);U!=0&&(A.mode_gr==2?this.scale_bitcount(u):this.scale_bitcount_lsf(A,u))};function k(A,f){for(var l=0;l<f;++l)if(A[l]<0)return!1;return!0}var T=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],W=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],G=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(A){var f,l,s=0,u=0,w,J=A.scalefac;if(O(k(J,A.sfbmax)),A.block_type==X.SHORT_TYPE)w=T,A.mixed_block_flag!=0&&(w=W);else if(w=G,A.preflag==0){for(l=11;l<X.SBPSY_l&&!(J[l]<g.pretab[l]);l++);if(l==X.SBPSY_l)for(A.preflag=1,l=11;l<X.SBPSY_l;l++)J[l]-=g.pretab[l]}for(l=0;l<A.sfbdivide;l++)s<J[l]&&(s=J[l]);for(;l<A.sfbmax;l++)u<J[l]&&(u=J[l]);for(A.part2_length=q.LARGE_BITS,f=0;f<16;f++)s<Z[f]&&u<j[f]&&A.part2_length>w[f]&&(A.part2_length=w[f],A.scalefac_compress=f);return A.part2_length==q.LARGE_BITS};var P=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(A,f){var l,s,u,w,J,ne,H,U,le=R(4),de=f.scalefac;for(f.preflag!=0?l=2:l=0,H=0;H<4;H++)le[H]=0;if(f.block_type==X.SHORT_TYPE){s=1;var ve=g.nr_of_sfb_block[l][s];for(U=0,u=0;u<4;u++)for(w=ve[u]/3,H=0;H<w;H++,U++)for(J=0;J<3;J++)de[U*3+J]>le[u]&&(le[u]=de[U*3+J])}else{s=0;var ve=g.nr_of_sfb_block[l][s];for(U=0,u=0;u<4;u++)for(w=ve[u],H=0;H<w;H++,U++)de[U]>le[u]&&(le[u]=de[U])}for(ne=!1,u=0;u<4;u++)le[u]>P[l][u]&&(ne=!0);if(!ne){var Ae,ge,we,Be;for(f.sfb_partition_table=g.nr_of_sfb_block[l][s],u=0;u<4;u++)f.slen[u]=N[le[u]];switch(Ae=f.slen[0],ge=f.slen[1],we=f.slen[2],Be=f.slen[3],l){case 0:f.scalefac_compress=(Ae*5+ge<<4)+(we<<2)+Be;break;case 1:f.scalefac_compress=400+(Ae*5+ge<<2)+we;break;case 2:f.scalefac_compress=500+Ae*3+ge;break;default:z.err.printf(`intensity stereo not implemented yet
`);break}}if(!ne)for(O(f.sfb_partition_table!=null),f.part2_length=0,u=0;u<4;u++)f.part2_length+=f.slen[u]*f.sfb_partition_table[u];return ne};var N=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(A){for(var f=2;f<=576;f+=2){for(var l=0,s;A.scalefac_band.l[++l]<f;);for(s=a[l][0];A.scalefac_band.l[s+1]>f;)s--;for(s<0&&(s=a[l][0]),A.bv_scf[f-2]=s,s=a[l][1];A.scalefac_band.l[s+A.bv_scf[f-2]+2]>f;)s--;s<0&&(s=a[l][1]),A.bv_scf[f-1]=s}}}return $a=ee,$a}var za,On;function on(){if(On)return za;On=1;var S=et,z=S.System,i=S.Arrays,R=S.new_byte,O=S.new_float_n,X=S.new_int,Y=S.assert,F=v1(),q=sn,ee=dt(),g=Pa;e.EQ=function(a,_){return Math.abs(a)>Math.abs(_)?Math.abs(a-_)<=Math.abs(a)*1e-6:Math.abs(a-_)<=Math.abs(_)*1e-6},e.NEQ=function(a,_){return!e.EQ(a,_)};function e(){var a=ln(),_=this,m=32773,V=null,B=null,n=null,r=null;this.setModules=function(f,l,s,u){V=f,B=l,n=s,r=u};var t=null,p=0,L=0,v=0;this.getframebits=function(f){var l=f.internal_flags,s;l.bitrate_index!=0?s=q.bitrate_table[f.version][l.bitrate_index]:s=f.brate;var u=0|(f.version+1)*72e3*s/f.out_samplerate+l.padding;return 8*u};function M(f){z.arraycopy(f.header[f.w_ptr].buf,0,t,L,f.sideinfo_len),L+=f.sideinfo_len,p+=f.sideinfo_len*8,f.w_ptr=f.w_ptr+1&g.MAX_HEADER_BUF-1}function y(f,l,s){for(;s>0;){var u;v==0&&(v=8,L++,Y(L<a.LAME_MAXMP3BUFFER),Y(f.header[f.w_ptr].write_timing>=p),f.header[f.w_ptr].write_timing==p&&M(f),t[L]=0),u=Math.min(s,v),s-=u,v-=u,t[L]|=l>>s<<v,p+=u}}function Z(f,l,s){for(;s>0;){var u;v==0&&(v=8,L++,Y(L<a.LAME_MAXMP3BUFFER),t[L]=0),u=Math.min(s,v),s-=u,v-=u,t[L]|=l>>s<<v,p+=u}}function j(f,l){var s=f.internal_flags,u;if(l>=8&&(y(s,76,8),l-=8),l>=8&&(y(s,65,8),l-=8),l>=8&&(y(s,77,8),l-=8),l>=8&&(y(s,69,8),l-=8),l>=32){var w=n.getLameShortVersion();if(l>=32)for(u=0;u<w.length&&l>=8;++u)l-=8,y(s,w.charAt(u),8)}for(;l>=1;l-=1)y(s,s.ancillary_flag,1),s.ancillary_flag^=f.disable_reservoir?0:1}function D(f,l,s){for(var u=f.header[f.h_ptr].ptr;s>0;){var w=Math.min(s,8-(u&7));s-=w,f.header[f.h_ptr].buf[u>>3]|=l>>s<<8-(u&7)-w,u+=w}f.header[f.h_ptr].ptr=u}function h(f,l){f<<=8;for(var s=0;s<8;s++)f<<=1,l<<=1,(l^f)&65536&&(l^=m);return l}this.CRC_writeheader=function(f,l){var s=65535;s=h(l[2]&255,s),s=h(l[3]&255,s);for(var u=6;u<f.sideinfo_len;u++)s=h(l[u]&255,s);l[4]=byte(s>>8),l[5]=byte(s&255)};function x(f,l){var s=f.internal_flags,u,w,J;if(u=s.l3_side,s.header[s.h_ptr].ptr=0,i.fill(s.header[s.h_ptr].buf,0,s.sideinfo_len,0),f.out_samplerate<16e3?D(s,4094,12):D(s,4095,12),D(s,f.version,1),D(s,1,2),D(s,f.error_protection?0:1,1),D(s,s.bitrate_index,4),D(s,s.samplerate_index,2),D(s,s.padding,1),D(s,f.extension,1),D(s,f.mode.ordinal(),2),D(s,s.mode_ext,2),D(s,f.copyright,1),D(s,f.original,1),D(s,f.emphasis,2),f.error_protection&&D(s,0,16),f.version==1){for(Y(u.main_data_begin>=0),D(s,u.main_data_begin,9),s.channels_out==2?D(s,u.private_bits,3):D(s,u.private_bits,5),J=0;J<s.channels_out;J++){var ne;for(ne=0;ne<4;ne++)D(s,u.scfsi[J][ne],1)}for(w=0;w<2;w++)for(J=0;J<s.channels_out;J++){var H=u.tt[w][J];D(s,H.part2_3_length+H.part2_length,12),D(s,H.big_values/2,9),D(s,H.global_gain,8),D(s,H.scalefac_compress,4),H.block_type!=ee.NORM_TYPE?(D(s,1,1),D(s,H.block_type,2),D(s,H.mixed_block_flag,1),H.table_select[0]==14&&(H.table_select[0]=16),D(s,H.table_select[0],5),H.table_select[1]==14&&(H.table_select[1]=16),D(s,H.table_select[1],5),D(s,H.subblock_gain[0],3),D(s,H.subblock_gain[1],3),D(s,H.subblock_gain[2],3)):(D(s,0,1),H.table_select[0]==14&&(H.table_select[0]=16),D(s,H.table_select[0],5),H.table_select[1]==14&&(H.table_select[1]=16),D(s,H.table_select[1],5),H.table_select[2]==14&&(H.table_select[2]=16),D(s,H.table_select[2],5),Y(0<=H.region0_count&&H.region0_count<16),Y(0<=H.region1_count&&H.region1_count<8),D(s,H.region0_count,4),D(s,H.region1_count,3)),D(s,H.preflag,1),D(s,H.scalefac_scale,1),D(s,H.count1table_select,1)}}else for(Y(u.main_data_begin>=0),D(s,u.main_data_begin,8),D(s,u.private_bits,s.channels_out),w=0,J=0;J<s.channels_out;J++){var H=u.tt[w][J];D(s,H.part2_3_length+H.part2_length,12),D(s,H.big_values/2,9),D(s,H.global_gain,8),D(s,H.scalefac_compress,9),H.block_type!=ee.NORM_TYPE?(D(s,1,1),D(s,H.block_type,2),D(s,H.mixed_block_flag,1),H.table_select[0]==14&&(H.table_select[0]=16),D(s,H.table_select[0],5),H.table_select[1]==14&&(H.table_select[1]=16),D(s,H.table_select[1],5),D(s,H.subblock_gain[0],3),D(s,H.subblock_gain[1],3),D(s,H.subblock_gain[2],3)):(D(s,0,1),H.table_select[0]==14&&(H.table_select[0]=16),D(s,H.table_select[0],5),H.table_select[1]==14&&(H.table_select[1]=16),D(s,H.table_select[1],5),H.table_select[2]==14&&(H.table_select[2]=16),D(s,H.table_select[2],5),Y(0<=H.region0_count&&H.region0_count<16),Y(0<=H.region1_count&&H.region1_count<8),D(s,H.region0_count,4),D(s,H.region1_count,3)),D(s,H.scalefac_scale,1),D(s,H.count1table_select,1)}f.error_protection&&CRC_writeheader(s,s.header[s.h_ptr].buf);{var U=s.h_ptr;Y(s.header[U].ptr==s.sideinfo_len*8),s.h_ptr=U+1&g.MAX_HEADER_BUF-1,s.header[s.h_ptr].write_timing=s.header[U].write_timing+l,s.h_ptr==s.w_ptr&&z.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function k(f,l){var s=q.ht[l.count1table_select+32],u,w=0,J=l.big_values,ne=l.big_values;for(Y(l.count1table_select<2),u=(l.count1-l.big_values)/4;u>0;--u){var H=0,U=0,le;le=l.l3_enc[J+0],le!=0&&(U+=8,l.xr[ne+0]<0&&H++),le=l.l3_enc[J+1],le!=0&&(U+=4,H*=2,l.xr[ne+1]<0&&H++),le=l.l3_enc[J+2],le!=0&&(U+=2,H*=2,l.xr[ne+2]<0&&H++),le=l.l3_enc[J+3],le!=0&&(U++,H*=2,l.xr[ne+3]<0&&H++),J+=4,ne+=4,y(f,H+s.table[U],s.hlen[U]),w+=s.hlen[U]}return w}function T(f,l,s,u,w){var J=q.ht[l],ne=0;if(l==0)return ne;for(var H=s;H<u;H+=2){var U=0,le=0,de=J.xlen,ve=J.xlen,Ae=0,ge=w.l3_enc[H],we=w.l3_enc[H+1];if(ge!=0&&(w.xr[H]<0&&Ae++,U--),l>15){if(ge>14){var Be=ge-15;Y(Be<=J.linmax),Ae|=Be<<1,le=de,ge=15}if(we>14){var Qe=we-15;Y(Qe<=J.linmax),Ae<<=de,Ae|=Qe,le+=de,we=15}ve=16}we!=0&&(Ae<<=1,w.xr[H+1]<0&&Ae++,U--),ge=ge*ve+we,le-=U,U+=J.hlen[ge],y(f,J.table[ge],U),y(f,Ae,le),ne+=U+le}return ne}function W(f,l){var s=3*f.scalefac_band.s[3];s>l.big_values&&(s=l.big_values);var u=T(f,l.table_select[0],0,s,l);return u+=T(f,l.table_select[1],s,l.big_values,l),u}function G(f,l){var s,u,w,J;s=l.big_values;var ne=l.region0_count+1;return Y(ne<f.scalefac_band.l.length),w=f.scalefac_band.l[ne],ne+=l.region1_count+1,Y(ne<f.scalefac_band.l.length),J=f.scalefac_band.l[ne],w>s&&(w=s),J>s&&(J=s),u=T(f,l.table_select[0],0,w,l),u+=T(f,l.table_select[1],w,J,l),u+=T(f,l.table_select[2],J,s,l),u}function P(f){var l,s,u,w,J=0,ne=f.internal_flags,H=ne.l3_side;if(f.version==1)for(l=0;l<2;l++)for(s=0;s<ne.channels_out;s++){var U=H.tt[l][s],le=F.slen1_tab[U.scalefac_compress],de=F.slen2_tab[U.scalefac_compress];for(w=0,u=0;u<U.sfbdivide;u++)U.scalefac[u]!=-1&&(y(ne,U.scalefac[u],le),w+=le);for(;u<U.sfbmax;u++)U.scalefac[u]!=-1&&(y(ne,U.scalefac[u],de),w+=de);Y(w==U.part2_length),U.block_type==ee.SHORT_TYPE?w+=W(ne,U):w+=G(ne,U),w+=k(ne,U),Y(w==U.part2_3_length+U.part2_length),J+=w}else for(l=0,s=0;s<ne.channels_out;s++){var U=H.tt[l][s],ve,Ae,ge=0;if(Y(U.sfb_partition_table!=null),w=0,u=0,Ae=0,U.block_type==ee.SHORT_TYPE){for(;Ae<4;Ae++){var we=U.sfb_partition_table[Ae]/3,Be=U.slen[Ae];for(ve=0;ve<we;ve++,u++)y(ne,Math.max(U.scalefac[u*3+0],0),Be),y(ne,Math.max(U.scalefac[u*3+1],0),Be),y(ne,Math.max(U.scalefac[u*3+2],0),Be),ge+=3*Be}w+=W(ne,U)}else{for(;Ae<4;Ae++){var we=U.sfb_partition_table[Ae],Be=U.slen[Ae];for(ve=0;ve<we;ve++,u++)y(ne,Math.max(U.scalefac[u],0),Be),ge+=Be}w+=G(ne,U)}w+=k(ne,U),Y(w==U.part2_3_length),Y(ge==U.part2_length),J+=ge+w}return J}function N(){this.total=0}function A(f,l){var s=f.internal_flags,u,w,J,ne,H;return H=s.w_ptr,ne=s.h_ptr-1,ne==-1&&(ne=g.MAX_HEADER_BUF-1),u=s.header[ne].write_timing-p,l.total=u,u>=0&&(w=1+ne-H,ne<H&&(w=1+ne-H+g.MAX_HEADER_BUF),u-=w*8*s.sideinfo_len),J=_.getframebits(f),u+=J,l.total+=J,l.total%8!=0?l.total=1+l.total/8:l.total=l.total/8,l.total+=L+1,u<0&&z.err.println(`strange error flushing buffer ... 
`),u}this.flush_bitstream=function(f){var l=f.internal_flags,s,u,w=l.h_ptr-1;if(w==-1&&(w=g.MAX_HEADER_BUF-1),s=l.l3_side,!((u=A(f,new N))<0)){if(j(f,u),Y(l.header[w].write_timing+this.getframebits(f)==p),l.ResvSize=0,s.main_data_begin=0,l.findReplayGain){var J=V.GetTitleGain(l.rgdata);Y(NEQ(J,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),l.RadioGain=Math.floor(J*10+.5)|0}l.findPeakSample&&(l.noclipGainChange=Math.ceil(Math.log10(l.PeakSample/32767)*20*10)|0,l.noclipGainChange>0&&(EQ(f.scale,1)||EQ(f.scale,0))?l.noclipScale=Math.floor(32767/l.PeakSample*100)/100:l.noclipScale=-1)}},this.add_dummy_byte=function(f,l,s){for(var u=f.internal_flags,w;s-- >0;)for(Z(u,l,8),w=0;w<g.MAX_HEADER_BUF;++w)u.header[w].write_timing+=8},this.format_bitstream=function(f){var l=f.internal_flags,s;s=l.l3_side;var u=this.getframebits(f);j(f,s.resvDrain_pre),x(f,u);var w=8*l.sideinfo_len;if(w+=P(f),j(f,s.resvDrain_post),w+=s.resvDrain_post,s.main_data_begin+=(u-w)/8,A(f,new N)!=l.ResvSize&&z.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),s.main_data_begin*8!=l.ResvSize&&(z.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*s.main_data_begin,l.ResvSize,s.resvDrain_post,s.resvDrain_pre,8*l.sideinfo_len,w-s.resvDrain_post-8*l.sideinfo_len,w,w%8,u),z.err.println("This is a fatal error.  It has several possible causes:"),z.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),z.err.println(" 9%%  Your system is overclocked"),z.err.println(" 1%%  bug in LAME encoding library"),l.ResvSize=s.main_data_begin*8),p>1e9){var J;for(J=0;J<g.MAX_HEADER_BUF;++J)l.header[J].write_timing-=p;p=0}return 0},this.copy_buffer=function(f,l,s,u,w){var J=L+1;if(J<=0)return 0;if(u!=0&&J>u)return-1;if(z.arraycopy(t,0,l,s,J),L=-1,v=0,w!=0){var ne=X(1);if(ne[0]=f.nMusicCRC,r.updateMusicCRC(ne,l,s,J),f.nMusicCRC=ne[0],J>0&&(f.VBR_seek_table.nBytesWritten+=J),f.decode_on_the_fly){for(var H=O([2,1152]),U=J,le=-1,de;le!=0;)if(le=B.hip_decode1_unclipped(f.hip,l,s,U,H[0],H[1]),U=0,le==-1&&(le=0),le>0){if(f.findPeakSample){for(de=0;de<le;de++)H[0][de]>f.PeakSample?f.PeakSample=H[0][de]:-H[0][de]>f.PeakSample&&(f.PeakSample=-H[0][de]);if(f.channels_out>1)for(de=0;de<le;de++)H[1][de]>f.PeakSample?f.PeakSample=H[1][de]:-H[1][de]>f.PeakSample&&(f.PeakSample=-H[1][de])}if(f.findReplayGain&&V.AnalyzeSamples(f.rgdata,H[0],0,H[1],0,le,f.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return J},this.init_bit_stream_w=function(f){t=R(a.LAME_MAXMP3BUFFER),f.h_ptr=f.w_ptr=0,f.header[f.h_ptr].write_timing=0,L=-1,v=0,p=0}}return za=e,za}var Wa,Hn;function ln(){if(Hn)return Wa;Hn=1;var S=et,z=S.System,i=S.VbrMode,R=S.ShortBlock,O=S.new_float,X=S.new_int_n,Y=S.new_short_n,F=S.assert,q=K1,ee=er,g=Pa,e=kr,a=Tr,_=Vr,m=on(),V=sn,B=dt();function n(){var r=ba,t=this,p=128*1024;n.V9=410,n.V8=420,n.V7=430,n.V6=440,n.V5=450,n.V4=460,n.V3=470,n.V2=480,n.V1=490,n.V0=500,n.R3MIX=1e3,n.STANDARD=1001,n.EXTREME=1002,n.INSANE=1003,n.STANDARD_FAST=1004,n.EXTREME_FAST=1005,n.MEDIUM=1006,n.MEDIUM_FAST=1007;var L=16384+p;n.LAME_MAXMP3BUFFER=L;var v,M,y,Z,j,D=new q,h,x,k;this.enc=new B,this.setModules=function(o,c,be,Se,De,Re,xe,Me,Le){v=o,M=c,y=be,Z=Se,j=De,h=Re,x=Me,k=Le,this.enc.setModules(M,D,Z,h)};function T(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=O(B.SBMAX_l),this.bo_s_weight=O(B.SBMAX_s)}function W(){this.lowerlimit=0}function G(o,c){this.lowpass=c}var P=4294479419;function N(o){var c;return o.class_id=P,c=o.internal_flags=new g,o.mode=r.NOT_SET,o.original=1,o.in_samplerate=44100,o.num_channels=2,o.num_samples=-1,o.bWriteVbrTag=!0,o.quality=-1,o.short_blocks=null,c.subblock_gain=-1,o.lowpassfreq=0,o.highpassfreq=0,o.lowpasswidth=-1,o.highpasswidth=-1,o.VBR=i.vbr_off,o.VBR_q=4,o.ATHcurve=-1,o.VBR_mean_bitrate_kbps=128,o.VBR_min_bitrate_kbps=0,o.VBR_max_bitrate_kbps=0,o.VBR_hard_min=0,c.VBR_min_bitrate=1,c.VBR_max_bitrate=13,o.quant_comp=-1,o.quant_comp_short=-1,o.msfix=-1,c.resample_ratio=1,c.OldValue[0]=180,c.OldValue[1]=180,c.CurrentStep[0]=4,c.CurrentStep[1]=4,c.masking_lower=1,c.nsPsy.attackthre=-1,c.nsPsy.attackthre_s=-1,o.scale=-1,o.athaa_type=-1,o.ATHtype=-1,o.athaa_loudapprox=-1,o.athaa_sensitivity=0,o.useTemporal=null,o.interChRatio=-1,c.mf_samples_to_encode=B.ENCDELAY+B.POSTDELAY,o.encoder_padding=0,c.mf_size=B.ENCDELAY-B.MDCTDELAY,o.findReplayGain=!1,o.decode_on_the_fly=!1,c.decode_on_the_fly=!1,c.findReplayGain=!1,c.findPeakSample=!1,c.RadioGain=0,c.AudiophileGain=0,c.noclipGainChange=0,c.noclipScale=-1,o.preset=0,o.write_id3tag_automatic=!0,0}this.lame_init=function(){var o=new ee;return N(o),o.lame_allocated_gfp=1,o};function A(o){return o>1?0:o<=0?1:Math.cos(Math.PI/2*o)}this.nearestBitrateFullIndex=function(o){var c=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],be=0,Se=0,De=0,Re=0;Re=c[16],De=16,Se=c[16],be=16;for(var xe=0;xe<16;xe++)if(Math.max(o,c[xe+1])!=o){Re=c[xe+1],De=xe+1,Se=c[xe],be=xe;break}return Re-o>o-Se?be:De};function f(o,c){var be=44100;return c>=48e3?be=48e3:c>=44100?be=44100:c>=32e3?be=32e3:c>=24e3?be=24e3:c>=22050?be=22050:c>=16e3?be=16e3:c>=12e3?be=12e3:c>=11025?be=11025:c>=8e3&&(be=8e3),o==-1?be:(o<=15960&&(be=44100),o<=15250&&(be=32e3),o<=11220&&(be=24e3),o<=9970&&(be=22050),o<=7230&&(be=16e3),o<=5420&&(be=12e3),o<=4510&&(be=11025),o<=3970&&(be=8e3),c<be?c>44100?48e3:c>32e3?44100:c>24e3?32e3:c>22050?24e3:c>16e3?22050:c>12e3?16e3:c>11025?12e3:c>8e3?11025:8e3:be)}function l(o,c){switch(o){case 44100:return c.version=1,0;case 48e3:return c.version=1,1;case 32e3:return c.version=1,2;case 22050:return c.version=0,0;case 24e3:return c.version=0,1;case 16e3:return c.version=0,2;case 11025:return c.version=0,0;case 12e3:return c.version=0,1;case 8e3:return c.version=0,2;default:return c.version=0,-1}}function s(o,c,be){be<16e3&&(c=2);for(var Se=V.bitrate_table[c][1],De=2;De<=14;De++)V.bitrate_table[c][De]>0&&Math.abs(V.bitrate_table[c][De]-o)<Math.abs(Se-o)&&(Se=V.bitrate_table[c][De]);return Se}function u(o,c,be){be<16e3&&(c=2);for(var Se=0;Se<=14;Se++)if(V.bitrate_table[c][Se]>0&&V.bitrate_table[c][Se]==o)return Se;return-1}function w(o,c){var be=[new G(8,2e3),new G(16,3700),new G(24,3900),new G(32,5500),new G(40,7e3),new G(48,7500),new G(56,1e4),new G(64,11e3),new G(80,13500),new G(96,15100),new G(112,15600),new G(128,17e3),new G(160,17500),new G(192,18600),new G(224,19400),new G(256,19700),new G(320,20500)],Se=t.nearestBitrateFullIndex(c);o.lowerlimit=be[Se].lowpass}function J(o){var c=o.internal_flags,be=32,Se=-1;if(c.lowpass1>0){for(var De=999,Re=0;Re<=31;Re++){var xe=Re/31;xe>=c.lowpass2&&(be=Math.min(be,Re)),c.lowpass1<xe&&xe<c.lowpass2&&(De=Math.min(De,Re))}De==999?c.lowpass1=(be-.75)/31:c.lowpass1=(De-.75)/31,c.lowpass2=be/31}if(c.highpass2>0&&c.highpass2<.9*(.75/31)&&(c.highpass1=0,c.highpass2=0,z.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),c.highpass2>0){for(var Me=-1,Re=0;Re<=31;Re++){var xe=Re/31;xe<=c.highpass1&&(Se=Math.max(Se,Re)),c.highpass1<xe&&xe<c.highpass2&&(Me=Math.max(Me,Re))}c.highpass1=Se/31,Me==-1?c.highpass2=(Se+.75)/31:c.highpass2=(Me+.75)/31}for(var Re=0;Re<32;Re++){var Le,Ie,xe=Re/31;c.highpass2>c.highpass1?Le=A((c.highpass2-xe)/(c.highpass2-c.highpass1+1e-20)):Le=1,c.lowpass2>c.lowpass1?Ie=A((xe-c.lowpass1)/(c.lowpass2-c.lowpass1+1e-20)):Ie=1,c.amp_filter[Re]=Le*Ie}}function ne(o){var c=o.internal_flags;switch(o.quality){default:case 9:c.psymodel=0,c.noise_shaping=0,c.noise_shaping_amp=0,c.noise_shaping_stop=0,c.use_best_huffman=0,c.full_outer_loop=0;break;case 8:o.quality=7;case 7:c.psymodel=1,c.noise_shaping=0,c.noise_shaping_amp=0,c.noise_shaping_stop=0,c.use_best_huffman=0,c.full_outer_loop=0;break;case 6:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.noise_shaping_amp=0,c.noise_shaping_stop=0,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=0,c.full_outer_loop=0;break;case 5:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.noise_shaping_amp=0,c.noise_shaping_stop=0,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=0,c.full_outer_loop=0;break;case 4:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.noise_shaping_amp=0,c.noise_shaping_stop=0,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=1,c.full_outer_loop=0;break;case 3:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.noise_shaping_amp=1,c.noise_shaping_stop=1,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=1,c.full_outer_loop=0;break;case 2:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.substep_shaping==0&&(c.substep_shaping=2),c.noise_shaping_amp=1,c.noise_shaping_stop=1,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=1,c.full_outer_loop=0;break;case 1:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.substep_shaping==0&&(c.substep_shaping=2),c.noise_shaping_amp=2,c.noise_shaping_stop=1,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=1,c.full_outer_loop=0;break;case 0:c.psymodel=1,c.noise_shaping==0&&(c.noise_shaping=1),c.substep_shaping==0&&(c.substep_shaping=2),c.noise_shaping_amp=2,c.noise_shaping_stop=1,c.subblock_gain==-1&&(c.subblock_gain=1),c.use_best_huffman=1,c.full_outer_loop=0;break}}function H(o){var c=o.internal_flags;o.frameNum=0,o.write_id3tag_automatic&&x.id3tag_write_v2(o),c.bitrate_stereoMode_Hist=X([16,5]),c.bitrate_blockType_Hist=X([16,6]),c.PeakSample=0,o.bWriteVbrTag&&h.InitVbrTag(o)}this.lame_init_params=function(o){var c=o.internal_flags;if(c.Class_ID=0,c.ATH==null&&(c.ATH=new e),c.PSY==null&&(c.PSY=new T),c.rgdata==null&&(c.rgdata=new a),c.channels_in=o.num_channels,c.channels_in==1&&(o.mode=r.MONO),c.channels_out=o.mode==r.MONO?1:2,c.mode_ext=B.MPG_MD_MS_LR,o.mode==r.MONO&&(o.force_ms=!1),o.VBR==i.vbr_off&&o.VBR_mean_bitrate_kbps!=128&&o.brate==0&&(o.brate=o.VBR_mean_bitrate_kbps),o.VBR==i.vbr_off||o.VBR==i.vbr_mtrh||o.VBR==i.vbr_mt||(o.free_format=!1),o.VBR==i.vbr_off&&o.brate==0&&m.EQ(o.compression_ratio,0)&&(o.compression_ratio=11.025),o.VBR==i.vbr_off&&o.compression_ratio>0&&(o.out_samplerate==0&&(o.out_samplerate=map2MP3Frequency(int(.97*o.in_samplerate))),o.brate=0|o.out_samplerate*16*c.channels_out/(1e3*o.compression_ratio),c.samplerate_index=l(o.out_samplerate,o),o.free_format||(o.brate=s(o.brate,o.version,o.out_samplerate))),o.out_samplerate!=0&&(o.out_samplerate<16e3?(o.VBR_mean_bitrate_kbps=Math.max(o.VBR_mean_bitrate_kbps,8),o.VBR_mean_bitrate_kbps=Math.min(o.VBR_mean_bitrate_kbps,64)):o.out_samplerate<32e3?(o.VBR_mean_bitrate_kbps=Math.max(o.VBR_mean_bitrate_kbps,8),o.VBR_mean_bitrate_kbps=Math.min(o.VBR_mean_bitrate_kbps,160)):(o.VBR_mean_bitrate_kbps=Math.max(o.VBR_mean_bitrate_kbps,32),o.VBR_mean_bitrate_kbps=Math.min(o.VBR_mean_bitrate_kbps,320))),o.lowpassfreq==0){var be=16e3;switch(o.VBR){case i.vbr_off:{var Se=new W;w(Se,o.brate),be=Se.lowerlimit;break}case i.vbr_abr:{var Se=new W;w(Se,o.VBR_mean_bitrate_kbps),be=Se.lowerlimit;break}case i.vbr_rh:{var De=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=o.VBR_q&&o.VBR_q<=9){var Re=De[o.VBR_q],xe=De[o.VBR_q+1],Me=o.VBR_q_frac;be=linear_int(Re,xe,Me)}else be=19500;break}default:{var De=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=o.VBR_q&&o.VBR_q<=9){var Re=De[o.VBR_q],xe=De[o.VBR_q+1],Me=o.VBR_q_frac;be=linear_int(Re,xe,Me)}else be=19500}}o.mode==r.MONO&&(o.VBR==i.vbr_off||o.VBR==i.vbr_abr)&&(be*=1.5),o.lowpassfreq=be|0}if(o.out_samplerate==0&&(2*o.lowpassfreq>o.in_samplerate&&(o.lowpassfreq=o.in_samplerate/2),o.out_samplerate=f(o.lowpassfreq|0,o.in_samplerate)),o.lowpassfreq=Math.min(20500,o.lowpassfreq),o.lowpassfreq=Math.min(o.out_samplerate/2,o.lowpassfreq),o.VBR==i.vbr_off&&(o.compression_ratio=o.out_samplerate*16*c.channels_out/(1e3*o.brate)),o.VBR==i.vbr_abr&&(o.compression_ratio=o.out_samplerate*16*c.channels_out/(1e3*o.VBR_mean_bitrate_kbps)),o.bWriteVbrTag||(o.findReplayGain=!1,o.decode_on_the_fly=!1,c.findPeakSample=!1),c.findReplayGain=o.findReplayGain,c.decode_on_the_fly=o.decode_on_the_fly,c.decode_on_the_fly&&(c.findPeakSample=!0),c.findReplayGain&&v.InitGainAnalysis(c.rgdata,o.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return o.internal_flags=null,-6;switch(c.decode_on_the_fly&&!o.decode_only&&(c.hip!=null&&k.hip_decode_exit(c.hip),c.hip=k.hip_decode_init()),c.mode_gr=o.out_samplerate<=24e3?1:2,o.framesize=576*c.mode_gr,o.encoder_delay=B.ENCDELAY,c.resample_ratio=o.in_samplerate/o.out_samplerate,o.VBR){case i.vbr_mt:case i.vbr_rh:case i.vbr_mtrh:{var Le=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];o.compression_ratio=Le[o.VBR_q]}break;case i.vbr_abr:o.compression_ratio=o.out_samplerate*16*c.channels_out/(1e3*o.VBR_mean_bitrate_kbps);break;default:o.compression_ratio=o.out_samplerate*16*c.channels_out/(1e3*o.brate);break}if(o.mode==r.NOT_SET&&(o.mode=r.JOINT_STEREO),o.highpassfreq>0?(c.highpass1=2*o.highpassfreq,o.highpasswidth>=0?c.highpass2=2*(o.highpassfreq+o.highpasswidth):c.highpass2=2*o.highpassfreq,c.highpass1/=o.out_samplerate,c.highpass2/=o.out_samplerate):(c.highpass1=0,c.highpass2=0),o.lowpassfreq>0?(c.lowpass2=2*o.lowpassfreq,o.lowpasswidth>=0?(c.lowpass1=2*(o.lowpassfreq-o.lowpasswidth),c.lowpass1<0&&(c.lowpass1=0)):c.lowpass1=2*o.lowpassfreq,c.lowpass1/=o.out_samplerate,c.lowpass2/=o.out_samplerate):(c.lowpass1=0,c.lowpass2=0),J(o),c.samplerate_index=l(o.out_samplerate,o),c.samplerate_index<0)return o.internal_flags=null,-1;if(o.VBR==i.vbr_off){if(o.free_format)c.bitrate_index=0;else if(o.brate=s(o.brate,o.version,o.out_samplerate),c.bitrate_index=u(o.brate,o.version,o.out_samplerate),c.bitrate_index<=0)return o.internal_flags=null,-1}else c.bitrate_index=1;o.analysis&&(o.bWriteVbrTag=!1),c.pinfo!=null&&(o.bWriteVbrTag=!1),M.init_bit_stream_w(c);for(var Ie=c.samplerate_index+3*o.version+6*(o.out_samplerate<16e3?1:0),me=0;me<B.SBMAX_l+1;me++)c.scalefac_band.l[me]=Z.sfBandIndex[Ie].l[me];for(var me=0;me<B.PSFB21+1;me++){var Ze=(c.scalefac_band.l[22]-c.scalefac_band.l[21])/B.PSFB21,tt=c.scalefac_band.l[21]+me*Ze;c.scalefac_band.psfb21[me]=tt}c.scalefac_band.psfb21[B.PSFB21]=576;for(var me=0;me<B.SBMAX_s+1;me++)c.scalefac_band.s[me]=Z.sfBandIndex[Ie].s[me];for(var me=0;me<B.PSFB12+1;me++){var Ze=(c.scalefac_band.s[13]-c.scalefac_band.s[12])/B.PSFB12,tt=c.scalefac_band.s[12]+me*Ze;c.scalefac_band.psfb12[me]=tt}c.scalefac_band.psfb12[B.PSFB12]=192,o.version==1?c.sideinfo_len=c.channels_out==1?21:36:c.sideinfo_len=c.channels_out==1?13:21,o.error_protection&&(c.sideinfo_len+=2),H(o),c.Class_ID=P;{var d;for(d=0;d<19;d++)c.nsPsy.pefirbuf[d]=700*c.mode_gr*c.channels_out;o.ATHtype==-1&&(o.ATHtype=4)}switch(F(o.VBR_q<=9),F(o.VBR_q>=0),o.VBR){case i.vbr_mt:o.VBR=i.vbr_mtrh;case i.vbr_mtrh:{o.useTemporal==null&&(o.useTemporal=!1),y.apply_preset(o,500-o.VBR_q*10,0),o.quality<0&&(o.quality=LAME_DEFAULT_QUALITY),o.quality<5&&(o.quality=0),o.quality>5&&(o.quality=5),c.PSY.mask_adjust=o.maskingadjust,c.PSY.mask_adjust_short=o.maskingadjust_short,o.experimentalY?c.sfb21_extra=!1:c.sfb21_extra=o.out_samplerate>44e3,c.iteration_loop=new VBRNewIterationLoop(j);break}case i.vbr_rh:{y.apply_preset(o,500-o.VBR_q*10,0),c.PSY.mask_adjust=o.maskingadjust,c.PSY.mask_adjust_short=o.maskingadjust_short,o.experimentalY?c.sfb21_extra=!1:c.sfb21_extra=o.out_samplerate>44e3,o.quality>6&&(o.quality=6),o.quality<0&&(o.quality=LAME_DEFAULT_QUALITY),c.iteration_loop=new VBROldIterationLoop(j);break}default:{var b;c.sfb21_extra=!1,o.quality<0&&(o.quality=LAME_DEFAULT_QUALITY),b=o.VBR,b==i.vbr_off&&(o.VBR_mean_bitrate_kbps=o.brate),y.apply_preset(o,o.VBR_mean_bitrate_kbps,0),o.VBR=b,c.PSY.mask_adjust=o.maskingadjust,c.PSY.mask_adjust_short=o.maskingadjust_short,b==i.vbr_off?c.iteration_loop=new _(j):c.iteration_loop=new ABRIterationLoop(j);break}}if(F(o.scale>=0),o.VBR!=i.vbr_off){if(c.VBR_min_bitrate=1,c.VBR_max_bitrate=14,o.out_samplerate<16e3&&(c.VBR_max_bitrate=8),o.VBR_min_bitrate_kbps!=0&&(o.VBR_min_bitrate_kbps=s(o.VBR_min_bitrate_kbps,o.version,o.out_samplerate),c.VBR_min_bitrate=u(o.VBR_min_bitrate_kbps,o.version,o.out_samplerate),c.VBR_min_bitrate<0)||o.VBR_max_bitrate_kbps!=0&&(o.VBR_max_bitrate_kbps=s(o.VBR_max_bitrate_kbps,o.version,o.out_samplerate),c.VBR_max_bitrate=u(o.VBR_max_bitrate_kbps,o.version,o.out_samplerate),c.VBR_max_bitrate<0))return-1;o.VBR_min_bitrate_kbps=V.bitrate_table[o.version][c.VBR_min_bitrate],o.VBR_max_bitrate_kbps=V.bitrate_table[o.version][c.VBR_max_bitrate],o.VBR_mean_bitrate_kbps=Math.min(V.bitrate_table[o.version][c.VBR_max_bitrate],o.VBR_mean_bitrate_kbps),o.VBR_mean_bitrate_kbps=Math.max(V.bitrate_table[o.version][c.VBR_min_bitrate],o.VBR_mean_bitrate_kbps)}return o.tune&&(c.PSY.mask_adjust+=o.tune_value_a,c.PSY.mask_adjust_short+=o.tune_value_a),ne(o),F(o.scale>=0),o.athaa_type<0?c.ATH.useAdjust=3:c.ATH.useAdjust=o.athaa_type,c.ATH.aaSensitivityP=Math.pow(10,o.athaa_sensitivity/-10),o.short_blocks==null&&(o.short_blocks=R.short_block_allowed),o.short_blocks==R.short_block_allowed&&(o.mode==r.JOINT_STEREO||o.mode==r.STEREO)&&(o.short_blocks=R.short_block_coupled),o.quant_comp<0&&(o.quant_comp=1),o.quant_comp_short<0&&(o.quant_comp_short=0),o.msfix<0&&(o.msfix=0),o.exp_nspsytune=o.exp_nspsytune|1,o.internal_flags.nsPsy.attackthre<0&&(o.internal_flags.nsPsy.attackthre=q.NSATTACKTHRE),o.internal_flags.nsPsy.attackthre_s<0&&(o.internal_flags.nsPsy.attackthre_s=q.NSATTACKTHRE_S),F(o.scale>=0),o.scale<0&&(o.scale=1),o.ATHtype<0&&(o.ATHtype=4),o.ATHcurve<0&&(o.ATHcurve=4),o.athaa_loudapprox<0&&(o.athaa_loudapprox=2),o.interChRatio<0&&(o.interChRatio=0),o.useTemporal==null&&(o.useTemporal=!0),c.slot_lag=c.frac_SpF=0,o.VBR==i.vbr_off&&(c.slot_lag=c.frac_SpF=(o.version+1)*72e3*o.brate%o.out_samplerate|0),Z.iteration_init(o),D.psymodel_init(o),F(o.scale>=0),0};function U(o,c){(o.in_buffer_0==null||o.in_buffer_nsamples<c)&&(o.in_buffer_0=O(c),o.in_buffer_1=O(c),o.in_buffer_nsamples=c)}this.lame_encode_flush=function(o,c,be,Se){var De=o.internal_flags,Re=Y([2,1152]),xe=0,Me,Le,Ie,me,Ze=De.mf_samples_to_encode-B.POSTDELAY,tt=le(o);if(De.mf_samples_to_encode<1)return 0;for(Me=0,o.in_samplerate!=o.out_samplerate&&(Ze+=16*o.out_samplerate/o.in_samplerate),Ie=o.framesize-Ze%o.framesize,Ie<576&&(Ie+=o.framesize),o.encoder_padding=Ie,me=(Ze+Ie)/o.framesize;me>0&&xe>=0;){var d=tt-De.mf_size,b=o.frameNum;d*=o.in_samplerate,d/=o.out_samplerate,d>1152&&(d=1152),d<1&&(d=1),Le=Se-Me,Se==0&&(Le=0),xe=this.lame_encode_buffer(o,Re[0],Re[1],d,c,be,Le),be+=xe,Me+=xe,me-=b!=o.frameNum?1:0}if(De.mf_samples_to_encode=0,xe<0||(Le=Se-Me,Se==0&&(Le=0),M.flush_bitstream(o),xe=M.copy_buffer(De,c,be,Le,1),xe<0))return xe;if(be+=xe,Me+=xe,Le=Se-Me,Se==0&&(Le=0),o.write_id3tag_automatic){if(x.id3tag_write_v1(o),xe=M.copy_buffer(De,c,be,Le,0),xe<0)return xe;Me+=xe}return Me},this.lame_encode_buffer=function(o,c,be,Se,De,Re,xe){var Me=o.internal_flags,Le=[null,null];if(Me.Class_ID!=P)return-3;if(Se==0)return 0;U(Me,Se),Le[0]=Me.in_buffer_0,Le[1]=Me.in_buffer_1;for(var Ie=0;Ie<Se;Ie++)Le[0][Ie]=c[Ie],Me.channels_in>1&&(Le[1][Ie]=be[Ie]);return de(o,Le[0],Le[1],Se,De,Re,xe)};function le(o){var c=B.BLKSIZE+o.framesize-B.FFTOFFSET;return c=Math.max(c,512+o.framesize-32),c}function de(o,c,be,Se,De,Re,xe){var Me=o.internal_flags,Le=0,Ie,me,Ze,tt,d,b=[null,null],I=[null,null];if(Me.Class_ID!=P)return-3;if(Se==0)return 0;if(d=M.copy_buffer(Me,De,Re,xe,0),d<0)return d;if(Re+=d,Le+=d,I[0]=c,I[1]=be,m.NEQ(o.scale,0)&&m.NEQ(o.scale,1))for(me=0;me<Se;++me)I[0][me]*=o.scale,Me.channels_out==2&&(I[1][me]*=o.scale);if(m.NEQ(o.scale_left,0)&&m.NEQ(o.scale_left,1))for(me=0;me<Se;++me)I[0][me]*=o.scale_left;if(m.NEQ(o.scale_right,0)&&m.NEQ(o.scale_right,1))for(me=0;me<Se;++me)I[1][me]*=o.scale_right;if(o.num_channels==2&&Me.channels_out==1)for(me=0;me<Se;++me)I[0][me]=.5*(I[0][me]+I[1][me]),I[1][me]=0;tt=le(o),b[0]=Me.mfbuf[0],b[1]=Me.mfbuf[1];for(var C=0;Se>0;){var $=[null,null],E=0,K=0;$[0]=I[0],$[1]=I[1];var te=new Ae;if(kt(o,b,$,C,Se,te),E=te.n_in,K=te.n_out,Me.findReplayGain&&!Me.decode_on_the_fly&&v.AnalyzeSamples(Me.rgdata,b[0],Me.mf_size,b[1],Me.mf_size,K,Me.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(Se-=E,C+=E,Me.channels_out==2,Me.mf_size+=K,F(Me.mf_size<=g.MFSIZE),Me.mf_samples_to_encode<1&&(Me.mf_samples_to_encode=B.ENCDELAY+B.POSTDELAY),Me.mf_samples_to_encode+=K,Me.mf_size>=tt){var Q=xe-Le;if(xe==0&&(Q=0),Ie=ve(o,b[0],b[1],De,Re,Q),Ie<0)return Ie;for(Re+=Ie,Le+=Ie,Me.mf_size-=o.framesize,Me.mf_samples_to_encode-=o.framesize,Ze=0;Ze<Me.channels_out;Ze++)for(me=0;me<Me.mf_size;me++)b[Ze][me]=b[Ze][me+o.framesize]}}return Le}function ve(o,c,be,Se,De,Re){var xe=t.enc.lame_encode_mp3_frame(o,c,be,Se,De,Re);return o.frameNum++,xe}function Ae(){this.n_in=0,this.n_out=0}function ge(){this.num_used=0}function we(o,c){return c!=0?we(c,o%c):o}function Be(o,c,be){var Se=Math.PI*c;o/=be,o<0&&(o=0),o>1&&(o=1);var De=o-.5,Re=.42-.5*Math.cos(2*o*Math.PI)+.08*Math.cos(4*o*Math.PI);return Math.abs(De)<1e-9?Se/Math.PI:Re*Math.sin(be*Se*De)/(Math.PI*be*De)}function Qe(o,c,be,Se,De,Re,xe,Me,Le){var Ie=o.internal_flags,me,Ze=0,tt,d=o.out_samplerate/we(o.out_samplerate,o.in_samplerate);d>g.BPC&&(d=g.BPC);var b=Math.abs(Ie.resample_ratio-Math.floor(.5+Ie.resample_ratio))<1e-4?1:0,I=1/Ie.resample_ratio;I>1&&(I=1);var C=31;C%2==0&&--C,C+=b;var $=C+1;if(Ie.fill_buffer_resample_init==0){for(Ie.inbuf_old[0]=O($),Ie.inbuf_old[1]=O($),me=0;me<=2*d;++me)Ie.blackfilt[me]=O($);for(Ie.itime[0]=0,Ie.itime[1]=0,Ze=0;Ze<=2*d;Ze++){var E=0,K=(Ze-d)/(2*d);for(me=0;me<=C;me++)E+=Ie.blackfilt[Ze][me]=Be(me-K,I,C);for(me=0;me<=C;me++)Ie.blackfilt[Ze][me]/=E}Ie.fill_buffer_resample_init=1}var te=Ie.inbuf_old[Le];for(tt=0;tt<Se;tt++){var Q,ie;if(Q=tt*Ie.resample_ratio,Ze=0|Math.floor(Q-Ie.itime[Le]),C+Ze-C/2>=xe)break;var K=Q-Ie.itime[Le]-(Ze+.5*(C%2));ie=0|Math.floor(K*2*d+d+.5);var ae=0;for(me=0;me<=C;++me){var se=0|me+Ze-C/2,pe;pe=se<0?te[$+se]:De[Re+se],ae+=pe*Ie.blackfilt[ie][me]}c[be+tt]=ae}if(Me.num_used=Math.min(xe,C+Ze-C/2),Ie.itime[Le]+=Me.num_used-tt*Ie.resample_ratio,Me.num_used>=$)for(me=0;me<$;me++)te[me]=De[Re+Me.num_used+me-$];else{var Pe=$-Me.num_used;for(me=0;me<Pe;++me)te[me]=te[me+Me.num_used];for(Ze=0;me<$;++me,++Ze)te[me]=De[Re+Ze];F(Ze==Me.num_used)}return tt}function kt(o,c,be,Se,De,Re){var xe=o.internal_flags;if(xe.resample_ratio<.9999||xe.resample_ratio>1.0001)for(var Me=0;Me<xe.channels_out;Me++){var Le=new ge;Re.n_out=Qe(o,c[Me],xe.mf_size,o.framesize,be[Me],Se,De,Le,Me),Re.n_in=Le.num_used}else{Re.n_out=Math.min(o.framesize,De),Re.n_in=Re.n_out;for(var Ie=0;Ie<Re.n_out;++Ie)c[0][xe.mf_size+Ie]=be[0][Se+Ie],xe.channels_out==2&&(c[1][xe.mf_size+Ie]=be[1][Se+Ie])}}}return Wa=n,Wa}var Dr=et,Vt=Dr.VbrMode;function Lr(){var S=ln();function z(g,e,a,_,m,V,B,n,r,t,p,L,v,M,y){this.vbr_q=g,this.quant_comp=e,this.quant_comp_s=a,this.expY=_,this.st_lrm=m,this.st_s=V,this.masking_adj=B,this.masking_adj_short=n,this.ath_lower=r,this.ath_curve=t,this.ath_sensitivity=p,this.interch=L,this.safejoint=v,this.sfb21mod=M,this.msfix=y}function i(g,e,a,_,m,V,B,n,r,t,p,L,v,M){this.quant_comp=e,this.quant_comp_s=a,this.safejoint=_,this.nsmsfix=m,this.st_lrm=V,this.st_s=B,this.nsbass=n,this.scale=r,this.masking_adj=t,this.ath_lower=p,this.ath_curve=L,this.interch=v,this.sfscale=M}var R;this.setModules=function(g){R=g};var O=[new z(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new z(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new z(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new z(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new z(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new z(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new z(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new z(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new z(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new z(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new z(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],X=[new z(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new z(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new z(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new z(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new z(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new z(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new z(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new z(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new z(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new z(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new z(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function Y(g,e,a){var _=g.VBR==Vt.vbr_rh?O:X,m=g.VBR_q_frac,V=_[e],B=_[e+1],n=V;V.st_lrm=V.st_lrm+m*(B.st_lrm-V.st_lrm),V.st_s=V.st_s+m*(B.st_s-V.st_s),V.masking_adj=V.masking_adj+m*(B.masking_adj-V.masking_adj),V.masking_adj_short=V.masking_adj_short+m*(B.masking_adj_short-V.masking_adj_short),V.ath_lower=V.ath_lower+m*(B.ath_lower-V.ath_lower),V.ath_curve=V.ath_curve+m*(B.ath_curve-V.ath_curve),V.ath_sensitivity=V.ath_sensitivity+m*(B.ath_sensitivity-V.ath_sensitivity),V.interch=V.interch+m*(B.interch-V.interch),V.msfix=V.msfix+m*(B.msfix-V.msfix),ee(g,n.vbr_q),a!=0?g.quant_comp=n.quant_comp:Math.abs(g.quant_comp- -1)>0||(g.quant_comp=n.quant_comp),a!=0?g.quant_comp_short=n.quant_comp_s:Math.abs(g.quant_comp_short- -1)>0||(g.quant_comp_short=n.quant_comp_s),n.expY!=0&&(g.experimentalY=n.expY!=0),a!=0?g.internal_flags.nsPsy.attackthre=n.st_lrm:Math.abs(g.internal_flags.nsPsy.attackthre- -1)>0||(g.internal_flags.nsPsy.attackthre=n.st_lrm),a!=0?g.internal_flags.nsPsy.attackthre_s=n.st_s:Math.abs(g.internal_flags.nsPsy.attackthre_s- -1)>0||(g.internal_flags.nsPsy.attackthre_s=n.st_s),a!=0?g.maskingadjust=n.masking_adj:Math.abs(g.maskingadjust-0)>0||(g.maskingadjust=n.masking_adj),a!=0?g.maskingadjust_short=n.masking_adj_short:Math.abs(g.maskingadjust_short-0)>0||(g.maskingadjust_short=n.masking_adj_short),a!=0?g.ATHlower=-n.ath_lower/10:Math.abs(-g.ATHlower*10-0)>0||(g.ATHlower=-n.ath_lower/10),a!=0?g.ATHcurve=n.ath_curve:Math.abs(g.ATHcurve- -1)>0||(g.ATHcurve=n.ath_curve),a!=0?g.athaa_sensitivity=n.ath_sensitivity:Math.abs(g.athaa_sensitivity- -1)>0||(g.athaa_sensitivity=n.ath_sensitivity),n.interch>0&&(a!=0?g.interChRatio=n.interch:Math.abs(g.interChRatio- -1)>0||(g.interChRatio=n.interch)),n.safejoint>0&&(g.exp_nspsytune=g.exp_nspsytune|n.safejoint),n.sfb21mod>0&&(g.exp_nspsytune=g.exp_nspsytune|n.sfb21mod<<20),a!=0?g.msfix=n.msfix:Math.abs(g.msfix- -1)>0||(g.msfix=n.msfix),a==0&&(g.VBR_q=e,g.VBR_q_frac=m)}var F=[new i(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new i(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new i(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new i(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new i(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new i(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new i(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new i(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new i(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new i(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new i(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new i(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new i(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new i(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new i(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new i(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new i(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function q(g,e,a){var _=e,m=R.nearestBitrateFullIndex(e);if(g.VBR=Vt.vbr_abr,g.VBR_mean_bitrate_kbps=_,g.VBR_mean_bitrate_kbps=Math.min(g.VBR_mean_bitrate_kbps,320),g.VBR_mean_bitrate_kbps=Math.max(g.VBR_mean_bitrate_kbps,8),g.brate=g.VBR_mean_bitrate_kbps,g.VBR_mean_bitrate_kbps>320&&(g.disable_reservoir=!0),F[m].safejoint>0&&(g.exp_nspsytune=g.exp_nspsytune|2),F[m].sfscale>0&&(g.internal_flags.noise_shaping=2),Math.abs(F[m].nsbass)>0){var V=int(F[m].nsbass*4);V<0&&(V+=64),g.exp_nspsytune=g.exp_nspsytune|V<<2}return a!=0?g.quant_comp=F[m].quant_comp:Math.abs(g.quant_comp- -1)>0||(g.quant_comp=F[m].quant_comp),a!=0?g.quant_comp_short=F[m].quant_comp_s:Math.abs(g.quant_comp_short- -1)>0||(g.quant_comp_short=F[m].quant_comp_s),a!=0?g.msfix=F[m].nsmsfix:Math.abs(g.msfix- -1)>0||(g.msfix=F[m].nsmsfix),a!=0?g.internal_flags.nsPsy.attackthre=F[m].st_lrm:Math.abs(g.internal_flags.nsPsy.attackthre- -1)>0||(g.internal_flags.nsPsy.attackthre=F[m].st_lrm),a!=0?g.internal_flags.nsPsy.attackthre_s=F[m].st_s:Math.abs(g.internal_flags.nsPsy.attackthre_s- -1)>0||(g.internal_flags.nsPsy.attackthre_s=F[m].st_s),a!=0?g.scale=F[m].scale:Math.abs(g.scale- -1)>0||(g.scale=F[m].scale),a!=0?g.maskingadjust=F[m].masking_adj:Math.abs(g.maskingadjust-0)>0||(g.maskingadjust=F[m].masking_adj),F[m].masking_adj>0?a!=0?g.maskingadjust_short=F[m].masking_adj*.9:Math.abs(g.maskingadjust_short-0)>0||(g.maskingadjust_short=F[m].masking_adj*.9):a!=0?g.maskingadjust_short=F[m].masking_adj*1.1:Math.abs(g.maskingadjust_short-0)>0||(g.maskingadjust_short=F[m].masking_adj*1.1),a!=0?g.ATHlower=-F[m].ath_lower/10:Math.abs(-g.ATHlower*10-0)>0||(g.ATHlower=-F[m].ath_lower/10),a!=0?g.ATHcurve=F[m].ath_curve:Math.abs(g.ATHcurve- -1)>0||(g.ATHcurve=F[m].ath_curve),a!=0?g.interChRatio=F[m].interch:Math.abs(g.interChRatio- -1)>0||(g.interChRatio=F[m].interch),e}this.apply_preset=function(g,e,a){switch(e){case S.R3MIX:{e=S.V3,g.VBR=Vt.vbr_mtrh;break}case S.MEDIUM:{e=S.V4,g.VBR=Vt.vbr_rh;break}case S.MEDIUM_FAST:{e=S.V4,g.VBR=Vt.vbr_mtrh;break}case S.STANDARD:{e=S.V2,g.VBR=Vt.vbr_rh;break}case S.STANDARD_FAST:{e=S.V2,g.VBR=Vt.vbr_mtrh;break}case S.EXTREME:{e=S.V0,g.VBR=Vt.vbr_rh;break}case S.EXTREME_FAST:{e=S.V0,g.VBR=Vt.vbr_mtrh;break}case S.INSANE:return e=320,g.preset=e,q(g,e,a),g.VBR=Vt.vbr_off,e}switch(g.preset=e,e){case S.V9:return Y(g,9,a),e;case S.V8:return Y(g,8,a),e;case S.V7:return Y(g,7,a),e;case S.V6:return Y(g,6,a),e;case S.V5:return Y(g,5,a),e;case S.V4:return Y(g,4,a),e;case S.V3:return Y(g,3,a),e;case S.V2:return Y(g,2,a),e;case S.V1:return Y(g,1,a),e;case S.V0:return Y(g,0,a),e}return 8<=e&&e<=320?q(g,e,a):(g.preset=0,e)};function ee(g,e){var a=0;return 0>e&&(a=-1,e=0),9<e&&(a=-1,e=9),g.VBR_q=e,g.VBR_q_frac=0,a}}var Or=Lr;function Hr(){this.setModules=function(S,z){}}var Cr=Hr;function Xr(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Nr=Xr,g1=et,Cn=g1.new_float,Fr=g1.new_int;function qr(){this.global_gain=0,this.sfb_count1=0,this.step=Fr(39),this.noise=Cn(39),this.noise_log=Cn(39)}var Yr=qr,aa=et,Ht=aa.System,Xn=aa.VbrMode,Ka=aa.Util,Kt=aa.Arrays,_a=aa.new_float,fa=aa.assert,jr=Cr,Ja=Nr,Gr=Yr,je=dt(),Nn=an,Fn=Ea;function Zr(){var S;this.rv=null;var z;this.qupvt=null;var i,R=new jr,O;this.setModules=function(n,r,t,p){S=n,z=r,this.rv=r,i=t,this.qupvt=t,O=p,R.setModules(i,O)},this.ms_convert=function(n,r){for(var t=0;t<576;++t){var p=n.tt[r][0].xr[t],L=n.tt[r][1].xr[t];n.tt[r][0].xr[t]=(p+L)*(Ka.SQRT2*.5),n.tt[r][1].xr[t]=(p-L)*(Ka.SQRT2*.5)}};function X(n,r,t,p){p=0;for(var L=0;L<=t;++L){var v=Math.abs(n.xr[L]);p+=v,r[L]=Math.sqrt(v*Math.sqrt(v)),r[L]>n.xrpow_max&&(n.xrpow_max=r[L])}return p}this.init_xrpow=function(n,r,t){var p=0,L=0|r.max_nonzero_coeff;if(r.xrpow_max=0,Kt.fill(t,L,576,0),p=X(r,t,L,p),p>1e-20){var v=0;n.substep_shaping&2&&(v=1);for(var M=0;M<r.psymax;M++)n.pseudohalf[M]=v;return!0}return Kt.fill(r.l3_enc,0,576,0),!1};function Y(n,r){var t=n.ATH,p=r.xr;if(r.block_type!=je.SHORT_TYPE)for(var L=!1,v=je.PSFB21-1;v>=0&&!L;v--){var M=n.scalefac_band.psfb21[v],y=n.scalefac_band.psfb21[v+1],Z=i.athAdjust(t.adjust,t.psfb21[v],t.floor);n.nsPsy.longfact[21]>1e-12&&(Z*=n.nsPsy.longfact[21]);for(var j=y-1;j>=M;j--)if(Math.abs(p[j])<Z)p[j]=0;else{L=!0;break}}else for(var D=0;D<3;D++)for(var L=!1,v=je.PSFB12-1;v>=0&&!L;v--){var M=n.scalefac_band.s[12]*3+(n.scalefac_band.s[13]-n.scalefac_band.s[12])*D+(n.scalefac_band.psfb12[v]-n.scalefac_band.psfb12[0]),y=M+(n.scalefac_band.psfb12[v+1]-n.scalefac_band.psfb12[v]),h=i.athAdjust(t.adjust,t.psfb12[v],t.floor);n.nsPsy.shortfact[12]>1e-12&&(h*=n.nsPsy.shortfact[12]);for(var j=y-1;j>=M;j--)if(Math.abs(p[j])<h)p[j]=0;else{L=!0;break}}}this.init_outer_loop=function(n,r){r.part2_3_length=0,r.big_values=0,r.count1=0,r.global_gain=210,r.scalefac_compress=0,r.table_select[0]=0,r.table_select[1]=0,r.table_select[2]=0,r.subblock_gain[0]=0,r.subblock_gain[1]=0,r.subblock_gain[2]=0,r.subblock_gain[3]=0,r.region0_count=0,r.region1_count=0,r.preflag=0,r.scalefac_scale=0,r.count1table_select=0,r.part2_length=0,r.sfb_lmax=je.SBPSY_l,r.sfb_smin=je.SBPSY_s,r.psy_lmax=n.sfb21_extra?je.SBMAX_l:je.SBPSY_l,r.psymax=r.psy_lmax,r.sfbmax=r.sfb_lmax,r.sfbdivide=11;for(var t=0;t<je.SBMAX_l;t++)r.width[t]=n.scalefac_band.l[t+1]-n.scalefac_band.l[t],r.window[t]=3;if(r.block_type==je.SHORT_TYPE){var p=_a(576);r.sfb_smin=0,r.sfb_lmax=0,r.mixed_block_flag!=0&&(r.sfb_smin=3,r.sfb_lmax=n.mode_gr*2+4),r.psymax=r.sfb_lmax+3*((n.sfb21_extra?je.SBMAX_s:je.SBPSY_s)-r.sfb_smin),r.sfbmax=r.sfb_lmax+3*(je.SBPSY_s-r.sfb_smin),r.sfbdivide=r.sfbmax-18,r.psy_lmax=r.sfb_lmax;var L=n.scalefac_band.l[r.sfb_lmax];Ht.arraycopy(r.xr,0,p,0,576);for(var t=r.sfb_smin;t<je.SBMAX_s;t++)for(var v=n.scalefac_band.s[t],M=n.scalefac_band.s[t+1],y=0;y<3;y++)for(var Z=v;Z<M;Z++)r.xr[L++]=p[3*Z+y];for(var j=r.sfb_lmax,t=r.sfb_smin;t<je.SBMAX_s;t++)r.width[j]=r.width[j+1]=r.width[j+2]=n.scalefac_band.s[t+1]-n.scalefac_band.s[t],r.window[j]=0,r.window[j+1]=1,r.window[j+2]=2,j+=3}r.count1bits=0,r.sfb_partition_table=i.nr_of_sfb_block[0][0],r.slen[0]=0,r.slen[1]=0,r.slen[2]=0,r.slen[3]=0,r.max_nonzero_coeff=575,Kt.fill(r.scalefac,0),Y(n,r)};function F(n){this.ordinal=n}F.BINSEARCH_NONE=new F(0),F.BINSEARCH_UP=new F(1),F.BINSEARCH_DOWN=new F(2);function q(n,r,t,p,L){var v,M=n.CurrentStep[p],y=!1,Z=n.OldValue[p],j=F.BINSEARCH_NONE;for(r.global_gain=Z,t-=r.part2_length;;){var D;if(v=O.count_bits(n,L,r,null),M==1||v==t)break;v>t?(j==F.BINSEARCH_DOWN&&(y=!0),y&&(M/=2),j=F.BINSEARCH_UP,D=M):(j==F.BINSEARCH_UP&&(y=!0),y&&(M/=2),j=F.BINSEARCH_DOWN,D=-M),r.global_gain+=D,r.global_gain<0&&(r.global_gain=0,y=!0),r.global_gain>255&&(r.global_gain=255,y=!0)}for(fa(r.global_gain>=0),fa(r.global_gain<256);v>t&&r.global_gain<255;)r.global_gain++,v=O.count_bits(n,L,r,null);return n.CurrentStep[p]=Z-r.global_gain>=4?4:2,n.OldValue[p]=r.global_gain,r.part2_3_length=v,v}this.trancate_smallspectrums=function(n,r,t,p){var L=_a(Fn.SFBMAX);if(!(!(n.substep_shaping&4)&&r.block_type==je.SHORT_TYPE||n.substep_shaping&128)){i.calc_noise(r,t,L,new Ja,null);for(var M=0;M<576;M++){var v=0;r.l3_enc[M]!=0&&(v=Math.abs(r.xr[M])),p[M]=v}var M=0,y=8;r.block_type==je.SHORT_TYPE&&(y=6);do{var Z,j,D,h,x=r.width[y];if(M+=x,!(L[y]>=1)&&(Kt.sort(p,M-x,x),!BitStream.EQ(p[M-1],0))){Z=(1-L[y])*t[y],j=0,h=0;do{var k;for(D=1;h+D<x&&!BitStream.NEQ(p[h+M-x],p[h+M+D-x]);D++);if(k=p[h+M-x]*p[h+M-x]*D,Z<k){h!=0&&(j=p[h+M-x-1]);break}Z-=k,h+=D}while(h<x);if(!BitStream.EQ(j,0))do Math.abs(r.xr[M-x])<=j&&(r.l3_enc[M-x]=0);while(--x>0)}}while(++y<r.psymax);r.part2_3_length=O.noquant_count_bits(n,r,null)}};function ee(n){for(var r=0;r<n.sfbmax;r++)if(n.scalefac[r]+n.subblock_gain[n.window[r]]==0)return!1;return!0}function g(n){return Ka.FAST_LOG10(.368+.632*n*n*n)}function e(n,r){for(var t=1e-37,p=0;p<r.psymax;p++)t+=g(n[p]);return Math.max(1e-20,t)}function a(n,r,t,p,L){var v;switch(n){default:case 9:{r.over_count>0?(v=t.over_SSD<=r.over_SSD,t.over_SSD==r.over_SSD&&(v=t.bits<r.bits)):v=t.max_noise<0&&t.max_noise*10+t.bits<=r.max_noise*10+r.bits;break}case 0:v=t.over_count<r.over_count||t.over_count==r.over_count&&t.over_noise<r.over_noise||t.over_count==r.over_count&&BitStream.EQ(t.over_noise,r.over_noise)&&t.tot_noise<r.tot_noise;break;case 8:t.max_noise=e(L,p);case 1:v=t.max_noise<r.max_noise;break;case 2:v=t.tot_noise<r.tot_noise;break;case 3:v=t.tot_noise<r.tot_noise&&t.max_noise<r.max_noise;break;case 4:v=t.max_noise<=0&&r.max_noise>.2||t.max_noise<=0&&r.max_noise<0&&r.max_noise>t.max_noise-.2&&t.tot_noise<r.tot_noise||t.max_noise<=0&&r.max_noise>0&&r.max_noise>t.max_noise-.2&&t.tot_noise<r.tot_noise+r.over_noise||t.max_noise>0&&r.max_noise>-.05&&r.max_noise>t.max_noise-.1&&t.tot_noise+t.over_noise<r.tot_noise+r.over_noise||t.max_noise>0&&r.max_noise>-.1&&r.max_noise>t.max_noise-.15&&t.tot_noise+t.over_noise+t.over_noise<r.tot_noise+r.over_noise+r.over_noise;break;case 5:v=t.over_noise<r.over_noise||BitStream.EQ(t.over_noise,r.over_noise)&&t.tot_noise<r.tot_noise;break;case 6:v=t.over_noise<r.over_noise||BitStream.EQ(t.over_noise,r.over_noise)&&(t.max_noise<r.max_noise||BitStream.EQ(t.max_noise,r.max_noise)&&t.tot_noise<=r.tot_noise);break;case 7:v=t.over_count<r.over_count||t.over_noise<r.over_noise;break}return r.over_count==0&&(v=v&&t.bits<r.bits),v}function _(n,r,t,p,L){var v=n.internal_flags,M;r.scalefac_scale==0?M=1.2968395546510096:M=1.6817928305074292;for(var y=0,Z=0;Z<r.sfbmax;Z++)y<t[Z]&&(y=t[Z]);var j=v.noise_shaping_amp;switch(j==3&&(L?j=2:j=1),j){case 2:break;case 1:y>1?y=Math.pow(y,.5):y*=.95;break;default:y>1?y=1:y*=.95;break}for(var D=0,Z=0;Z<r.sfbmax;Z++){var h=r.width[Z],x;if(D+=h,!(t[Z]<y)){if(v.substep_shaping&2&&(v.pseudohalf[Z]=v.pseudohalf[Z]==0?1:0,v.pseudohalf[Z]==0&&v.noise_shaping_amp==2))return;for(r.scalefac[Z]++,x=-h;x<0;x++)p[D+x]*=M,p[D+x]>r.xrpow_max&&(r.xrpow_max=p[D+x]);if(v.noise_shaping_amp==2)return}}}function m(n,r){for(var t=1.2968395546510096,p=0,L=0;L<n.sfbmax;L++){var v=n.width[L],M=n.scalefac[L];if(n.preflag!=0&&(M+=i.pretab[L]),p+=v,M&1){M++;for(var y=-v;y<0;y++)r[p+y]*=t,r[p+y]>n.xrpow_max&&(n.xrpow_max=r[p+y])}n.scalefac[L]=M>>1}n.preflag=0,n.scalefac_scale=1}function V(n,r,t){var p,L=r.scalefac;for(p=0;p<r.sfb_lmax;p++)if(L[p]>=16)return!0;for(var v=0;v<3;v++){var M=0,y=0;for(p=r.sfb_lmax+v;p<r.sfbdivide;p+=3)M<L[p]&&(M=L[p]);for(;p<r.sfbmax;p+=3)y<L[p]&&(y=L[p]);if(!(M<16&&y<8)){if(r.subblock_gain[v]>=7)return!0;r.subblock_gain[v]++;var Z=n.scalefac_band.l[r.sfb_lmax];for(p=r.sfb_lmax+v;p<r.sfbmax;p+=3){var j,D=r.width[p],h=L[p];if(h=h-(4>>r.scalefac_scale),h>=0){L[p]=h,Z+=D*3;continue}L[p]=0;{var x=210+(h<<r.scalefac_scale+1);j=i.IPOW20(x)}Z+=D*(v+1);for(var k=-D;k<0;k++)t[Z+k]*=j,t[Z+k]>r.xrpow_max&&(r.xrpow_max=t[Z+k]);Z+=D*(3-v-1)}{var j=i.IPOW20(202);Z+=r.width[p]*(v+1);for(var k=-r.width[p];k<0;k++)t[Z+k]*=j,t[Z+k]>r.xrpow_max&&(r.xrpow_max=t[Z+k])}}}return!1}function B(n,r,t,p,L){var v=n.internal_flags;_(n,r,t,p,L);var M=ee(r);return M?!1:(v.mode_gr==2?M=O.scale_bitcount(r):M=O.scale_bitcount_lsf(v,r),M?(v.noise_shaping>1&&(Kt.fill(v.pseudohalf,0),r.scalefac_scale==0?(m(r,p),M=!1):r.block_type==je.SHORT_TYPE&&v.subblock_gain>0&&(M=V(v,r,p)||ee(r))),M||(v.mode_gr==2?M=O.scale_bitcount(r):M=O.scale_bitcount_lsf(v,r)),!M):!0)}this.outer_loop=function(n,r,t,p,L,v){var M=n.internal_flags,y=new Nn,Z=_a(576),j=_a(Fn.SFBMAX),D=new Ja,h,x=new Gr,k=9999999,T=!1,W=!1,G=0;if(q(M,r,v,L,p),M.noise_shaping==0)return 100;i.calc_noise(r,t,j,D,x),D.bits=r.part2_3_length,y.assign(r);var P=0;for(Ht.arraycopy(p,0,Z,0,576);!T;){do{var N=new Ja,A,f=255;if(M.substep_shaping&2?A=20:A=3,M.sfb21_extra&&(j[y.sfbmax]>1||y.block_type==je.SHORT_TYPE&&(j[y.sfbmax+1]>1||j[y.sfbmax+2]>1))||!B(n,y,j,p,W))break;y.scalefac_scale!=0&&(f=254);var l=v-y.part2_length;if(l<=0)break;for(;(y.part2_3_length=O.count_bits(M,p,y,x))>l&&y.global_gain<=f;)y.global_gain++;if(y.global_gain>f)break;if(D.over_count==0){for(;(y.part2_3_length=O.count_bits(M,p,y,x))>k&&y.global_gain<=f;)y.global_gain++;if(y.global_gain>f)break}if(i.calc_noise(y,t,j,N,x),N.bits=y.part2_3_length,r.block_type!=je.SHORT_TYPE?h=n.quant_comp:h=n.quant_comp_short,h=a(h,D,N,y,j)?1:0,h!=0)k=r.part2_3_length,D=N,r.assign(y),P=0,Ht.arraycopy(p,0,Z,0,576);else if(M.full_outer_loop==0&&(++P>A&&D.over_count==0||M.noise_shaping_amp==3&&W&&P>30||M.noise_shaping_amp==3&&W&&y.global_gain-G>15))break}while(y.global_gain+y.scalefac_scale<255);M.noise_shaping_amp==3?W?T=!0:(y.assign(r),Ht.arraycopy(Z,0,p,0,576),P=0,G=y.global_gain,W=!0):T=!0}return fa(r.global_gain+r.scalefac_scale<=255),n.VBR==Xn.vbr_rh||n.VBR==Xn.vbr_mtrh?Ht.arraycopy(Z,0,p,0,576):M.substep_shaping&1&&trancate_smallspectrums(M,r,t,p),D.over_count},this.iteration_finish_one=function(n,r,t){var p=n.l3_side,L=p.tt[r][t];O.best_scalefac_store(n,r,t,p),n.use_best_huffman==1&&O.best_huffman_divide(n,L),z.ResvAdjust(n,L)},this.VBR_encode_granule=function(n,r,t,p,L,v,M){var y=n.internal_flags,Z=new Nn,j=_a(576),D=M,h=M+1,x=(M+v)/2,k,T,W=0,G=y.sfb21_extra;fa(D<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Kt.fill(Z.l3_enc,0);do x>D-42?y.sfb21_extra=!1:y.sfb21_extra=G,T=outer_loop(n,r,t,p,L,x),T<=0?(W=1,h=r.part2_3_length,Z.assign(r),Ht.arraycopy(p,0,j,0,576),M=h-32,k=M-v,x=(M+v)/2):(v=x+32,k=M-v,x=(M+v)/2,W!=0&&(W=2,r.assign(Z),Ht.arraycopy(j,0,p,0,576)));while(k>12);y.sfb21_extra=G,W==2&&Ht.arraycopy(Z.l3_enc,0,r.l3_enc,0,576),fa(r.part2_3_length<=D)},this.get_framebits=function(n,r){var t=n.internal_flags;t.bitrate_index=t.VBR_min_bitrate;var p=S.getframebits(n);t.bitrate_index=1,p=S.getframebits(n);for(var L=1;L<=t.VBR_max_bitrate;L++){t.bitrate_index=L;var v=new MeanBits(p);r[L]=z.ResvFrameBegin(n,v),p=v.bits}},this.VBR_old_prepare=function(n,r,t,p,L,v,M,y,Z){var j=n.internal_flags,D,h=0,x=1,k=0;j.bitrate_index=j.VBR_max_bitrate;var T=z.ResvFrameBegin(n,new MeanBits(0))/j.mode_gr;get_framebits(n,v);for(var W=0;W<j.mode_gr;W++){var G=i.on_pe(n,r,y[W],T,W,0);j.mode_ext==je.MPG_MD_MS_LR&&(ms_convert(j.l3_side,W),i.reduce_side(y[W],t[W],T,G));for(var P=0;P<j.channels_out;++P){var N=j.l3_side.tt[W][P];N.block_type!=je.SHORT_TYPE?(h=1.28/(1+Math.exp(3.5-r[W][P]/300))-.05,D=j.PSY.mask_adjust-h):(h=2.56/(1+Math.exp(3.5-r[W][P]/300))-.14,D=j.PSY.mask_adjust_short-h),j.masking_lower=Math.pow(10,D*.1),init_outer_loop(j,N),Z[W][P]=i.calc_xmin(n,p[W][P],N,L[W][P]),Z[W][P]!=0&&(x=0),M[W][P]=126,k+=y[W][P]}}for(var W=0;W<j.mode_gr;W++)for(var P=0;P<j.channels_out;P++)k>v[j.VBR_max_bitrate]&&(y[W][P]*=v[j.VBR_max_bitrate],y[W][P]/=k),M[W][P]>y[W][P]&&(M[W][P]=y[W][P]);return x},this.bitpressure_strategy=function(n,r,t,p){for(var L=0;L<n.mode_gr;L++)for(var v=0;v<n.channels_out;v++){for(var M=n.l3_side.tt[L][v],y=r[L][v],Z=0,j=0;j<M.psy_lmax;j++)y[Z++]*=1+.029*j*j/je.SBMAX_l/je.SBMAX_l;if(M.block_type==je.SHORT_TYPE)for(var j=M.sfb_smin;j<je.SBMAX_s;j++)y[Z++]*=1+.029*j*j/je.SBMAX_s/je.SBMAX_s,y[Z++]*=1+.029*j*j/je.SBMAX_s/je.SBMAX_s,y[Z++]*=1+.029*j*j/je.SBMAX_s/je.SBMAX_s;p[L][v]=0|Math.max(t[L][v],.9*p[L][v])}},this.VBR_new_prepare=function(n,r,t,p,L,v){var M=n.internal_flags,y=1,Z=0,j=0,D;if(n.free_format){M.bitrate_index=0;var h=new MeanBits(Z);D=z.ResvFrameBegin(n,h),Z=h.bits,L[0]=D}else{M.bitrate_index=M.VBR_max_bitrate;var h=new MeanBits(Z);z.ResvFrameBegin(n,h),Z=h.bits,get_framebits(n,L),D=L[M.VBR_max_bitrate]}for(var x=0;x<M.mode_gr;x++){i.on_pe(n,r,v[x],Z,x,0),M.mode_ext==je.MPG_MD_MS_LR&&ms_convert(M.l3_side,x);for(var k=0;k<M.channels_out;++k){var T=M.l3_side.tt[x][k];M.masking_lower=Math.pow(10,M.PSY.mask_adjust*.1),init_outer_loop(M,T),i.calc_xmin(n,t[x][k],T,p[x][k])!=0&&(y=0),j+=v[x][k]}}for(var x=0;x<M.mode_gr;x++)for(var k=0;k<M.channels_out;k++)j>D&&(v[x][k]*=D,v[x][k]/=j);return y},this.calc_target_bits=function(n,r,t,p,L,v){var M=n.internal_flags,y=M.l3_side,Z,j,D,h,x=0;M.bitrate_index=M.VBR_max_bitrate;var k=new MeanBits(x);for(v[0]=z.ResvFrameBegin(n,k),x=k.bits,M.bitrate_index=1,x=S.getframebits(n)-M.sideinfo_len*8,L[0]=x/(M.mode_gr*M.channels_out),x=n.VBR_mean_bitrate_kbps*n.framesize*1e3,M.substep_shaping&1&&(x*=1.09),x/=n.out_samplerate,x-=M.sideinfo_len*8,x/=M.mode_gr*M.channels_out,Z=.93+.07*(11-n.compression_ratio)/(11-5.5),Z<.9&&(Z=.9),Z>1&&(Z=1),j=0;j<M.mode_gr;j++){var T=0;for(D=0;D<M.channels_out;D++){if(p[j][D]=int(Z*x),r[j][D]>700){var W=int((r[j][D]-700)/1.4),G=y.tt[j][D];p[j][D]=int(Z*x),G.block_type==je.SHORT_TYPE&&W<x/2&&(W=x/2),W>x*3/2?W=x*3/2:W<0&&(W=0),p[j][D]+=W}p[j][D]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(p[j][D]=LameInternalFlags.MAX_BITS_PER_CHANNEL),T+=p[j][D]}if(T>LameInternalFlags.MAX_BITS_PER_GRANULE)for(D=0;D<M.channels_out;++D)p[j][D]*=LameInternalFlags.MAX_BITS_PER_GRANULE,p[j][D]/=T}if(M.mode_ext==je.MPG_MD_MS_LR)for(j=0;j<M.mode_gr;j++)i.reduce_side(p[j],t[j],x*M.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(h=0,j=0;j<M.mode_gr;j++)for(D=0;D<M.channels_out;D++)p[j][D]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(p[j][D]=LameInternalFlags.MAX_BITS_PER_CHANNEL),h+=p[j][D];if(h>v[0])for(j=0;j<M.mode_gr;j++)for(D=0;D<M.channels_out;D++)p[j][D]*=v[0],p[j][D]/=h}}var Qr=Zr,$r=et,qn=$r.assert;function zr(){var S;this.setModules=function(z){S=z},this.ResvFrameBegin=function(z,i){var R=z.internal_flags,O,X=R.l3_side,Y=S.getframebits(z);i.bits=(Y-R.sideinfo_len*8)/R.mode_gr;var F=8*256*R.mode_gr-8;z.brate>320?O=8*int(z.brate*1e3/(z.out_samplerate/1152)/8+.5):(O=8*1440,z.strict_ISO&&(O=8*int(32e4/(z.out_samplerate/1152)/8+.5))),R.ResvMax=O-Y,R.ResvMax>F&&(R.ResvMax=F),(R.ResvMax<0||z.disable_reservoir)&&(R.ResvMax=0);var q=i.bits*R.mode_gr+Math.min(R.ResvSize,R.ResvMax);return q>O&&(q=O),qn(R.ResvMax%8==0),qn(R.ResvMax>=0),X.resvDrain_pre=0,R.pinfo!=null&&(R.pinfo.mean_bits=i.bits/2,R.pinfo.resvsize=R.ResvSize),q},this.ResvMaxBits=function(z,i,R,O){var X=z.internal_flags,Y,F=X.ResvSize,q=X.ResvMax;O!=0&&(F+=i),X.substep_shaping&1&&(q*=.9),R.bits=i,F*10>q*9?(Y=F-q*9/10,R.bits+=Y,X.substep_shaping|=128):(Y=0,X.substep_shaping&=127,!z.disable_reservoir&&!(X.substep_shaping&1)&&(R.bits-=.1*i));var ee=F<X.ResvMax*6/10?F:X.ResvMax*6/10;return ee-=Y,ee<0&&(ee=0),ee},this.ResvAdjust=function(z,i){z.ResvSize-=i.part2_3_length+i.part2_length},this.ResvFrameEnd=function(z,i){var R,O=z.l3_side;z.ResvSize+=i*z.mode_gr;var X=0;O.resvDrain_post=0,O.resvDrain_pre=0,(R=z.ResvSize%8)!=0&&(X+=R),R=z.ResvSize-X-z.ResvMax,R>0&&(X+=R);{var Y=Math.min(O.main_data_begin*8,X)/8;O.resvDrain_pre+=8*Y,X-=8*Y,z.ResvSize-=8*Y,O.main_data_begin-=Y}O.resvDrain_post+=X,z.ResvSize-=X}}var Wr=zr;function Kr(){var S="http://www.mp3dev.org/",z=3,i=98,R=4,O=0,X=93;this.getLameVersion=function(){return z+"."+i+"."+R},this.getLameShortVersion=function(){return z+"."+i+"."+R},this.getLameVeryShortVersion=function(){return"LAME"+z+"."+i+"r"},this.getPsyVersion=function(){return O+"."+X},this.getLameUrl=function(){return S},this.getLameOsBitness=function(){return"32bits"}}var Jr=Kr,na=et,Ur=na.System,Ua=na.VbrMode,Yn=na.ShortBlock,es=na.Arrays,Ta=na.new_byte,ts=na.assert;ma.NUMTOCENTRIES=100;ma.MAXFRAMESIZE=2880;function ma(){var S,z,i;this.setModules=function(x,k,T){S=x,z=k,i=T};var R=1,O=2,X=4,Y=8,F=ma.NUMTOCENTRIES,q=ma.MAXFRAMESIZE,ee=F+4+4+4+4+4,g=ee+9+1+1+8+1+1+3+1+1+2+4+2+2,e=128,a=64,_=32,m=null,V="Xing",B="Info",n=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function r(x,k){if(x.nVbrNumFrames++,x.sum+=k,x.seen++,!(x.seen<x.want)&&(x.pos<x.size&&(x.bag[x.pos]=x.sum,x.pos++,x.seen=0),x.pos==x.size)){for(var T=1;T<x.size;T+=2)x.bag[T/2]=x.bag[T];x.want*=2,x.pos/=2}}function t(x,k){if(!(x.pos<=0))for(var T=1;T<F;++T){var W=T/F,G,P,N=0|Math.floor(W*x.pos);N>x.pos-1&&(N=x.pos-1),G=x.bag[N],P=x.sum;var A=0|256*G/P;A>255&&(A=255),k[T]=255&A}}this.addVbrFrame=function(x){var k=x.internal_flags,T=Tables.bitrate_table[x.version][k.bitrate_index];ts(k.VBR_seek_table.bag!=null),r(k.VBR_seek_table,T)};function p(x,k){var T=x[k+0]&255;return T<<=8,T|=x[k+1]&255,T<<=8,T|=x[k+2]&255,T<<=8,T|=x[k+3]&255,T}function L(x,k,T){x[k+0]=255&(T>>24&255),x[k+1]=255&(T>>16&255),x[k+2]=255&(T>>8&255),x[k+3]=255&(T&255)}function v(x,k,T){x[k+0]=255&(T>>8&255),x[k+1]=255&(T&255)}function M(x,k){return new String(x,k,V.length(),m).equals(V)||new String(x,k,B.length(),m).equals(B)}function y(x,k,T){return 255&(x<<k|T&~(-1<<k))}function Z(x,k){var T=x.internal_flags;k[0]=y(k[0],8,255),k[1]=y(k[1],3,7),k[1]=y(k[1],1,x.out_samplerate<16e3?0:1),k[1]=y(k[1],1,x.version),k[1]=y(k[1],2,1),k[1]=y(k[1],1,x.error_protection?0:1),k[2]=y(k[2],4,T.bitrate_index),k[2]=y(k[2],2,T.samplerate_index),k[2]=y(k[2],1,0),k[2]=y(k[2],1,x.extension),k[3]=y(k[3],2,x.mode.ordinal()),k[3]=y(k[3],2,T.mode_ext),k[3]=y(k[3],1,x.copyright),k[3]=y(k[3],1,x.original),k[3]=y(k[3],2,x.emphasis),k[0]=255;var W=255&(k[1]&241),G;x.version==1?G=e:x.out_samplerate<16e3?G=_:G=a,x.VBR==Ua.vbr_off&&(G=x.brate);var P;x.free_format?P=0:P=255&16*S.BitrateIndex(G,x.version,x.out_samplerate),x.version==1?(k[1]=255&(W|10),W=255&(k[2]&13),k[2]=255&(P|W)):(k[1]=255&(W|2),W=255&(k[2]&13),k[2]=255&(P|W))}this.getVbrTag=function(x){var k=new VBRTagData,T=0;k.flags=0;var W=x[T+1]>>3&1,G=x[T+2]>>2&3,P=x[T+3]>>6&3,N=x[T+2]>>4&15;if(N=Tables.bitrate_table[W][N],x[T+1]>>4==14?k.samprate=Tables.samplerate_table[2][G]:k.samprate=Tables.samplerate_table[W][G],W!=0?P!=3?T+=36:T+=21:P!=3?T+=21:T+=13,!M(x,T))return null;T+=4,k.hId=W;var A=k.flags=p(x,T);if(T+=4,A&R&&(k.frames=p(x,T),T+=4),A&O&&(k.bytes=p(x,T),T+=4),A&X){if(k.toc!=null)for(var f=0;f<F;f++)k.toc[f]=x[T+f];T+=F}k.vbrScale=-1,A&Y&&(k.vbrScale=p(x,T),T+=4),k.headersize=(W+1)*72e3*N/k.samprate,T+=21;var l=x[T+0]<<4;l+=x[T+1]>>4;var s=(x[T+1]&15)<<8;return s+=x[T+2]&255,(l<0||l>3e3)&&(l=-1),(s<0||s>3e3)&&(s=-1),k.encDelay=l,k.encPadding=s,k},this.InitVbrTag=function(x){var k=x.internal_flags,T;x.version==1?T=e:x.out_samplerate<16e3?T=_:T=a,x.VBR==Ua.vbr_off&&(T=x.brate);var W=(x.version+1)*72e3*T/x.out_samplerate,G=k.sideinfo_len+g;if(k.VBR_seek_table.TotalFrameSize=W,W<G||W>q){x.bWriteVbrTag=!1;return}k.VBR_seek_table.nVbrNumFrames=0,k.VBR_seek_table.nBytesWritten=0,k.VBR_seek_table.sum=0,k.VBR_seek_table.seen=0,k.VBR_seek_table.want=1,k.VBR_seek_table.pos=0,k.VBR_seek_table.bag==null&&(k.VBR_seek_table.bag=new int[400],k.VBR_seek_table.size=400);var P=Ta(q);Z(x,P);for(var N=k.VBR_seek_table.TotalFrameSize,A=0;A<N;++A)z.add_dummy_byte(x,P[A]&255,1)};function j(x,k){var T=k^x;return k=k>>8^n[T&255],k}this.updateMusicCRC=function(x,k,T,W){for(var G=0;G<W;++G)x[0]=j(k[T+G],x[0])};function D(x,k,T,W,G){var P=x.internal_flags,N=0,A=x.encoder_delay,f=x.encoder_padding,l=100-10*x.VBR_q-x.quality,s=i.getLameVeryShortVersion(),u,w=0,J,ne=[1,5,3,2,4,0,3],H=0|(x.lowpassfreq/100+.5>255?255:x.lowpassfreq/100+.5),U=0,le=0,de=0,ve=x.internal_flags.noise_shaping,Ae=0,ge=0,we=0,Be=0,Qe=0,kt=(x.exp_nspsytune&1)!=0,o=(x.exp_nspsytune&2)!=0,c=!1,be=!1,Se=x.internal_flags.nogap_total,De=x.internal_flags.nogap_current,Re=x.ATHtype,xe=0,Me;switch(x.VBR){case vbr_abr:Me=x.VBR_mean_bitrate_kbps;break;case vbr_off:Me=x.brate;break;default:Me=x.VBR_min_bitrate_kbps}switch(x.VBR.ordinal()<ne.length?u=ne[x.VBR.ordinal()]:u=0,J=16*w+u,P.findReplayGain&&(P.RadioGain>510&&(P.RadioGain=510),P.RadioGain<-510&&(P.RadioGain=-510),le=8192,le|=3072,P.RadioGain>=0?le|=P.RadioGain:(le|=512,le|=-P.RadioGain)),P.findPeakSample&&(U=Math.abs(0|P.PeakSample/32767*Math.pow(2,23)+.5)),Se!=-1&&(De>0&&(be=!0),De<Se-1&&(c=!0)),xe=Re+((kt?1:0)<<4)+((o?1:0)<<5)+((c?1:0)<<6)+((be?1:0)<<7),l<0&&(l=0),x.mode){case MONO:Ae=0;break;case STEREO:Ae=1;break;case DUAL_CHANNEL:Ae=2;break;case JOINT_STEREO:x.force_ms?Ae=4:Ae=3;break;case NOT_SET:default:Ae=7;break}x.in_samplerate<=32e3?we=0:x.in_samplerate==48e3?we=2:x.in_samplerate>48e3?we=3:we=1,(x.short_blocks==Yn.short_block_forced||x.short_blocks==Yn.short_block_dispensed||x.lowpassfreq==-1&&x.highpassfreq==-1||x.scale_left<x.scale_right||x.scale_left>x.scale_right||x.disable_reservoir&&x.brate<320||x.noATH||x.ATHonly||Re==0||x.in_samplerate<=32e3)&&(ge=1),Be=ve+(Ae<<2)+(ge<<5)+(we<<6),Qe=P.nMusicCRC,L(T,W+N,l),N+=4;for(var Le=0;Le<9;Le++)T[W+N+Le]=255&s.charAt(Le);N+=9,T[W+N]=255&J,N++,T[W+N]=255&H,N++,L(T,W+N,U),N+=4,v(T,W+N,le),N+=2,v(T,W+N,de),N+=2,T[W+N]=255&xe,N++,Me>=255?T[W+N]=255:T[W+N]=255&Me,N++,T[W+N]=255&A>>4,T[W+N+1]=255&(A<<4)+(f>>8),T[W+N+2]=255&f,N+=3,T[W+N]=255&Be,N++,T[W+N++]=0,v(T,W+N,x.preset),N+=2,L(T,W+N,k),N+=4,v(T,W+N,Qe),N+=2;for(var Ie=0;Ie<N;Ie++)G=j(T[W+Ie],G);return v(T,W+N,G),N+=2,N}function h(x){x.seek(0);var k=Ta(10);x.readFully(k);var T;return new String(k,"ISO-8859-1").startsWith("ID3")?T=0:T=((k[6]&127)<<21|(k[7]&127)<<14|(k[8]&127)<<7|k[9]&127)+k.length,T}this.getLameTagFrame=function(x,k){var T=x.internal_flags;if(!x.bWriteVbrTag||T.Class_ID!=Lame.LAME_ID||T.VBR_seek_table.pos<=0)return 0;if(k.length<T.VBR_seek_table.TotalFrameSize)return T.VBR_seek_table.TotalFrameSize;es.fill(k,0,T.VBR_seek_table.TotalFrameSize,0),Z(x,k);var W=Ta(F);if(x.free_format)for(var G=1;G<F;++G)W[G]=255&255*G/100;else t(T.VBR_seek_table,W);var P=T.sideinfo_len;x.error_protection&&(P-=2),x.VBR==Ua.vbr_off?(k[P++]=255&B.charAt(0),k[P++]=255&B.charAt(1),k[P++]=255&B.charAt(2),k[P++]=255&B.charAt(3)):(k[P++]=255&V.charAt(0),k[P++]=255&V.charAt(1),k[P++]=255&V.charAt(2),k[P++]=255&V.charAt(3)),L(k,P,R+O+X+Y),P+=4,L(k,P,T.VBR_seek_table.nVbrNumFrames),P+=4;var N=T.VBR_seek_table.nBytesWritten+T.VBR_seek_table.TotalFrameSize;L(k,P,0|N),P+=4,Ur.arraycopy(W,0,k,P,W.length),P+=W.length,x.error_protection&&z.CRC_writeheader(T,k);for(var A=0,G=0;G<P;G++)A=j(k[G],A);return P+=D(x,N,k,P,A),T.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(x,k){var T=x.internal_flags;if(T.VBR_seek_table.pos<=0||(k.seek(k.length()),k.length()==0))return-1;var W=h(k);k.seek(W);var G=Ta(q),P=getLameTagFrame(x,G);return P>G.length?-1:(P<1||k.write(G,0,P),0)}}var as=ma,w1=et,jn=w1.new_byte,ns=w1.assert,rs=ln(),ss=Or,is=p1,os=b1(),ls=Qr,_s=v1(),fs=Wr,us=ba,cs=on();dt();var ds=Jr,ps=as;function ms(){this.setModules=function(S,z){}}function hs(){this.setModules=function(S,z,i){}}function bs(){}function vs(){this.setModules=function(S,z){}}function gs(S,z,i){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),S=1,z=44100,i=128);var R=new rs,O=new ms,X=new is,Y=new cs,F=new ss,q=new os,ee=new ls,g=new ps,e=new ds,a=new vs,_=new fs,m=new _s,V=new hs,B=new bs;R.setModules(X,Y,F,q,ee,g,e,a,B),Y.setModules(X,B,e,g),a.setModules(Y,e),F.setModules(R),ee.setModules(Y,_,q,m),q.setModules(m,_,R.enc.psy),_.setModules(Y),m.setModules(q),g.setModules(R,Y,e),O.setModules(V,B),V.setModules(e,a,F);var n=R.lame_init();n.num_channels=S,n.in_samplerate=z,n.brate=i,n.mode=us.STEREO,n.quality=3,n.bWriteVbrTag=!1,n.disable_reservoir=!0,n.write_id3tag_automatic=!1,R.lame_init_params(n);var r=1152,t=0|1.25*r+7200,p=jn(t);this.encodeBuffer=function(L,v){S==1&&(v=L),ns(L.length==v.length),L.length>r&&(r=L.length,t=0|1.25*r+7200,p=jn(t));var M=R.lame_encode_buffer(n,L,v,L.length,p,0,t);return new Int8Array(p.subarray(0,M))},this.flush=function(){var L=R.lame_encode_flush(n,p,0,t);return new Int8Array(p.subarray(0,L))}}function Et(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function Ia(S){return S.charCodeAt(0)<<24|S.charCodeAt(1)<<16|S.charCodeAt(2)<<8|S.charCodeAt(3)}Et.RIFF=Ia("RIFF");Et.WAVE=Ia("WAVE");Et.fmt_=Ia("fmt ");Et.data=Ia("data");Et.readHeader=function(S){var z=new Et,i=S.getUint32(0,!1);if(Et.RIFF==i&&(S.getUint32(4,!0),Et.WAVE==S.getUint32(8,!1)&&Et.fmt_==S.getUint32(12,!1))){var R=S.getUint32(16,!0),O=20;switch(R){case 16:case 18:z.channels=S.getUint16(O+2,!0),z.sampleRate=S.getUint32(O+4,!0);break;default:throw"extended fmt chunk not implemented"}O+=R;for(var X=Et.data,Y=0;X!=i&&(i=S.getUint32(O,!1),Y=S.getUint32(O+4,!0),X!=i);)O+=Y+8;return z.dataLen=Y,z.dataOffset=O+8,z}};tn.Mp3Encoder=gs;tn.WavHeader=Et;const ws={class:"audio-recorder"},ys={key:0,class:"recording-controls"},As={class:"col"},Ss={class:"text-caption"},ks={class:"audio-level-bar"},Ms={key:1,class:"preview-controls"},Ts={class:"text-subtitle2 q-mb-sm"},Bs={key:2,class:"q-mt-sm"},Gn=300,xs={__name:"AudioRecorder",props:{autoStart:{type:Boolean,default:!1}},emits:["audioReady","cancel"],setup(S,{emit:z}){const i=S,R=z,O=zn(),X=ze(!1),Y=ze(null),F=ze(!1),q=ze(0),ee=ze(0),g=ze(null),e=ze(0);let a=null,_=[],m=null,V=null,B=null,n=null,r=null;Kn(async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0}),F.value=!0,i.autoStart&&t()}catch{F.value=!1,O.notify({type:"warning",message:"Microphone permission denied",icon:"mic_off"})}}),Jn(()=>{m&&clearInterval(m),a&&a.state!=="inactive"&&a.stop(),L()});async function t(){try{const j=await navigator.mediaDevices.getUserMedia({audio:!0});a=new MediaRecorder(j),_=[],q.value=0,ee.value=0,a.ondataavailable=D=>{_.push(D.data)},a.onstop=async()=>{const D=new Blob(_,{type:"audio/webm"});await y(D),j.getTracks().forEach(h=>h.stop()),L()},a.start(),X.value=!0,p(j),m=setInterval(()=>{q.value++,ee.value=q.value/Gn,q.value>=Gn&&(v(),O.notify({type:"info",message:"Maximum recording duration (5 minutes) reached",icon:"info"}))},1e3)}catch{O.notify({type:"negative",message:"Failed to start recording",icon:"error"})}}function p(j){try{V=new(window.AudioContext||window.webkitAudioContext),B=V.createAnalyser(),n=V.createMediaStreamSource(j),B.smoothingTimeConstant=.8,B.fftSize=1024,n.connect(B);const D=new Uint8Array(B.frequencyBinCount),h=()=>{if(!X.value)return;B.getByteFrequencyData(D);const k=D.reduce((T,W)=>T+W,0)/D.length;e.value=Math.min(100,Math.round(k*1.5)),r=requestAnimationFrame(h)};h()}catch(D){console.error("Failed to start audio level monitoring:",D)}}function L(){r&&(cancelAnimationFrame(r),r=null),n&&(n.disconnect(),n=null),B&&(B.disconnect(),B=null),V&&(V.close(),V=null),e.value=0}function v(){a&&a.state!=="inactive"&&(a.stop(),X.value=!1,m&&(clearInterval(m),m=null))}function M(){a&&a.state!=="inactive"&&(a.stop(),X.value=!1,m&&(clearInterval(m),m=null)),L(),Y.value=null,q.value=0,ee.value=0,R("cancel")}async function y(j){try{const D=await j.arrayBuffer(),x=await new AudioContext().decodeAudioData(D),k=x.numberOfChannels,T=x.sampleRate,W=x.getChannelData(0),G=new Int16Array(W.length);for(let s=0;s<W.length;s++){const u=Math.max(-1,Math.min(1,W[s]));G[s]=u<0?u*32768:u*32767}let P=null;if(k===2){const s=x.getChannelData(1);P=new Int16Array(s.length);for(let u=0;u<s.length;u++){const w=Math.max(-1,Math.min(1,s[u]));P[u]=w<0?w*32768:w*32767}}const N=new tn.Mp3Encoder(k,T,128),A=[],f=1152;for(let s=0;s<G.length;s+=f){const u=G.subarray(s,s+f);let w;if(k===2&&P){const J=P.subarray(s,s+f);w=N.encodeBuffer(u,J)}else w=N.encodeBuffer(u);w.length>0&&A.push(w)}const l=N.flush();l.length>0&&A.push(l),Y.value=new Blob(A,{type:"audio/mp3"}),i.autoStart?R("audioReady",Y.value):g.value&&(g.value.src=URL.createObjectURL(Y.value))}catch(D){console.error("Audio encoding error:",D),O.notify({type:"negative",message:"Failed to encode audio: "+D.message,icon:"error"})}}function Z(j){const D=Math.floor(j/60),h=j%60;return`${D}:${h.toString().padStart(2,"0")}`}return(j,D)=>(Fe(),qe("div",ws,[X.value?(Fe(),qe("div",ys,[Te(ea,{flat:"",bordered:""},{default:He(()=>[Te(Ut,{class:"row items-center q-gutter-sm"},{default:He(()=>[Te(H1,{color:"negative",size:"md"}),Ge("div",As,[D[0]||(D[0]=Ge("div",{class:"text-weight-medium"},"Recording...",-1)),Ge("div",Ss,lt(Z(q.value))+" / 5:00",1),Ge("div",ks,[Ge("div",{class:"audio-level-fill",style:da({width:e.value+"%"})},null,4)])]),Te(it,{flat:"",round:"",color:"positive",icon:"check",onClick:v},{default:He(()=>[Te(ft,null,{default:He(()=>[...D[1]||(D[1]=[Ue("Done",-1)])]),_:1})]),_:1}),Te(it,{flat:"",round:"",color:"negative",icon:"close",onClick:M},{default:He(()=>[Te(ft,null,{default:He(()=>[...D[2]||(D[2]=[Ue("Cancel recording",-1)])]),_:1})]),_:1})]),_:1}),Te(X1,{value:ee.value,color:"negative"},null,8,["value"])]),_:1})])):ct("",!0),Y.value&&!X.value?(Fe(),qe("div",Ms,[Te(ea,{flat:"",bordered:""},{default:He(()=>[Te(Ut,null,{default:He(()=>[Ge("div",Ts,[Te(Zt,{name:"check_circle",color:"positive"}),D[3]||(D[3]=Ue(" Recording ready ",-1))]),Ge("audio",{ref_key:"previewAudio",ref:g,controls:"",class:"full-width q-mb-sm"},null,512)]),_:1})]),_:1})])):ct("",!0),F.value?ct("",!0):(Fe(),qe("div",Bs,[Te(P1,{class:"bg-warning text-white",dense:"",rounded:""},{avatar:He(()=>[Te(Zt,{name:"mic_off"})]),default:He(()=>[D[4]||(D[4]=Ue(" Microphone permission required for audio recording ",-1))]),_:1})]))]))}},Zn=xa(xs,[["__scopeId","data-v-74d26a44"]]);var ua=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},en={};var Qn;function Rs(){return Qn||(Qn=1,(function(S){(function(){var z=function(){this.init()};z.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var a=this||i;if(e=parseFloat(e),a.ctx||g(),typeof e<"u"&&e>=0&&e<=1){if(a._volume=e,a._muted)return a;a.usingWebAudio&&a.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var _=0;_<a._howls.length;_++)if(!a._howls[_]._webAudio)for(var m=a._howls[_]._getSoundIds(),V=0;V<m.length;V++){var B=a._howls[_]._soundById(m[V]);B&&B._node&&(B._node.volume=B._volume*e)}return a}return a._volume},mute:function(e){var a=this||i;a.ctx||g(),a._muted=e,a.usingWebAudio&&a.masterGain.gain.setValueAtTime(e?0:a._volume,i.ctx.currentTime);for(var _=0;_<a._howls.length;_++)if(!a._howls[_]._webAudio)for(var m=a._howls[_]._getSoundIds(),V=0;V<m.length;V++){var B=a._howls[_]._soundById(m[V]);B&&B._node&&(B._node.muted=e?!0:B._muted)}return a},stop:function(){for(var e=this||i,a=0;a<e._howls.length;a++)e._howls[a].stop();return e},unload:function(){for(var e=this||i,a=e._howls.length-1;a>=0;a--)e._howls[a].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,g()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var a=new Audio;typeof a.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var a=new Audio;a.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,a=null;try{a=typeof Audio<"u"?new Audio:null}catch{return e}if(!a||typeof a.canPlayType!="function")return e;var _=a.canPlayType("audio/mpeg;").replace(/^no$/,""),m=e._navigator?e._navigator.userAgent:"",V=m.match(/OPR\/(\d+)/g),B=V&&parseInt(V[0].split("/")[1],10)<33,n=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,r=m.match(/Version\/(.*?) /),t=n&&r&&parseInt(r[1],10)<15;return e._codecs={mp3:!!(!B&&(_||a.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!_,opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(a.canPlayType('audio/wav; codecs="1"')||a.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!a.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(a.canPlayType("audio/x-m4b;")||a.canPlayType("audio/m4b;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!t&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!t&&a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!a.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(a.canPlayType("audio/x-flac;")||a.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var a=function(_){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,e._releaseHtml5Audio(m)}catch{e.noAudio=!0;break}for(var V=0;V<e._howls.length;V++)if(!e._howls[V]._webAudio)for(var B=e._howls[V]._getSoundIds(),n=0;n<B.length;n++){var r=e._howls[V]._soundById(B[n]);r&&r._node&&!r._node._unlocked&&(r._node._unlocked=!0,r._node.load())}e._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),typeof t.start>"u"?t.noteOn(0):t.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",a,!0),document.removeEventListener("touchend",a,!0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",a,!0);for(var p=0;p<e._howls.length;p++)e._howls[p]._emit("unlock")}};return document.addEventListener("touchstart",a,!0),document.addEventListener("touchend",a,!0),document.addEventListener("click",a,!0),document.addEventListener("keydown",a,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var a=new Audio().play();return a&&typeof Promise<"u"&&(a instanceof Promise||typeof a.then=="function")&&a.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var a=this||i;return e._unlocked&&a._html5AudioPool.push(e),a},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!i.usingWebAudio)){for(var a=0;a<e._howls.length;a++)if(e._howls[a]._webAudio){for(var _=0;_<e._howls[a]._sounds.length;_++)if(!e._howls[a]._sounds[_]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var m=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(m,m)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!i.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var a=0;a<e._howls.length;a++)e._howls[a]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var i=new z,R=function(e){var a=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}a.init(e)};R.prototype={init:function(e){var a=this;return i.ctx||g(),a._autoplay=e.autoplay||!1,a._format=typeof e.format!="string"?e.format:[e.format],a._html5=e.html5||!1,a._muted=e.mute||!1,a._loop=e.loop||!1,a._pool=e.pool||5,a._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,a._rate=e.rate||1,a._sprite=e.sprite||{},a._src=typeof e.src!="string"?e.src:[e.src],a._volume=e.volume!==void 0?e.volume:1,a._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},a._duration=0,a._state="unloaded",a._sounds=[],a._endTimers={},a._queue=[],a._playLock=!1,a._onend=e.onend?[{fn:e.onend}]:[],a._onfade=e.onfade?[{fn:e.onfade}]:[],a._onload=e.onload?[{fn:e.onload}]:[],a._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],a._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],a._onpause=e.onpause?[{fn:e.onpause}]:[],a._onplay=e.onplay?[{fn:e.onplay}]:[],a._onstop=e.onstop?[{fn:e.onstop}]:[],a._onmute=e.onmute?[{fn:e.onmute}]:[],a._onvolume=e.onvolume?[{fn:e.onvolume}]:[],a._onrate=e.onrate?[{fn:e.onrate}]:[],a._onseek=e.onseek?[{fn:e.onseek}]:[],a._onunlock=e.onunlock?[{fn:e.onunlock}]:[],a._onresume=[],a._webAudio=i.usingWebAudio&&!a._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(a),a._autoplay&&a._queue.push({event:"play",action:function(){a.play()}}),a._preload&&a._preload!=="none"&&a.load(),a},load:function(){var e=this,a=null;if(i.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var _=0;_<e._src.length;_++){var m,V;if(e._format&&e._format[_])m=e._format[_];else{if(V=e._src[_],typeof V!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(V),m||(m=/\.([^.]+)$/.exec(V.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&i.codecs(m)){a=e._src[_];break}}if(!a){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=a,e._state="loading",window.location.protocol==="https:"&&a.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new O(e),e._webAudio&&Y(e),e},play:function(e,a){var _=this,m=null;if(typeof e=="number")m=e,e=null;else{if(typeof e=="string"&&_._state==="loaded"&&!_._sprite[e])return null;if(typeof e>"u"&&(e="__default",!_._playLock)){for(var V=0,B=0;B<_._sounds.length;B++)_._sounds[B]._paused&&!_._sounds[B]._ended&&(V++,m=_._sounds[B]._id);V===1?e=null:m=null}}var n=m?_._soundById(m):_._inactiveSound();if(!n)return null;if(m&&!e&&(e=n._sprite||"__default"),_._state!=="loaded"){n._sprite=e,n._ended=!1;var r=n._id;return _._queue.push({event:"play",action:function(){_.play(r)}}),r}if(m&&!n._paused)return a||_._loadQueue("play"),n._id;_._webAudio&&i._autoResume();var t=Math.max(0,n._seek>0?n._seek:_._sprite[e][0]/1e3),p=Math.max(0,(_._sprite[e][0]+_._sprite[e][1])/1e3-t),L=p*1e3/Math.abs(n._rate),v=_._sprite[e][0]/1e3,M=(_._sprite[e][0]+_._sprite[e][1])/1e3;n._sprite=e,n._ended=!1;var y=function(){n._paused=!1,n._seek=t,n._start=v,n._stop=M,n._loop=!!(n._loop||_._sprite[e][2])};if(t>=M){_._ended(n);return}var Z=n._node;if(_._webAudio){var j=function(){_._playLock=!1,y(),_._refreshBuffer(n);var k=n._muted||_._muted?0:n._volume;Z.gain.setValueAtTime(k,i.ctx.currentTime),n._playStart=i.ctx.currentTime,typeof Z.bufferSource.start>"u"?n._loop?Z.bufferSource.noteGrainOn(0,t,86400):Z.bufferSource.noteGrainOn(0,t,p):n._loop?Z.bufferSource.start(0,t,86400):Z.bufferSource.start(0,t,p),L!==1/0&&(_._endTimers[n._id]=setTimeout(_._ended.bind(_,n),L)),a||setTimeout(function(){_._emit("play",n._id),_._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?j():(_._playLock=!0,_.once("resume",j),_._clearTimer(n._id))}else{var D=function(){Z.currentTime=t,Z.muted=n._muted||_._muted||i._muted||Z.muted,Z.volume=n._volume*i.volume(),Z.playbackRate=n._rate;try{var k=Z.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(_._playLock=!0,y(),k.then(function(){_._playLock=!1,Z._unlocked=!0,a?_._loadQueue():_._emit("play",n._id)}).catch(function(){_._playLock=!1,_._emit("playerror",n._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),n._ended=!0,n._paused=!0})):a||(_._playLock=!1,y(),_._emit("play",n._id)),Z.playbackRate=n._rate,Z.paused){_._emit("playerror",n._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||n._loop?_._endTimers[n._id]=setTimeout(_._ended.bind(_,n),L):(_._endTimers[n._id]=function(){_._ended(n),Z.removeEventListener("ended",_._endTimers[n._id],!1)},Z.addEventListener("ended",_._endTimers[n._id],!1))}catch(T){_._emit("playerror",n._id,T)}};Z.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(Z.src=_._src,Z.load());var h=window&&window.ejecta||!Z.readyState&&i._navigator.isCocoonJS;if(Z.readyState>=3||h)D();else{_._playLock=!0,_._state="loading";var x=function(){_._state="loaded",D(),Z.removeEventListener(i._canPlayEvent,x,!1)};Z.addEventListener(i._canPlayEvent,x,!1),_._clearTimer(n._id)}}return n._id},pause:function(e){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"pause",action:function(){a.pause(e)}}),a;for(var _=a._getSoundIds(e),m=0;m<_.length;m++){a._clearTimer(_[m]);var V=a._soundById(_[m]);if(V&&!V._paused&&(V._seek=a.seek(_[m]),V._rateSeek=0,V._paused=!0,a._stopFade(_[m]),V._node))if(a._webAudio){if(!V._node.bufferSource)continue;typeof V._node.bufferSource.stop>"u"?V._node.bufferSource.noteOff(0):V._node.bufferSource.stop(0),a._cleanBuffer(V._node)}else(!isNaN(V._node.duration)||V._node.duration===1/0)&&V._node.pause();arguments[1]||a._emit("pause",V?V._id:null)}return a},stop:function(e,a){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"stop",action:function(){_.stop(e)}}),_;for(var m=_._getSoundIds(e),V=0;V<m.length;V++){_._clearTimer(m[V]);var B=_._soundById(m[V]);B&&(B._seek=B._start||0,B._rateSeek=0,B._paused=!0,B._ended=!0,_._stopFade(m[V]),B._node&&(_._webAudio?B._node.bufferSource&&(typeof B._node.bufferSource.stop>"u"?B._node.bufferSource.noteOff(0):B._node.bufferSource.stop(0),_._cleanBuffer(B._node)):(!isNaN(B._node.duration)||B._node.duration===1/0)&&(B._node.currentTime=B._start||0,B._node.pause(),B._node.duration===1/0&&_._clearSound(B._node))),a||_._emit("stop",B._id))}return _},mute:function(e,a){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"mute",action:function(){_.mute(e,a)}}),_;if(typeof a>"u")if(typeof e=="boolean")_._muted=e;else return _._muted;for(var m=_._getSoundIds(a),V=0;V<m.length;V++){var B=_._soundById(m[V]);B&&(B._muted=e,B._interval&&_._stopFade(B._id),_._webAudio&&B._node?B._node.gain.setValueAtTime(e?0:B._volume,i.ctx.currentTime):B._node&&(B._node.muted=i._muted?!0:e),_._emit("mute",B._id))}return _},volume:function(){var e=this,a=arguments,_,m;if(a.length===0)return e._volume;if(a.length===1||a.length===2&&typeof a[1]>"u"){var V=e._getSoundIds(),B=V.indexOf(a[0]);B>=0?m=parseInt(a[0],10):_=parseFloat(a[0])}else a.length>=2&&(_=parseFloat(a[0]),m=parseInt(a[1],10));var n;if(typeof _<"u"&&_>=0&&_<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,a)}}),e;typeof m>"u"&&(e._volume=_),m=e._getSoundIds(m);for(var r=0;r<m.length;r++)n=e._soundById(m[r]),n&&(n._volume=_,a[2]||e._stopFade(m[r]),e._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(_,i.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=_*i.volume()),e._emit("volume",n._id))}else return n=m?e._soundById(m):e._sounds[0],n?n._volume:0;return e},fade:function(e,a,_,m){var V=this;if(V._state!=="loaded"||V._playLock)return V._queue.push({event:"fade",action:function(){V.fade(e,a,_,m)}}),V;e=Math.min(Math.max(0,parseFloat(e)),1),a=Math.min(Math.max(0,parseFloat(a)),1),_=parseFloat(_),V.volume(e,m);for(var B=V._getSoundIds(m),n=0;n<B.length;n++){var r=V._soundById(B[n]);if(r){if(m||V._stopFade(B[n]),V._webAudio&&!r._muted){var t=i.ctx.currentTime,p=t+_/1e3;r._volume=e,r._node.gain.setValueAtTime(e,t),r._node.gain.linearRampToValueAtTime(a,p)}V._startFadeInterval(r,e,a,_,B[n],typeof m>"u")}}return V},_startFadeInterval:function(e,a,_,m,V,B){var n=this,r=a,t=_-a,p=Math.abs(t/.01),L=Math.max(4,p>0?m/p:m),v=Date.now();e._fadeTo=_,e._interval=setInterval(function(){var M=(Date.now()-v)/m;v=Date.now(),r+=t*M,r=Math.round(r*100)/100,t<0?r=Math.max(_,r):r=Math.min(_,r),n._webAudio?e._volume=r:n.volume(r,e._id,!0),B&&(n._volume=r),(_<a&&r<=_||_>a&&r>=_)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,n.volume(_,e._id),n._emit("fade",e._id))},L)},_stopFade:function(e){var a=this,_=a._soundById(e);return _&&_._interval&&(a._webAudio&&_._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(_._interval),_._interval=null,a.volume(_._fadeTo,e),_._fadeTo=null,a._emit("fade",e)),a},loop:function(){var e=this,a=arguments,_,m,V;if(a.length===0)return e._loop;if(a.length===1)if(typeof a[0]=="boolean")_=a[0],e._loop=_;else return V=e._soundById(parseInt(a[0],10)),V?V._loop:!1;else a.length===2&&(_=a[0],m=parseInt(a[1],10));for(var B=e._getSoundIds(m),n=0;n<B.length;n++)V=e._soundById(B[n]),V&&(V._loop=_,e._webAudio&&V._node&&V._node.bufferSource&&(V._node.bufferSource.loop=_,_&&(V._node.bufferSource.loopStart=V._start||0,V._node.bufferSource.loopEnd=V._stop,e.playing(B[n])&&(e.pause(B[n],!0),e.play(B[n],!0)))));return e},rate:function(){var e=this,a=arguments,_,m;if(a.length===0)m=e._sounds[0]._id;else if(a.length===1){var V=e._getSoundIds(),B=V.indexOf(a[0]);B>=0?m=parseInt(a[0],10):_=parseFloat(a[0])}else a.length===2&&(_=parseFloat(a[0]),m=parseInt(a[1],10));var n;if(typeof _=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,a)}}),e;typeof m>"u"&&(e._rate=_),m=e._getSoundIds(m);for(var r=0;r<m.length;r++)if(n=e._soundById(m[r]),n){e.playing(m[r])&&(n._rateSeek=e.seek(m[r]),n._playStart=e._webAudio?i.ctx.currentTime:n._playStart),n._rate=_,e._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(_,i.ctx.currentTime):n._node&&(n._node.playbackRate=_);var t=e.seek(m[r]),p=(e._sprite[n._sprite][0]+e._sprite[n._sprite][1])/1e3-t,L=p*1e3/Math.abs(n._rate);(e._endTimers[m[r]]||!n._paused)&&(e._clearTimer(m[r]),e._endTimers[m[r]]=setTimeout(e._ended.bind(e,n),L)),e._emit("rate",n._id)}}else return n=e._soundById(m),n?n._rate:e._rate;return e},seek:function(){var e=this,a=arguments,_,m;if(a.length===0)e._sounds.length&&(m=e._sounds[0]._id);else if(a.length===1){var V=e._getSoundIds(),B=V.indexOf(a[0]);B>=0?m=parseInt(a[0],10):e._sounds.length&&(m=e._sounds[0]._id,_=parseFloat(a[0]))}else a.length===2&&(_=parseFloat(a[0]),m=parseInt(a[1],10));if(typeof m>"u")return 0;if(typeof _=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,a)}}),e;var n=e._soundById(m);if(n)if(typeof _=="number"&&_>=0){var r=e.playing(m);r&&e.pause(m,!0),n._seek=_,n._ended=!1,e._clearTimer(m),!e._webAudio&&n._node&&!isNaN(n._node.duration)&&(n._node.currentTime=_);var t=function(){r&&e.play(m,!0),e._emit("seek",m)};if(r&&!e._webAudio){var p=function(){e._playLock?setTimeout(p,0):t()};setTimeout(p,0)}else t()}else if(e._webAudio){var L=e.playing(m)?i.ctx.currentTime-n._playStart:0,v=n._rateSeek?n._rateSeek-n._seek:0;return n._seek+(v+L*Math.abs(n._rate))}else return n._node.currentTime;return e},playing:function(e){var a=this;if(typeof e=="number"){var _=a._soundById(e);return _?!_._paused:!1}for(var m=0;m<a._sounds.length;m++)if(!a._sounds[m]._paused)return!0;return!1},duration:function(e){var a=this,_=a._duration,m=a._soundById(e);return m&&(_=a._sprite[m._sprite][1]/1e3),_},state:function(){return this._state},unload:function(){for(var e=this,a=e._sounds,_=0;_<a.length;_++)a[_]._paused||e.stop(a[_]._id),e._webAudio||(e._clearSound(a[_]._node),a[_]._node.removeEventListener("error",a[_]._errorFn,!1),a[_]._node.removeEventListener(i._canPlayEvent,a[_]._loadFn,!1),a[_]._node.removeEventListener("ended",a[_]._endFn,!1),i._releaseHtml5Audio(a[_]._node)),delete a[_]._node,e._clearTimer(a[_]._id);var m=i._howls.indexOf(e);m>=0&&i._howls.splice(m,1);var V=!0;for(_=0;_<i._howls.length;_++)if(i._howls[_]._src===e._src||e._src.indexOf(i._howls[_]._src)>=0){V=!1;break}return X&&V&&delete X[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,a,_,m){var V=this,B=V["_on"+e];return typeof a=="function"&&B.push(m?{id:_,fn:a,once:m}:{id:_,fn:a}),V},off:function(e,a,_){var m=this,V=m["_on"+e],B=0;if(typeof a=="number"&&(_=a,a=null),a||_)for(B=0;B<V.length;B++){var n=_===V[B].id;if(a===V[B].fn&&n||!a&&n){V.splice(B,1);break}}else if(e)m["_on"+e]=[];else{var r=Object.keys(m);for(B=0;B<r.length;B++)r[B].indexOf("_on")===0&&Array.isArray(m[r[B]])&&(m[r[B]]=[])}return m},once:function(e,a,_){var m=this;return m.on(e,a,_,1),m},_emit:function(e,a,_){for(var m=this,V=m["_on"+e],B=V.length-1;B>=0;B--)(!V[B].id||V[B].id===a||e==="load")&&(setTimeout((function(n){n.call(this,a,_)}).bind(m,V[B].fn),0),V[B].once&&m.off(e,V[B].fn,V[B].id));return m._loadQueue(e),m},_loadQueue:function(e){var a=this;if(a._queue.length>0){var _=a._queue[0];_.event===e&&(a._queue.shift(),a._loadQueue()),e||_.action()}return a},_ended:function(e){var a=this,_=e._sprite;if(!a._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(a._ended.bind(a,e),100),a;var m=!!(e._loop||a._sprite[_][2]);if(a._emit("end",e._id),!a._webAudio&&m&&a.stop(e._id,!0).play(e._id),a._webAudio&&m){a._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var V=(e._stop-e._start)*1e3/Math.abs(e._rate);a._endTimers[e._id]=setTimeout(a._ended.bind(a,e),V)}return a._webAudio&&!m&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,a._clearTimer(e._id),a._cleanBuffer(e._node),i._autoSuspend()),!a._webAudio&&!m&&a.stop(e._id,!0),a},_clearTimer:function(e){var a=this;if(a._endTimers[e]){if(typeof a._endTimers[e]!="function")clearTimeout(a._endTimers[e]);else{var _=a._soundById(e);_&&_._node&&_._node.removeEventListener("ended",a._endTimers[e],!1)}delete a._endTimers[e]}return a},_soundById:function(e){for(var a=this,_=0;_<a._sounds.length;_++)if(e===a._sounds[_]._id)return a._sounds[_];return null},_inactiveSound:function(){var e=this;e._drain();for(var a=0;a<e._sounds.length;a++)if(e._sounds[a]._ended)return e._sounds[a].reset();return new O(e)},_drain:function(){var e=this,a=e._pool,_=0,m=0;if(!(e._sounds.length<a)){for(m=0;m<e._sounds.length;m++)e._sounds[m]._ended&&_++;for(m=e._sounds.length-1;m>=0;m--){if(_<=a)return;e._sounds[m]._ended&&(e._webAudio&&e._sounds[m]._node&&e._sounds[m]._node.disconnect(0),e._sounds.splice(m,1),_--)}}},_getSoundIds:function(e){var a=this;if(typeof e>"u"){for(var _=[],m=0;m<a._sounds.length;m++)_.push(a._sounds[m]._id);return _}else return[e]},_refreshBuffer:function(e){var a=this;return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=X[a._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),a},_cleanBuffer:function(e){var a=this,_=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return a;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),_))try{e.bufferSource.buffer=i._scratchBuffer}catch{}return e.bufferSource=null,a},_clearSound:function(e){var a=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);a||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var O=function(e){this._parent=e,this.init()};O.prototype={init:function(){var e=this,a=e._parent;return e._muted=a._muted,e._loop=a._loop,e._volume=a._volume,e._rate=a._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,a._sounds.push(e),e.create(),e},create:function(){var e=this,a=e._parent,_=i._muted||e._muted||e._parent._muted?0:e._volume;return a._webAudio?(e._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(_,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=a._src,e._node.preload=a._preload===!0?"auto":a._preload,e._node.volume=_*i.volume(),e._node.load()),e},reset:function(){var e=this,a=e._parent;return e._muted=a._muted,e._loop=a._loop,e._volume=a._volume,e._rate=a._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,a=e._parent;a._duration=Math.ceil(e._node.duration*10)/10,Object.keys(a._sprite).length===0&&(a._sprite={__default:[0,a._duration*1e3]}),a._state!=="loaded"&&(a._state="loaded",a._emit("load"),a._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,a=e._parent;a._duration===1/0&&(a._duration=Math.ceil(e._node.duration*10)/10,a._sprite.__default[1]===1/0&&(a._sprite.__default[1]=a._duration*1e3),a._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var X={},Y=function(e){var a=e._src;if(X[a]){e._duration=X[a].duration,ee(e);return}if(/^data:[^;]+;base64,/.test(a)){for(var _=atob(a.split(",")[1]),m=new Uint8Array(_.length),V=0;V<_.length;++V)m[V]=_.charCodeAt(V);q(m.buffer,e)}else{var B=new XMLHttpRequest;B.open(e._xhr.method,a,!0),B.withCredentials=e._xhr.withCredentials,B.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(n){B.setRequestHeader(n,e._xhr.headers[n])}),B.onload=function(){var n=(B.status+"")[0];if(n!=="0"&&n!=="2"&&n!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+B.status+".");return}q(B.response,e)},B.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete X[a],e.load())},F(B)}},F=function(e){try{e.send()}catch{e.onerror()}},q=function(e,a){var _=function(){a._emit("loaderror",null,"Decoding audio data failed.")},m=function(V){V&&a._sounds.length>0?(X[a._src]=V,ee(a,V)):_()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(e).then(m).catch(_):i.ctx.decodeAudioData(e,m,_)},ee=function(e,a){a&&!e._duration&&(e._duration=a.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},g=function(){if(i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),a=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=a?parseInt(a[1],10):null;if(e&&_&&_<9){var m=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!m&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};S.Howler=i,S.Howl=R,typeof ua<"u"?(ua.HowlerGlobal=z,ua.Howler=i,ua.Howl=R,ua.Sound=O):typeof window<"u"&&(window.HowlerGlobal=z,window.Howler=i,window.Howl=R,window.Sound=O)})();(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var R=this;if(!R.ctx||!R.ctx.listener)return R;for(var O=R._howls.length-1;O>=0;O--)R._howls[O].stereo(i);return R},HowlerGlobal.prototype.pos=function(i,R,O){var X=this;if(!X.ctx||!X.ctx.listener)return X;if(R=typeof R!="number"?X._pos[1]:R,O=typeof O!="number"?X._pos[2]:O,typeof i=="number")X._pos=[i,R,O],typeof X.ctx.listener.positionX<"u"?(X.ctx.listener.positionX.setTargetAtTime(X._pos[0],Howler.ctx.currentTime,.1),X.ctx.listener.positionY.setTargetAtTime(X._pos[1],Howler.ctx.currentTime,.1),X.ctx.listener.positionZ.setTargetAtTime(X._pos[2],Howler.ctx.currentTime,.1)):X.ctx.listener.setPosition(X._pos[0],X._pos[1],X._pos[2]);else return X._pos;return X},HowlerGlobal.prototype.orientation=function(i,R,O,X,Y,F){var q=this;if(!q.ctx||!q.ctx.listener)return q;var ee=q._orientation;if(R=typeof R!="number"?ee[1]:R,O=typeof O!="number"?ee[2]:O,X=typeof X!="number"?ee[3]:X,Y=typeof Y!="number"?ee[4]:Y,F=typeof F!="number"?ee[5]:F,typeof i=="number")q._orientation=[i,R,O,X,Y,F],typeof q.ctx.listener.forwardX<"u"?(q.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),q.ctx.listener.forwardY.setTargetAtTime(R,Howler.ctx.currentTime,.1),q.ctx.listener.forwardZ.setTargetAtTime(O,Howler.ctx.currentTime,.1),q.ctx.listener.upX.setTargetAtTime(X,Howler.ctx.currentTime,.1),q.ctx.listener.upY.setTargetAtTime(Y,Howler.ctx.currentTime,.1),q.ctx.listener.upZ.setTargetAtTime(F,Howler.ctx.currentTime,.1)):q.ctx.listener.setOrientation(i,R,O,X,Y,F);else return ee;return q},Howl.prototype.init=(function(i){return function(R){var O=this;return O._orientation=R.orientation||[1,0,0],O._stereo=R.stereo||null,O._pos=R.pos||null,O._pannerAttr={coneInnerAngle:typeof R.coneInnerAngle<"u"?R.coneInnerAngle:360,coneOuterAngle:typeof R.coneOuterAngle<"u"?R.coneOuterAngle:360,coneOuterGain:typeof R.coneOuterGain<"u"?R.coneOuterGain:0,distanceModel:typeof R.distanceModel<"u"?R.distanceModel:"inverse",maxDistance:typeof R.maxDistance<"u"?R.maxDistance:1e4,panningModel:typeof R.panningModel<"u"?R.panningModel:"HRTF",refDistance:typeof R.refDistance<"u"?R.refDistance:1,rolloffFactor:typeof R.rolloffFactor<"u"?R.rolloffFactor:1},O._onstereo=R.onstereo?[{fn:R.onstereo}]:[],O._onpos=R.onpos?[{fn:R.onpos}]:[],O._onorientation=R.onorientation?[{fn:R.onorientation}]:[],i.call(this,R)}})(Howl.prototype.init),Howl.prototype.stereo=function(i,R){var O=this;if(!O._webAudio)return O;if(O._state!=="loaded")return O._queue.push({event:"stereo",action:function(){O.stereo(i,R)}}),O;var X=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof R>"u")if(typeof i=="number")O._stereo=i,O._pos=[i,0,0];else return O._stereo;for(var Y=O._getSoundIds(R),F=0;F<Y.length;F++){var q=O._soundById(Y[F]);if(q)if(typeof i=="number")q._stereo=i,q._pos=[i,0,0],q._node&&(q._pannerAttr.panningModel="equalpower",(!q._panner||!q._panner.pan)&&z(q,X),X==="spatial"?typeof q._panner.positionX<"u"?(q._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),q._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),q._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):q._panner.setPosition(i,0,0):q._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),O._emit("stereo",q._id);else return q._stereo}return O},Howl.prototype.pos=function(i,R,O,X){var Y=this;if(!Y._webAudio)return Y;if(Y._state!=="loaded")return Y._queue.push({event:"pos",action:function(){Y.pos(i,R,O,X)}}),Y;if(R=typeof R!="number"?0:R,O=typeof O!="number"?-.5:O,typeof X>"u")if(typeof i=="number")Y._pos=[i,R,O];else return Y._pos;for(var F=Y._getSoundIds(X),q=0;q<F.length;q++){var ee=Y._soundById(F[q]);if(ee)if(typeof i=="number")ee._pos=[i,R,O],ee._node&&((!ee._panner||ee._panner.pan)&&z(ee,"spatial"),typeof ee._panner.positionX<"u"?(ee._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),ee._panner.positionY.setValueAtTime(R,Howler.ctx.currentTime),ee._panner.positionZ.setValueAtTime(O,Howler.ctx.currentTime)):ee._panner.setPosition(i,R,O)),Y._emit("pos",ee._id);else return ee._pos}return Y},Howl.prototype.orientation=function(i,R,O,X){var Y=this;if(!Y._webAudio)return Y;if(Y._state!=="loaded")return Y._queue.push({event:"orientation",action:function(){Y.orientation(i,R,O,X)}}),Y;if(R=typeof R!="number"?Y._orientation[1]:R,O=typeof O!="number"?Y._orientation[2]:O,typeof X>"u")if(typeof i=="number")Y._orientation=[i,R,O];else return Y._orientation;for(var F=Y._getSoundIds(X),q=0;q<F.length;q++){var ee=Y._soundById(F[q]);if(ee)if(typeof i=="number")ee._orientation=[i,R,O],ee._node&&(ee._panner||(ee._pos||(ee._pos=Y._pos||[0,0,-.5]),z(ee,"spatial")),typeof ee._panner.orientationX<"u"?(ee._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),ee._panner.orientationY.setValueAtTime(R,Howler.ctx.currentTime),ee._panner.orientationZ.setValueAtTime(O,Howler.ctx.currentTime)):ee._panner.setOrientation(i,R,O)),Y._emit("orientation",ee._id);else return ee._orientation}return Y},Howl.prototype.pannerAttr=function(){var i=this,R=arguments,O,X,Y;if(!i._webAudio)return i;if(R.length===0)return i._pannerAttr;if(R.length===1)if(typeof R[0]=="object")O=R[0],typeof X>"u"&&(O.pannerAttr||(O.pannerAttr={coneInnerAngle:O.coneInnerAngle,coneOuterAngle:O.coneOuterAngle,coneOuterGain:O.coneOuterGain,distanceModel:O.distanceModel,maxDistance:O.maxDistance,refDistance:O.refDistance,rolloffFactor:O.rolloffFactor,panningModel:O.panningModel}),i._pannerAttr={coneInnerAngle:typeof O.pannerAttr.coneInnerAngle<"u"?O.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof O.pannerAttr.coneOuterAngle<"u"?O.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof O.pannerAttr.coneOuterGain<"u"?O.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof O.pannerAttr.distanceModel<"u"?O.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof O.pannerAttr.maxDistance<"u"?O.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof O.pannerAttr.refDistance<"u"?O.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof O.pannerAttr.rolloffFactor<"u"?O.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof O.pannerAttr.panningModel<"u"?O.pannerAttr.panningModel:i._panningModel});else return Y=i._soundById(parseInt(R[0],10)),Y?Y._pannerAttr:i._pannerAttr;else R.length===2&&(O=R[0],X=parseInt(R[1],10));for(var F=i._getSoundIds(X),q=0;q<F.length;q++)if(Y=i._soundById(F[q]),Y){var ee=Y._pannerAttr;ee={coneInnerAngle:typeof O.coneInnerAngle<"u"?O.coneInnerAngle:ee.coneInnerAngle,coneOuterAngle:typeof O.coneOuterAngle<"u"?O.coneOuterAngle:ee.coneOuterAngle,coneOuterGain:typeof O.coneOuterGain<"u"?O.coneOuterGain:ee.coneOuterGain,distanceModel:typeof O.distanceModel<"u"?O.distanceModel:ee.distanceModel,maxDistance:typeof O.maxDistance<"u"?O.maxDistance:ee.maxDistance,refDistance:typeof O.refDistance<"u"?O.refDistance:ee.refDistance,rolloffFactor:typeof O.rolloffFactor<"u"?O.rolloffFactor:ee.rolloffFactor,panningModel:typeof O.panningModel<"u"?O.panningModel:ee.panningModel};var g=Y._panner;g||(Y._pos||(Y._pos=i._pos||[0,0,-.5]),z(Y,"spatial"),g=Y._panner),g.coneInnerAngle=ee.coneInnerAngle,g.coneOuterAngle=ee.coneOuterAngle,g.coneOuterGain=ee.coneOuterGain,g.distanceModel=ee.distanceModel,g.maxDistance=ee.maxDistance,g.refDistance=ee.refDistance,g.rolloffFactor=ee.rolloffFactor,g.panningModel=ee.panningModel}return i},Sound.prototype.init=(function(i){return function(){var R=this,O=R._parent;R._orientation=O._orientation,R._stereo=O._stereo,R._pos=O._pos,R._pannerAttr=O._pannerAttr,i.call(this),R._stereo?O.stereo(R._stereo):R._pos&&O.pos(R._pos[0],R._pos[1],R._pos[2],R._id)}})(Sound.prototype.init),Sound.prototype.reset=(function(i){return function(){var R=this,O=R._parent;return R._orientation=O._orientation,R._stereo=O._stereo,R._pos=O._pos,R._pannerAttr=O._pannerAttr,R._stereo?O.stereo(R._stereo):R._pos?O.pos(R._pos[0],R._pos[1],R._pos[2],R._id):R._panner&&(R._panner.disconnect(0),R._panner=void 0,O._refreshBuffer(R)),i.call(this)}})(Sound.prototype.reset);var z=function(i,R){R=R||"spatial",R==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}})()})(en)),en}var Es=Rs();const Ps={class:"audio-player"},Is={class:"col"},Vs={class:"row justify-between text-caption text-grey-7"},ca=100,Ds={__name:"AudioPlayer",props:{audioUrl:{type:String,required:!0}},setup(S){const z=S,i=ze(!1),R=ze(!1),O=ze(0),X=ze(0),Y=ze(null);let F=null,q=null,ee=[];Kn(()=>{g(),B()}),Jn(()=>{q&&clearInterval(q),F&&F.unload()});function g(){F=new Es.Howl({src:[z.audioUrl],html5:!0,volume:1,onload:()=>{R.value=!0,X.value=F.duration()},onplay:()=>{i.value=!0,_()},onpause:()=>{i.value=!1,m()},onend:()=>{i.value=!1,m(),O.value=0,n()}})}function e(){F&&(i.value?F.pause():F.play())}function a(t){F&&(F.seek(t),O.value=t,n())}function _(){q=setInterval(()=>{F&&i.value&&(O.value=F.seek(),n())},100)}function m(){q&&(clearInterval(q),q=null)}function V(t){const p=Math.floor(t/60),L=Math.floor(t%60);return`${p}:${L.toString().padStart(2,"0")}`}async function B(){try{const p=await(await fetch(z.audioUrl)).arrayBuffer(),M=(await new(window.AudioContext||window.webkitAudioContext)().decodeAudioData(p)).getChannelData(0),y=ca,Z=Math.floor(M.length/y);ee=[];for(let D=0;D<y;D++){let h=0;for(let x=0;x<Z;x++)h+=Math.abs(M[D*Z+x]);ee.push(h/Z)}const j=Math.max(...ee);ee=ee.map(D=>D/j),await hn(),n()}catch(t){console.error("Error generating waveform:",t),ee=new Array(ca).fill(.5),await hn(),n()}}function n(){if(!Y.value)return;const t=Y.value,p=t.getContext("2d"),L=window.devicePixelRatio||1,v=t.getBoundingClientRect();t.width=v.width*L,t.height=48*L,p.scale(L,L);const M=v.width,y=48,Z=M/ca,j=2;p.clearRect(0,0,M,y);const D=X.value>0?O.value/X.value:0;for(let h=0;h<ca;h++){const x=Math.max(3,ee[h]*y*.8),k=h*Z,T=(y-x)/2;h/ca<=D?p.fillStyle="#1976d2":p.fillStyle="#bdbdbd",p.fillRect(k,T,Z-j,x)}}function r(t){if(!R.value||!Y.value||!X.value)return;const p=Y.value.getBoundingClientRect(),M=(t.clientX-p.left)/p.width*X.value;a(M)}return(t,p)=>(Fe(),qe("div",Ps,[Te(ea,{flat:"",bordered:""},{default:He(()=>[Te(Ut,{class:"row items-center q-gutter-sm q-py-sm no-bottom"},{default:He(()=>[Te(it,{flat:"",round:"",compact:"",size:"xl",color:i.value?"primary":"grey-7",icon:i.value?"pause":"play_arrow",onClick:e,disable:!R.value},null,8,["color","icon","disable"]),Ge("div",Is,[Ge("canvas",{ref_key:"waveformCanvas",ref:Y,class:Ct(["waveform-canvas",{disabled:!R.value}]),onClick:r},null,2),Ge("div",Vs,[Ge("span",null,lt(V(O.value)),1),Ge("span",null,lt(V(X.value)),1)])])]),_:1})]),_:1})]))}},$n=xa(Ds,[["__scopeId","data-v-2acc57f9"]]),Ls={class:"thread-panel"},Os={key:0,class:"thread-content-helper"},Hs={class:"controls-section"},Cs={class:"row items-center q-gutter-xs helper-btns",style:{width:"100%"}},Xs={key:0},Ns={class:"text-grey-7",style:{"margin-left":"5px"}},Fs={key:0,class:"posts-section"},qs={key:0},Ys={class:"row q-gutter-xs"},js={key:1},Gs=["innerHTML"],Zs={key:1},Qs={key:2,class:"post-actions-inline"},$s={class:"post-date"},zs={class:"reply-section"},Ws={key:0},Ks={class:"row items-center justify-center q-gutter-xs"},Js={class:"row items-center q-gutter-xs"},Us={key:0},ei={class:"text-grey-7 q-ml-sm text-caption"},ti={key:0,class:"posts-section"},ai={key:0},ni={class:"row q-gutter-xs"},ri={key:1},si=["innerHTML"],ii={key:1},oi={key:2,class:"post-actions-inline"},li={class:"post-date"},_i={key:0},fi={key:1,class:"whatsapp-input"},ui={__name:"ThreadPanel",props:{marker:{type:Object,default:null},markers:{type:Array,default:()=>[]},role:{type:String,required:!0},token:{type:String,default:null}},emits:["postCreated","markerSelected","seek","playFromMarker","togglePlayPause","markerUpdated"],setup(S,{emit:z}){const i=S,R=z,O=zn(),X=ze(""),Y=ze(null),F=ze(!1),q=ze(null),ee=ze(""),g=ze(null),e=ze(null),a=ze(null),_=pt(()=>!i.marker||!i.markers.length?-1:i.markers.findIndex(P=>P.id===i.marker.id));function m(P){R("seek",-5)}async function V(P){if(!i.marker)return;const N=Math.max(0,i.marker.start_time+P),A=i.marker.end_time?i.marker.end_time+P:null;try{await la.updateMarker(i.marker.id,i.token,N,A),O.notify({type:"positive",message:`Marker time adjusted by ${P>0?"+":""}${P}s`,icon:"schedule",timeout:1e3}),R("markerUpdated")}catch(f){O.notify({type:"negative",message:f.response?.data?.error||"Failed to update marker",icon:"error"})}}function B(){R("playFromMarker",i.marker.start_time)}function n(){R("togglePlayPause")}async function r(P){Y.value=P,await t()}async function t(){if(i.marker){F.value=!0;try{if(!i.token)throw new Error("Token not found");await la.createPost(i.marker.id,i.token,X.value.trim()||null,Y.value),O.notify({type:"positive",message:"Post created successfully!",icon:"check_circle"}),X.value="",Y.value=null,g.value=null,R("postCreated")}catch(P){O.notify({type:"negative",message:P.response?.data?.error||"Failed to create post",icon:"error"})}finally{F.value=!1}}}function p(){g.value=null,X.value="",Y.value=null}function L(){X.value.trim()?t():g.value="record"}function v(P){!P.shiftKey&&X.value.trim()&&(P.preventDefault(),t())}function M(){setTimeout(()=>{a.value&&a.value.scrollIntoView({behavior:"smooth",block:"nearest"})},300)}function y(P){const N=Math.floor(P/60),A=Math.floor(P%60);return`${N}:${A.toString().padStart(2,"0")}`}function Z(P){const N=new Date(P),f=new Date-N,l=Math.floor(f/1e3),s=Math.floor(l/60),u=Math.floor(s/60),w=Math.floor(u/24),J=Math.floor(w/7),ne=Math.floor(w/30),H=Math.floor(w/365);return l<60?"just now":s<60?s===1?"1 minute ago":`${s} minutes ago`:u<24?u===1?"1 hour ago":`${u} hours ago`:w<7?w===1?"1 day ago":`${w} days ago`:J<4?J===1?"1 week ago":`${J} weeks ago`:ne<12?ne===1?"1 month ago":`${ne} months ago`:H===1?"1 year ago":`${H} years ago`}function j(P){if(!P)return"";let N=P.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return N=N.replace(/([\u0F00-\u0FFF]+)/g,'<span class="tibetan-text">$1</span>'),N=N.replace(/\n/g,"<br>"),N}function D(P){return la.getAudioUrl(P)}function h(P){return P.author_type===i.role}function x(P){O.dialog({title:"Delete Post",message:"Are you sure you want to delete this post? This action cannot be undone.",cancel:!0,persistent:!0}).onOk(async()=>{await k(P.id)})}async function k(P){try{if(!i.token)throw new Error("Token not found");await la.deletePost(P,i.token),O.notify({type:"positive",message:"Post deleted successfully",icon:"delete"}),R("postCreated")}catch(N){O.notify({type:"negative",message:N.response?.data?.error||"Failed to delete post",icon:"error"})}}function T(P){q.value=P.id,ee.value=P.text_content||""}function W(){q.value=null,ee.value=""}async function G(P){if(!ee.value.trim()){O.notify({type:"warning",message:"Post text cannot be empty",icon:"warning"});return}try{if(!i.token)throw new Error("Token not found");await la.updatePost(P.id,i.token,ee.value.trim()),O.notify({type:"positive",message:"Post updated successfully",icon:"check_circle"}),q.value=null,ee.value="",R("postCreated")}catch(N){O.notify({type:"negative",message:N.response?.data?.error||"Failed to update post",icon:"error"})}}return(P,N)=>(Fe(),qe("div",Ls,[S.marker&&S.role==="helper"?(Fe(),qe("div",Os,[Ge("div",Hs,[Ge("div",Cs,[Te(it,{onClick:N[0]||(N[0]=A=>m()),label:"<< 5s","no-caps":"",block:""},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[11]||(N[11]=[Ue("Seek backward 5s",-1)])]),_:1})]),_:1}),Te(it,{onClick:B},{default:He(()=>[Te(Zt,{name:S.marker.end_time?"schedule":"place",class:"q-mr-xs"},null,8,["name"]),Ue(" "+lt(y(S.marker.start_time))+" ",1),S.marker.end_time?(Fe(),qe("span",Xs," - "+lt(y(S.marker.end_time)),1)):ct("",!0),Ge("span",Ns,lt(_.value+1)+"/"+lt(S.markers.length),1),Te(ft,null,{default:He(()=>[...N[12]||(N[12]=[Ue("Play from marker start",-1)])]),_:1})]),_:1}),Te(it,{onClick:n},{default:He(()=>[Te(Zt,{name:"play_arrow",size:"xs"}),N[14]||(N[14]=Ge("span",{class:"q-mx-xs"},"/",-1)),Te(Zt,{name:"pause",size:"xs"}),Te(ft,null,{default:He(()=>[...N[13]||(N[13]=[Ue("Play / Pause",-1)])]),_:1})]),_:1})])]),S.marker.posts&&S.marker.posts.length>0?(Fe(),qe("div",Fs,[(Fe(!0),qe(Jt,null,Ba(S.marker.posts,A=>(Fe(),qe("div",{key:A.id,class:"post-item"},[Ge("div",{class:Ct(["post-wrapper",{"own-message":A.author_type===S.role,"other-message":A.author_type!==S.role,"has-audio":A.audio_filename}])},[Ge("div",{class:Ct(["post-bubble",{"has-audio":A.audio_filename}])},[q.value===A.id?(Fe(),qe("div",qs,[Te(ya,{modelValue:ee.value,"onUpdate:modelValue":N[1]||(N[1]=f=>ee.value=f),outlined:"",dense:"",type:"textarea",rows:"3",autofocus:"",class:"q-mb-sm post-text-input"},null,8,["modelValue"]),Ge("div",Ys,[Te(it,{flat:"",dense:"",size:"sm",color:"primary",icon:"check",label:"Save",onClick:f=>G(A)},null,8,["onClick"]),Te(it,{flat:"",dense:"",size:"sm",color:"grey",icon:"close",label:"Cancel",onClick:N[2]||(N[2]=f=>W())})])])):(Fe(),qe("div",js,[A.text_content?(Fe(),qe("div",{key:0,class:"post-text-content",innerHTML:j(A.text_content)},null,8,Gs)):ct("",!0),A.audio_filename?(Fe(),qe("div",Zs,[Te($n,{"audio-url":D(A.audio_filename)},null,8,["audio-url"])])):ct("",!0)])),h(A)&&q.value!==A.id?(Fe(),qe("div",Qs,[A.text_content?(Fe(),wa(it,{key:0,flat:"",round:"",dense:"",color:"primary",icon:"edit",size:"sm",onClick:f=>T(A)},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[15]||(N[15]=[Ue("Edit post",-1)])]),_:1})]),_:1},8,["onClick"])):ct("",!0),Te(it,{flat:"",round:"",dense:"",color:"negative",icon:"delete",size:"sm",onClick:f=>x(A)},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[16]||(N[16]=[Ue("Delete post",-1)])]),_:1})]),_:1},8,["onClick"])])):ct("",!0)],2),Ge("div",$s,lt(Z(A.created_at)),1)],2)]))),128))])):ct("",!0),Ge("div",zs,[g.value==="record"?(Fe(),qe("div",Ws,[Te(Zn,{"auto-start":"",onAudioReady:r,onCancel:p})])):(Fe(),qe("div",{key:1,class:"whatsapp-input",ref_key:"inputContainer",ref:a},[Te(ya,{ref_key:"messageInput",ref:e,modelValue:X.value,"onUpdate:modelValue":N[3]||(N[3]=A=>X.value=A),outlined:"",autogrow:"",placeholder:"Type a message",disable:F.value,class:"message-input",onKeyup:bn(v,["enter"]),onFocus:M},null,8,["modelValue","disable"]),Te(it,{round:"",icon:X.value.trim()?"send":"mic",color:X.value.trim()?"primary":"grey-7",onClick:L,disable:F.value,loading:F.value,class:"action-btn"},{default:He(()=>[Te(ft,null,{default:He(()=>[Ue(lt(X.value.trim()?"Send":"Record audio"),1)]),_:1})]),_:1},8,["icon","color","disable","loading"])],512))])])):S.marker&&S.role==="creator"?(Fe(),wa(ea,{key:1},{default:He(()=>[Te(Ut,null,{default:He(()=>[Ge("div",Ks,[Ge("div",Js,[Te(it,{onClick:N[4]||(N[4]=A=>V(-5)),label:"-5s","no-caps":"",color:"secondary",outline:"",class:"slip-5s"},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[17]||(N[17]=[Ue("Slip marker start time backward 5s",-1)])]),_:1})]),_:1}),Te(it,{onClick:N[5]||(N[5]=A=>V(-1)),label:"-1s","no-caps":"",color:"secondary",outline:""},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[18]||(N[18]=[Ue("Slip marker start time backward 1s",-1)])]),_:1})]),_:1}),Te(it,{onClick:B},{default:He(()=>[Te(Zt,{name:S.marker.end_time?"schedule":"place",class:"q-mr-xs"},null,8,["name"]),Ue(" "+lt(y(S.marker.start_time))+" ",1),S.marker.end_time?(Fe(),qe("span",Us," - "+lt(y(S.marker.end_time)),1)):ct("",!0),Ge("span",ei,lt(_.value+1)+"/"+lt(S.markers.length),1),Te(ft,null,{default:He(()=>[...N[19]||(N[19]=[Ue("Play from marker start",-1)])]),_:1})]),_:1}),Te(it,{onClick:N[6]||(N[6]=A=>V(1)),label:"+1s","no-caps":"",color:"secondary",outline:""},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[20]||(N[20]=[Ue("Slip marker start time forward 1s",-1)])]),_:1})]),_:1}),Te(it,{onClick:N[7]||(N[7]=A=>V(5)),label:"+5s","no-caps":"",color:"secondary",outline:"",class:"slip-5s"},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[21]||(N[21]=[Ue("Slip marker start time forward 5s",-1)])]),_:1})]),_:1})])])]),_:1}),Te(E1),S.marker.posts&&S.marker.posts.length>0?(Fe(),qe("div",ti,[(Fe(!0),qe(Jt,null,Ba(S.marker.posts,A=>(Fe(),qe("div",{key:A.id,class:"post-item"},[Ge("div",{class:Ct(["post-wrapper",{"own-message":A.author_type===S.role,"other-message":A.author_type!==S.role,"has-audio":A.audio_filename}])},[Ge("div",{class:Ct(["post-bubble",{"has-audio":A.audio_filename}])},[q.value===A.id?(Fe(),qe("div",ai,[Te(ya,{modelValue:ee.value,"onUpdate:modelValue":N[8]||(N[8]=f=>ee.value=f),outlined:"",dense:"",type:"textarea",rows:"3",autofocus:"",class:"q-mb-sm post-text-input"},null,8,["modelValue"]),Ge("div",ni,[Te(it,{flat:"",dense:"",size:"sm",color:"primary",icon:"check",label:"Save",onClick:f=>G(A)},null,8,["onClick"]),Te(it,{flat:"",dense:"",size:"sm",color:"grey",icon:"close",label:"Cancel",onClick:N[9]||(N[9]=f=>W())})])])):(Fe(),qe("div",ri,[A.text_content?(Fe(),qe("div",{key:0,class:"post-text-content",innerHTML:j(A.text_content)},null,8,si)):ct("",!0),A.audio_filename?(Fe(),qe("div",ii,[Te($n,{"audio-url":D(A.audio_filename)},null,8,["audio-url"])])):ct("",!0)])),h(A)&&q.value!==A.id?(Fe(),qe("div",oi,[A.text_content?(Fe(),wa(it,{key:0,flat:"",round:"",dense:"",color:"primary",icon:"edit",size:"sm",onClick:f=>T(A)},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[22]||(N[22]=[Ue("Edit post",-1)])]),_:1})]),_:1},8,["onClick"])):ct("",!0),Te(it,{flat:"",round:"",dense:"",color:"negative",icon:"delete",size:"sm",onClick:f=>x(A)},{default:He(()=>[Te(ft,null,{default:He(()=>[...N[23]||(N[23]=[Ue("Delete post",-1)])]),_:1})]),_:1},8,["onClick"])])):ct("",!0)],2),Ge("div",li,lt(Z(A.created_at)),1)],2)]))),128))])):ct("",!0),Te(Ut,null,{default:He(()=>[g.value==="record"?(Fe(),qe("div",_i,[Te(Zn,{"auto-start":"",onAudioReady:r,onCancel:p})])):(Fe(),qe("div",fi,[Te(ya,{modelValue:X.value,"onUpdate:modelValue":N[10]||(N[10]=A=>X.value=A),outlined:"",dense:"",placeholder:"Type a message",disable:F.value,class:"message-input",onKeyup:bn(v,["enter"])},null,8,["modelValue","disable"]),Te(it,{round:"",icon:X.value.trim()?"send":"mic",color:X.value.trim()?"primary":"grey-7",onClick:L,disable:F.value,loading:F.value,class:"action-btn"},{default:He(()=>[Te(ft,null,{default:He(()=>[Ue(lt(X.value.trim()?"Send":"Record audio"),1)]),_:1})]),_:1},8,["icon","color","disable","loading"])]))]),_:1})]),_:1})):(Fe(),wa(ea,{key:2,class:"text-center"},{default:He(()=>[Te(Ut,null,{default:He(()=>[Te(Zt,{name:"touch_app",size:"64px",color:"grey-5"}),N[24]||(N[24]=Ge("div",{class:"text-h6 text-grey-7 q-mt-md"},"Select a Marker",-1)),N[25]||(N[25]=Ge("div",{class:"text-body2 text-grey-6"}," Click on a marker in the timeline or list to view its thread ",-1))]),_:1})]),_:1}))]))}},hi=xa(ui,[["__scopeId","data-v-a0cd6cf6"]]);export{mi as M,hi as T};
